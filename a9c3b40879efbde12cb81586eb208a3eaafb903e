{
  "comments": [
    {
      "key": {
        "uuid": "3fadcff2_a80d92df",
        "filename": "tests/vboot_api_kernel2_tests.c",
        "patchSetId": 6
      },
      "lineNbr": 105,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2019-10-10T22:20:11Z",
      "side": 1,
      "message": "So... I think the reason they used 1000 here is that you can add/subtract small values without getting anywhere near other VB2_ERROR values. The problem with using VB2_ERROR_MOCK is that VB2_ERROR_MOCK - 1 happens to be equal to VB2_ERROR_UNKNOWN. That\u0027s probably not a huge problem (specifically for UNKNOWN), but still something I\u0027d rather avoid in general.\n\nOne option would be to move VB2_ERROR_MOCK intentionally far away from the other error values. A better option would be to just fix this whole godawful hide-stuff-in-the-return-code thing and use separate globals to pass out information of what flags it was called with instead (I think best would be two separate booleans vbtlk_called_with_fixed and vbtlk_called_with_removable that both get reset to false by ResetMocks() and both get checked after every run).",
      "revId": "a9c3b40879efbde12cb81586eb208a3eaafb903e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6506fa94_eeb0b4c2",
        "filename": "tests/vboot_api_kernel2_tests.c",
        "patchSetId": 6
      },
      "lineNbr": 105,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2019-10-14T14:45:20Z",
      "side": 1,
      "message": "Err, good point.  Not sure why that didn\u0027t occur to me in the first place.  Let\u0027s just introduce the two booleans like you suggested.\n\nI also considered introducing another boolean called vbtlk_called for the cases where VbTryLoadKernel should *not* be called (i.e. the particular function being tested aborts before it gets to the point where it calls VbTryLoadKernel), but it seemed a bit excessive.  If you think that would be a good idea, let me know and I can add it.\n\nAlso note that there were quite a few test cases where vbtlk_retval was being set even though VbTryLoadKernel is not expected to run.  For those cases, I removed the assignment to vbtlk_retval.",
      "parentUuid": "3fadcff2_a80d92df",
      "revId": "a9c3b40879efbde12cb81586eb208a3eaafb903e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "81a9ad52_d750f8fb",
        "filename": "tests/vboot_api_kernel2_tests.c",
        "patchSetId": 6
      },
      "lineNbr": 105,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2019-10-16T00:49:46Z",
      "side": 1,
      "message": "Testing a negative is also important, though, so I think doing that would be useful.\n\nMaybe an easy way to do that (so you don\u0027t have to check even more globals after every test) would be to assign some special value to vbtlk_retval (maybe VB2_ERROR_UNIT_TEST, or create a new error value for that) and then put a TEST_NEQ() for that value in the TryLoadKernel() stub itself?",
      "parentUuid": "6506fa94_eeb0b4c2",
      "revId": "a9c3b40879efbde12cb81586eb208a3eaafb903e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}