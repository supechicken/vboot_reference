{
  "comments": [
    {
      "key": {
        "uuid": "4912e391_fa53a24e",
        "filename": "firmware/include/vb2_workbuf_size.h",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2019-03-06T21:12:52Z",
      "side": 1,
      "message": "Why not just call it vb2_constants.h and move other constants (like VB2_PCR_DIGEST_RECOMMENDED_SIZE) in here as well while we\u0027re at it? Who knows what else we may want to access in a non-C file in the future.",
      "revId": "0ed9b84a9ffa090b4fdb395ea0394489480ab520",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "024d7875_eed9aad8",
        "filename": "firmware/include/vb2_workbuf_size.h",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2019-03-07T01:43:15Z",
      "side": 1,
      "message": "Well, I think it\u0027s precisely because there are *too many* other constants.\n2api.h has a bunch more, so do 2nvstorage_fields.h, 2secdata.h, 2sha.h, 2struct.h, 2rsa.h.\n\nI think the line has to be drawn somewhere, and the line needs to be clearly defined -- otherwise when adding new constants, people will not know whether it should be added to this file, or one of the other headers.\n\nI was struggling to find some kind of \"category\" of constants to use as the name of this file -- here are the ones I came up with:\n\n* firmware_workbuf_size (only this constant)\n* workbuf_size (firmware_ and kernel_)\n* recommended_sizes (firmware_ and kernel_ and pcr_digest_)\n* size (could move all constants from 2api.h, but then there are other _SIZE constants to consider in other headers)\n\nBecause of this difficulty, I also re-considered the entire approach -- whether we could write some small make-time logic in coreboot which grabs the constant value and temporarily stores it in its own header for use in the linker script.",
      "parentUuid": "4912e391_fa53a24e",
      "revId": "0ed9b84a9ffa090b4fdb395ea0394489480ab520",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "86cc245a_dac5ec4d",
        "filename": "firmware/include/vb2_workbuf_size.h",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2019-03-07T02:09:32Z",
      "side": 1,
      "message": "I\u0027d just start with the constants in 2api.h itself for now (excluding the context flags). We can move others as needed. It would just be nice if we don\u0027t have to make yet another file when we have the next case like this.\n\nBTW, if we\u0027re not sure about the extra file anymore, another option would be to wrap the stuff we want to hide (including #include for headers that aren\u0027t written to handle this) in #ifndef __ASSEMBLER__. That\u0027s a macro that the preprocessor automatically defines for assembly files (and I think also for memlayout because we build those with -x assembly-with-cpp), and we use that in coreboot whenever we have a file with constants that we want accessible in assembly but also some C header code (e.g. compare coreboot/src/arch/arm64/include/armv8/arch/cache.h). So that\u0027s another commonly used pattern we could follow.",
      "parentUuid": "024d7875_eed9aad8",
      "revId": "0ed9b84a9ffa090b4fdb395ea0394489480ab520",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "dce68ce4_37c0d16a",
        "filename": "firmware/include/vb2_workbuf_size.h",
        "patchSetId": 1
      },
      "lineNbr": 6,
      "author": {
        "id": 1000239
      },
      "writtenOn": "2019-03-06T14:57:06Z",
      "side": 1,
      "message": "It\u0027s confusing that you say \"this is split into a different file\" while that is the comment of exactly the \"different file\".\n\nYou can simply say Linker scripts can use this to figure out size etc.",
      "range": {
        "startLine": 6,
        "startChar": 3,
        "endLine": 6,
        "endChar": 38
      },
      "revId": "0ed9b84a9ffa090b4fdb395ea0394489480ab520",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}