{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "fa734198_1022f1af",
        "filename": "futility/cmd_show.c",
        "patchSetId": 20
      },
      "lineNbr": 51,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2023-07-05T07:26:22Z",
      "side": 1,
      "message": "space",
      "range": {
        "startLine": 51,
        "startChar": 3,
        "endLine": 51,
        "endChar": 4
      },
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "cf0c79d8_c701208b",
        "filename": "futility/cmd_show.c",
        "patchSetId": 20
      },
      "lineNbr": 51,
      "author": {
        "id": 1570422
      },
      "writtenOn": "2023-07-05T19:34:20Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "fa734198_1022f1af",
      "range": {
        "startLine": 51,
        "startChar": 3,
        "endLine": 51,
        "endChar": 4
      },
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b9edde78_a9f33139",
        "filename": "futility/cmd_show.c",
        "patchSetId": 20
      },
      "lineNbr": 118,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2023-07-05T07:26:22Z",
      "side": 1,
      "message": "`Invalid public key: %s` to be consistent with `ft_show_privkey()`.",
      "range": {
        "startLine": 118,
        "startChar": 9,
        "endLine": 118,
        "endChar": 23
      },
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5dd13bdc_ca418da9",
        "filename": "futility/cmd_show.c",
        "patchSetId": 20
      },
      "lineNbr": 118,
      "author": {
        "id": 1570422
      },
      "writtenOn": "2023-07-05T19:34:20Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b9edde78_a9f33139",
      "range": {
        "startLine": 118,
        "startChar": 9,
        "endLine": 118,
        "endChar": 23
      },
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "06589ca5_f3821c4c",
        "filename": "futility/cmd_show.c",
        "patchSetId": 20
      },
      "lineNbr": 317,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2023-07-05T07:26:22Z",
      "side": 1,
      "message": "Actually, I wonder if it will be useful to have `ft_print_header2` as the secondary header. Then this can be simplified to (assuming both `ft_print_header*` are pointers):\n\n```\nft_print_header2 \u003d \"keyblock\";\nshow_keyblock();\n// Then in below\nft_print_header2 \u003d \"preamble\";\n```\n\nTo allow changing `header` and clearing `header2` at the same time, macros (or inline functions) can be introduced: `FT_SET_HEADER(const char *)` and `FT_SET_HEADER2(const char *)`. Then, the original `ft_print_header*` variables can be made private to futility.h.\n\nJulius, what do you think of this idea (both header2 and using pointers)?",
      "range": {
        "startLine": 312,
        "startChar": 1,
        "endLine": 317,
        "endChar": 38
      },
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1dd732ea_b1bddefe",
        "filename": "futility/cmd_show.c",
        "patchSetId": 20
      },
      "lineNbr": 317,
      "author": {
        "id": 1570422
      },
      "writtenOn": "2023-07-05T19:34:20Z",
      "side": 1,
      "message": "On a related note, I was considering creating macros to append to header and clear as well. Basically do all header manipulation in macros rather than manually.\nso `FT_SET_HEADER`, `FT_APPEND_TO_HEADER` and `FT_TRIM_HEADER` etc",
      "parentUuid": "06589ca5_f3821c4c",
      "range": {
        "startLine": 312,
        "startChar": 1,
        "endLine": 317,
        "endChar": 38
      },
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7bea1037_40bab5fc",
        "filename": "futility/cmd_show.c",
        "patchSetId": 20
      },
      "lineNbr": 317,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2023-07-06T02:03:49Z",
      "side": 1,
      "message": "I think a header2 sounds reasonable enough considering that we also need it for some of the GBB keys. I\u0027m not sure I see the point in wrapping everything in macros. Using pointers sounds fine but then just writing `ft_print_header2 \u003d \"preamble\";` / `ft_print_header2 \u003d NULL` sounds easy enough to work with that? (If you need to build something out of a runtime string you can always use `strdup()` or `asprintf()` to make that easy. For a CLI tool we don\u0027t need to worry about memory-leaking a handful of strings.)",
      "parentUuid": "1dd732ea_b1bddefe",
      "range": {
        "startLine": 312,
        "startChar": 1,
        "endLine": 317,
        "endChar": 38
      },
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4b055e34_7c49ca6d",
        "filename": "futility/cmd_show.c",
        "patchSetId": 20
      },
      "lineNbr": 324,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2023-07-05T07:26:22Z",
      "side": 1,
      "message": "I\u0027m not sure if we should change all of these error messages to `FT_PRINT` and friends. If these are considered as unexpected errors for `futility show` (which IMO is the case), then the errors should be printed to stderr and `futility` should exit with non-zero code. Otherwise, if we\u0027re printing `data_key::invalid` for other script to parse, then `futility` should exit with 0.",
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "51d59738_6df5a04c",
        "filename": "futility/cmd_show.c",
        "patchSetId": 20
      },
      "lineNbr": 324,
      "author": {
        "id": 1570422
      },
      "writtenOn": "2023-07-05T19:34:20Z",
      "side": 1,
      "message": "Sounds good, I can do that. I\u0027ll leave this open for an ack from Julius since he requested the `::invalid` print here.",
      "parentUuid": "4b055e34_7c49ca6d",
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e1bbdd0b_365005a0",
        "filename": "futility/cmd_show.c",
        "patchSetId": 20
      },
      "lineNbr": 324,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2023-07-06T02:03:49Z",
      "side": 1,
      "message": "I agree that we probably don\u0027t need a parseable output line for every possible kind of incorrect image, but I do think we should have it for the most important ones like invalid body signature. So I think there are cases where the return code will be 1 but we still want the machine-parseable output to explain what exactly was broken.\n\nWhether this case is one of them is up for debate, I don\u0027t particularly care. I think invalid signatures and hashes in general (where there is a hash/signature and the data structure holding it could be unpacked correctly, but it just doesn\u0027t match what it\u0027s supposed to) are the important things we should indicate in the parseable output. For everything else, it doesn\u0027t matter that much.\n\nI do agree that you shouldn\u0027t change any messages from ERROR() to FT_READABLE_PRINT() (note that ERROR() already goes to stderr so it\u0027s already \"human-readable only\" in the sense that we don\u0027t expect calling programs that want parseable output to read stderr).",
      "parentUuid": "51d59738_6df5a04c",
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e4afdcb4_32b5d667",
        "filename": "futility/cmd_show.c",
        "patchSetId": 20
      },
      "lineNbr": 324,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2023-07-06T03:42:15Z",
      "side": 1,
      "message": "\u003e So I think there are cases where the return code will be 1 but we still want the machine-parseable output to explain what exactly was broken.\n\nHow do we expect the parsing script to handle that? Most scripts should have `set -e`, so in order to grep `data_key::invalid`, it has to ignore the exit code of `futility show` (which makes things more complicated IMO, because the script needs to take care of the `invalid` case and non-zero exit code case separately). I don\u0027t see how this is better than \"letting futility print the errors to stderr\".\n\nIf, the purpose of the script is to check if a signature/hash is valid, then `futility verify` should be used instead, which is designed exactly for that. BTW I just found that `verify` and `show` differ by only an option `show_option.strict`, which controls the return value.",
      "parentUuid": "e1bbdd0b_365005a0",
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "076cfc0b_66754b2c",
        "filename": "futility/cmd_show.c",
        "patchSetId": 20
      },
      "lineNbr": 324,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2023-07-06T23:38:14Z",
      "side": 1,
      "message": "Well, that\u0027s up to the caller, I just think we should keep things flexible. Of course in most cases I expect callers to just abort and not try to parse any output if the return code is non-zero. But if they do want to parse the error output for some reason, I still think we should make sure it is well-formed (i.e. no log spam that doesn\u0027t match the output format on stdout) and still contains as much information as we knew before we died.\n\nI have to admit I wasn\u0027t even aware we have a `verify`. I guess if that\u0027s available as an alternative then that\u0027s fine by me as well. However, it doesn\u0027t look like `show_option.strict` is super consistently implemented everywhere... e.g. when the firmware body signature doesn\u0027t match, it looks like it still returns an error code even without `strict`.\n\nI think the important thing is that callers have a way to tell reliably if some signature doesn\u0027t match, including exactly what signature that was. We can do that either by cleaning up `strict` and making sure `show` never returns an error code if any signatures and hashes don\u0027t match, or by making sure that there\u0027s still usable output even with an error code.",
      "parentUuid": "e4afdcb4_32b5d667",
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b4492ea1_4c1244a5",
        "filename": "futility/cmd_show.c",
        "patchSetId": 20
      },
      "lineNbr": 334,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2023-07-05T07:26:22Z",
      "side": 1,
      "message": "Extra space.",
      "range": {
        "startLine": 334,
        "startChar": 21,
        "endLine": 334,
        "endChar": 22
      },
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3e7c4c2c_acbada64",
        "filename": "futility/cmd_show.c",
        "patchSetId": 20
      },
      "lineNbr": 334,
      "author": {
        "id": 1570422
      },
      "writtenOn": "2023-07-05T19:34:20Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b4492ea1_4c1244a5",
      "range": {
        "startLine": 334,
        "startChar": 21,
        "endLine": 334,
        "endChar": 22
      },
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "56fe63ab_7683fe5c",
        "filename": "futility/cmd_show.c",
        "patchSetId": 20
      },
      "lineNbr": 487,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2023-07-05T07:26:22Z",
      "side": 1,
      "message": "space",
      "range": {
        "startLine": 487,
        "startChar": 37,
        "endLine": 487,
        "endChar": 38
      },
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "478bbb50_2ac7d0f2",
        "filename": "futility/cmd_show.c",
        "patchSetId": 20
      },
      "lineNbr": 487,
      "author": {
        "id": 1570422
      },
      "writtenOn": "2023-07-05T19:34:20Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "56fe63ab_7683fe5c",
      "range": {
        "startLine": 487,
        "startChar": 37,
        "endLine": 487,
        "endChar": 38
      },
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1af8564e_05888ed6",
        "filename": "futility/futility.h",
        "patchSetId": 20
      },
      "lineNbr": 93,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2023-07-05T07:26:22Z",
      "side": 1,
      "message": "Should this be `extern`, so that we only have one `ft_print_header` instance?",
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1c84d7cc_943ac4bc",
        "filename": "futility/futility.h",
        "patchSetId": 20
      },
      "lineNbr": 93,
      "author": {
        "id": 1570422
      },
      "writtenOn": "2023-07-05T19:34:20Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1af8564e_05888ed6",
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1dcef92e_51c1ec66",
        "filename": "futility/futility.h",
        "patchSetId": 20
      },
      "lineNbr": 102,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2023-07-05T07:26:22Z",
      "side": 1,
      "message": "Use tabs for alignment. An alternative is to have only a single space (see `FATAL` for example).",
      "range": {
        "startLine": 102,
        "startChar": 45,
        "endLine": 102,
        "endChar": 72
      },
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2ad4e04d_5fb1bb64",
        "filename": "futility/futility.h",
        "patchSetId": 20
      },
      "lineNbr": 102,
      "author": {
        "id": 1570422
      },
      "writtenOn": "2023-07-05T19:34:20Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1dcef92e_51c1ec66",
      "range": {
        "startLine": 102,
        "startChar": 45,
        "endLine": 102,
        "endChar": 72
      },
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cd8bb8dd_9627d20f",
        "filename": "futility/futility.h",
        "patchSetId": 20
      },
      "lineNbr": 103,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2023-07-05T07:26:22Z",
      "side": 1,
      "message": "Set `ft_print_header[FT_PRINT_MAX_HEADER_SIZE - 1] \u003d \u0027\\0\u0027` just to be safe.",
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bcd63441_1e2a61ab",
        "filename": "futility/futility.h",
        "patchSetId": 20
      },
      "lineNbr": 103,
      "author": {
        "id": 1570422
      },
      "writtenOn": "2023-07-05T19:34:20Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "cd8bb8dd_9627d20f",
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8436cab2_ec80de5f",
        "filename": "futility/misc.c",
        "patchSetId": 20
      },
      "lineNbr": 171,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2023-07-05T07:26:22Z",
      "side": 1,
      "message": "`ft_print_header` shouldn\u0027t be printed here and in the `FT_PARSEABLE_PRINT` call below. See an example output:\n\n```\nbios::GBB::hwid::sha256_sum::966b97faca52b9d227f10393d23188efd30562c017d1745e473ba40a4891ca1abios::GBB:::validbios::GBB::\n```",
      "range": {
        "startLine": 171,
        "startChar": 1,
        "endLine": 171,
        "endChar": 9
      },
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "fb450ea3_651e9701",
        "filename": "futility/misc.c",
        "patchSetId": 20
      },
      "lineNbr": 171,
      "author": {
        "id": 1570422
      },
      "writtenOn": "2023-07-05T19:34:20Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "8436cab2_ec80de5f",
      "range": {
        "startLine": 171,
        "startChar": 1,
        "endLine": 171,
        "endChar": 9
      },
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "493fb901_cbf35414",
        "filename": "futility/misc.c",
        "patchSetId": 20
      },
      "lineNbr": 173,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2023-07-05T07:26:22Z",
      "side": 1,
      "message": "extra space",
      "range": {
        "startLine": 173,
        "startChar": 20,
        "endLine": 173,
        "endChar": 21
      },
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ffb1cbb7_a605f4be",
        "filename": "futility/misc.c",
        "patchSetId": 20
      },
      "lineNbr": 173,
      "author": {
        "id": 1570422
      },
      "writtenOn": "2023-07-05T19:34:20Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "493fb901_cbf35414",
      "range": {
        "startLine": 173,
        "startChar": 20,
        "endLine": 173,
        "endChar": 21
      },
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "979f6488_f80003e2",
        "filename": "futility/vb2_helper.c",
        "patchSetId": 20
      },
      "lineNbr": 97,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2023-07-05T07:26:22Z",
      "side": 1,
      "message": "Move this before the `futil_open_and_map_file` call.",
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ebb2f926_b94155a6",
        "filename": "futility/vb2_helper.c",
        "patchSetId": 20
      },
      "lineNbr": 97,
      "author": {
        "id": 1570422
      },
      "writtenOn": "2023-07-05T19:34:20Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "979f6488_f80003e2",
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dd60038d_a35522d4",
        "filename": "futility/vb2_helper.c",
        "patchSetId": 20
      },
      "lineNbr": 98,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2023-07-05T07:26:22Z",
      "side": 1,
      "message": "Wrong format:\n\n```\nif (x) {\n}\n```\n\nSame for the 2 instances below.",
      "range": {
        "startLine": 97,
        "startChar": 1,
        "endLine": 98,
        "endChar": 2
      },
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4db64e28_bbe486aa",
        "filename": "futility/vb2_helper.c",
        "patchSetId": 20
      },
      "lineNbr": 98,
      "author": {
        "id": 1570422
      },
      "writtenOn": "2023-07-05T19:34:20Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "dd60038d_a35522d4",
      "range": {
        "startLine": 97,
        "startChar": 1,
        "endLine": 98,
        "endChar": 2
      },
      "revId": "7b09c90a9e89ee4bdb0fbfdc55ae54ab02c3fc99",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}