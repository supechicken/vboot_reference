{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "8995c514_b11e01ed",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1113505
      },
      "writtenOn": "2021-01-21T09:31:38Z",
      "side": 1,
      "message": "Since the performance and rendering stack is a little bit complex because of many corner cases. I would suggest to have a doc if you would like to go ahead with this topic.",
      "revId": "c535f9c8e7e0d29defd7762f0f36245fc059a554",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "11e28a97_35904fc8",
        "filename": "firmware/2lib/2ui_screens.c",
        "patchSetId": 1
      },
      "lineNbr": 98,
      "author": {
        "id": 1113505
      },
      "writtenOn": "2021-01-21T09:31:38Z",
      "side": 1,
      "message": "If I remember correctly, vb2ex_prepare_log_screen() was slow for parsing the whole screen and split to multiple pages. It will still be slow if you keep pass the same string into it.\n\nSuggest to consult with rocco to have more detail for current implementation.",
      "range": {
        "startLine": 98,
        "startChar": 26,
        "endLine": 98,
        "endChar": 50
      },
      "revId": "c535f9c8e7e0d29defd7762f0f36245fc059a554",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2fa8e9a0_e2c62f54",
        "filename": "firmware/2lib/2ui_screens.c",
        "patchSetId": 1
      },
      "lineNbr": 98,
      "author": {
        "id": 1240396
      },
      "writtenOn": "2021-01-21T10:43:31Z",
      "side": 1,
      "message": "I did a quick experiment. vb2ex_prepare_log_screen() spend about 6ms.",
      "parentUuid": "11e28a97_35904fc8",
      "range": {
        "startLine": 98,
        "startChar": 26,
        "endLine": 98,
        "endChar": 50
      },
      "revId": "c535f9c8e7e0d29defd7762f0f36245fc059a554",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4e8073ee_72a66ebe",
        "filename": "firmware/2lib/2ui_screens.c",
        "patchSetId": 1
      },
      "lineNbr": 98,
      "author": {
        "id": 1113505
      },
      "writtenOn": "2021-01-22T04:41:42Z",
      "side": 1,
      "message": "Sounds fast enough. Maybe it is slow for firmware log? If they are fast, how about just call vb2ex_prepare_log_screen() every time?\n\nRocco, I remembered that you\u0027ve mentioned there is some performance issue on vb2ex_prepare_log_screen(). Do you have any recall about that?",
      "parentUuid": "2fa8e9a0_e2c62f54",
      "range": {
        "startLine": 98,
        "startChar": 26,
        "endLine": 98,
        "endChar": 50
      },
      "revId": "c535f9c8e7e0d29defd7762f0f36245fc059a554",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3e85b60f_263f111f",
        "filename": "firmware/2lib/2ui_screens.c",
        "patchSetId": 1
      },
      "lineNbr": 98,
      "author": {
        "id": 1383774
      },
      "writtenOn": "2021-03-09T10:53:52Z",
      "side": 1,
      "message": "Like chung-sheng mentioned, it spends only few ms for all the mini-diag related strings, and spends ~17 ms for firmware log which has hundred of pages.\n\nIMO calling vb2ex_prepare_log_screen() is fast enough for current scenarios.\nHowever, it is not a efficiency issue -- passing a NULL is not valid for vb2ex_prepare_log_screen(). This is a validity check here.",
      "parentUuid": "4e8073ee_72a66ebe",
      "range": {
        "startLine": 98,
        "startChar": 26,
        "endLine": 98,
        "endChar": 50
      },
      "revId": "c535f9c8e7e0d29defd7762f0f36245fc059a554",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5f62ce5e_8a3780ec",
        "filename": "firmware/2lib/2ui_screens.c",
        "patchSetId": 1
      },
      "lineNbr": 105,
      "author": {
        "id": 1113505
      },
      "writtenOn": "2021-01-21T09:31:38Z",
      "side": 1,
      "message": "In CL:2640012, if depthcharge side already know whether it need re-drawing the log page, maybe we can remove force_display and make it always redraw. \n\nThe force_display is a workaround since only partial component of current Groot framework will ignore redrawing request if the state doesn\u0027t change. It will be slow if always redraw. I am not sure if log screen is the only bottleneck.",
      "range": {
        "startLine": 105,
        "startChar": 6,
        "endLine": 105,
        "endChar": 19
      },
      "revId": "c535f9c8e7e0d29defd7762f0f36245fc059a554",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6338fda3_14f60683",
        "filename": "firmware/2lib/2ui_screens.c",
        "patchSetId": 1
      },
      "lineNbr": 105,
      "author": {
        "id": 1240396
      },
      "writtenOn": "2021-01-21T09:54:24Z",
      "side": 1,
      "message": "https://source.corp.google.com/chromeos_public/src/platform/vboot_reference/firmware/2lib/2ui.c;l\u003d323?q\u003dforce_display\u0026ss\u003dpiper%2FGoogle%2Fchromeos_public:src%2Fplatform%2F\n\nA parts of logic of deciding whether to redrawing is in vboot. We still need to pass the status from depthcharge to vboot.\n\nMaybe we can create a new field in vb2_screen_state to replace force_display. But the whole structure of this logic doesn\u0027t change so much.",
      "parentUuid": "5f62ce5e_8a3780ec",
      "range": {
        "startLine": 105,
        "startChar": 6,
        "endLine": 105,
        "endChar": 19
      },
      "revId": "c535f9c8e7e0d29defd7762f0f36245fc059a554",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "61cd5d9c_3d486ce4",
        "filename": "firmware/2lib/2ui_screens.c",
        "patchSetId": 1
      },
      "lineNbr": 105,
      "author": {
        "id": 1113505
      },
      "writtenOn": "2021-01-22T04:41:42Z",
      "side": 1,
      "message": "I remembered that there was a plan to remove this \"if condition\" in Groot. That is, make the main loop call depthcharge everytime. Not sure if it is feasible.",
      "parentUuid": "6338fda3_14f60683",
      "range": {
        "startLine": 105,
        "startChar": 6,
        "endLine": 105,
        "endChar": 19
      },
      "revId": "c535f9c8e7e0d29defd7762f0f36245fc059a554",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}