{
  "comments": [
    {
      "key": {
        "uuid": "ffe262aa_39fc8d82",
        "filename": "firmware/lib/vboot_api_kernel.c",
        "patchSetId": 3
      },
      "lineNbr": 208,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2019-10-02T19:38:38Z",
      "side": 0,
      "message": "Actually... hmm. I think the concern mentioned here is still somewhat valid. We should remove this code because it doesn\u0027t do anything anymore anyway, but I think we may also have carried a potential issue (which isn\u0027t really visible in practice because we very rarely roll kernel keys and our updates rarely roll back) since we switched to vboot2.\n\nI think the correct vboot2 check to skip the rollback update here would just be\n\n if (nvdata_get(VB2_NV_FW_RESULT) \u003d\u003d VB2_FW_RESULT_TRYING)\n   return rv;\n\nOh look, and after some digging it seems that we already have a bug for that (b/35575422) and it\u0027s already assigned to you! :P",
      "revId": "3ad1b24a828efb3bc92172fb1b04fc78dc80748e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "37b985ae_04fc525e",
        "filename": "firmware/lib/vboot_api_kernel.c",
        "patchSetId": 3
      },
      "lineNbr": 208,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2019-10-03T09:43:10Z",
      "side": 0,
      "message": "I believe you\u0027re right -- even if we have a kernel with a valid key, it\u0027s better to wait for that kernel to boot properly before rolling forward the kernel key.\n\nHowever, in the bug you dug up, Randall mentions that his solution for preventing roll-forward for enterprise also deals with this case, by temporarily setting kernel_max_rollforward\u003d0 and fw_max_rollforward\u003d0.  I\u0027m not even sure if this is implemented yet, but even if it is, seems like keeping this conditional would be a nice safeguard regardless?",
      "parentUuid": "ffe262aa_39fc8d82",
      "revId": "3ad1b24a828efb3bc92172fb1b04fc78dc80748e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "de7294f5_3786e9e0",
        "filename": "tests/vboot_api_kernel4_tests.c",
        "patchSetId": 6
      },
      "lineNbr": 222,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2019-10-04T00:12:29Z",
      "side": 0,
      "message": "Can we get a test for the new behavior instead?",
      "revId": "3ad1b24a828efb3bc92172fb1b04fc78dc80748e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cee0b31c_f15f1ad1",
        "filename": "tests/vboot_api_kernel4_tests.c",
        "patchSetId": 6
      },
      "lineNbr": 222,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2019-10-04T07:01:53Z",
      "side": 0,
      "message": "Done",
      "parentUuid": "de7294f5_3786e9e0",
      "revId": "3ad1b24a828efb3bc92172fb1b04fc78dc80748e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f863ac13_f5986448",
        "filename": "tests/vboot_api_kernel4_tests.c",
        "patchSetId": 6
      },
      "lineNbr": 246,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2019-10-04T00:12:29Z",
      "side": 0,
      "message": "Here too (even though we took out that specific code path, the new stuff with vb2api_fail() should effectively still behave that way, and we should test that).",
      "revId": "3ad1b24a828efb3bc92172fb1b04fc78dc80748e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d23d088a_8e85e777",
        "filename": "tests/vboot_api_kernel4_tests.c",
        "patchSetId": 6
      },
      "lineNbr": 246,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2019-10-04T07:01:53Z",
      "side": 0,
      "message": "Done",
      "parentUuid": "f863ac13_f5986448",
      "revId": "3ad1b24a828efb3bc92172fb1b04fc78dc80748e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}