{
  "comments": [
    {
      "key": {
        "uuid": "c7a77c23_8859bb03",
        "filename": "firmware/lib/vboot_api_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 200,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2017-11-16T01:10:27Z",
      "side": 1,
      "message": "Shouldn\u0027t we get rid of this case now?",
      "revId": "6f7acd8a1de5ac0a165d706a5348fe11b972c901",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a2489670_29b03137",
        "filename": "firmware/lib/vboot_api_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 200,
      "author": {
        "id": 1000187
      },
      "writtenOn": "2017-11-16T01:51:37Z",
      "side": 1,
      "message": "This is still needed.  kernel_max_rollforward will eventually get set in 3 places:\n\nrecovery image: to 0\nsetgoodkernel (unenrolled): to 0xffffffffe\nenterprise policy (enrolled): depends on policy\n\nWe could theoretically set it to 0 in chromeos-firmwareupdate, but then the check for \"are we trying firmware B next boot\" would need to go in setgoodkernel and enterprise policy, to stop them from overwriting that 0.",
      "parentUuid": "c7a77c23_8859bb03",
      "revId": "6f7acd8a1de5ac0a165d706a5348fe11b972c901",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "55e09f70_4e2fcb91",
        "filename": "firmware/lib/vboot_api_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 200,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2017-11-16T04:03:37Z",
      "side": 1,
      "message": "I\u0027m pretty sure this check has actually not been doing anything for years anyway, it\u0027s just that nobody removed it yet. There\u0027s no clear equivalent to FWB_TRIED in the vboot2 model so we just never set that flag when we translate vboot2 into vboot1 shared data (in coreboot). That\u0027s why b/35575422 is an open bug at all.\n\nThat\u0027s why I also think setting max_rollforward to the currently booted version (instead of to 0xfffffffe) in setgoodkernel would be a good idea, because I think it should solve this problem in a pretty straight-forward way. We don\u0027t need to depend the kernel rollforward state on firmware updates anymore because the kernel itself can tell us what it wants to roll forward to now.",
      "parentUuid": "a2489670_29b03137",
      "revId": "6f7acd8a1de5ac0a165d706a5348fe11b972c901",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d62875bd_d36ccd25",
        "filename": "firmware/lib/vboot_api_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 229,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2017-11-16T01:10:27Z",
      "side": 1,
      "message": "Can this be vb2_nv_get() instead? [I am officially unable to figure out which set of NVRAM accessors is valid for use in what function at this point. Stuff seems to get copied from one context into the other in multiple places, and maybe it would be okay to read but not to write one or the other in certain situations... it\u0027s quite a mess. :( ]",
      "revId": "6f7acd8a1de5ac0a165d706a5348fe11b972c901",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ba9eaed5_1921a32e",
        "filename": "firmware/lib/vboot_api_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 229,
      "author": {
        "id": 1000187
      },
      "writtenOn": "2017-11-16T01:51:37Z",
      "side": 1,
      "message": "I\u0027d like to remove VbNvGet() entirely, and only use vb2_nv_get().  Easier to do this in a followup CL which only refactors those without adding any new behavior.",
      "parentUuid": "d62875bd_d36ccd25",
      "revId": "6f7acd8a1de5ac0a165d706a5348fe11b972c901",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5c96364f_d0f04b7f",
        "filename": "firmware/lib/vboot_api_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 236,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2017-11-16T01:10:27Z",
      "side": 1,
      "message": "Doesn\u0027t seem strictly necessary since the code below already checks for kernel_version \u003e start_version.",
      "revId": "6f7acd8a1de5ac0a165d706a5348fe11b972c901",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "64763736_adcb8478",
        "filename": "firmware/lib/vboot_api_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 236,
      "author": {
        "id": 1000187
      },
      "writtenOn": "2017-11-16T01:51:37Z",
      "side": 1,
      "message": "But then \u0027crossystem tpm_kernver\u0027 would report 0, not the actual version in the TPM.",
      "parentUuid": "5c96364f_d0f04b7f",
      "revId": "6f7acd8a1de5ac0a165d706a5348fe11b972c901",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "55d65f33_3a587c1e",
        "filename": "firmware/lib/vboot_api_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 236,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2017-11-16T04:03:37Z",
      "side": 1,
      "message": "Good point.",
      "parentUuid": "64763736_adcb8478",
      "revId": "6f7acd8a1de5ac0a165d706a5348fe11b972c901",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}