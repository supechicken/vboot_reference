{
  "comments": [
    {
      "key": {
        "uuid": "5d101208_33b962cf",
        "filename": "tests/vb2_ui_tests.c",
        "patchSetId": 4
      },
      "lineNbr": 59,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2020-06-10T08:35:50Z",
      "side": 1,
      "message": "Where is this used?",
      "range": {
        "startLine": 59,
        "startChar": 11,
        "endLine": 59,
        "endChar": 31
      },
      "revId": "aa5ef4f9223d3533254155c8183b4d7fb1f8d27d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b6dcec08_c5de690c",
        "filename": "tests/vb2_ui_tests.c",
        "patchSetId": 4
      },
      "lineNbr": 59,
      "author": {
        "id": 1383774
      },
      "writtenOn": "2020-06-17T03:20:48Z",
      "side": 1,
      "message": "Removed.",
      "parentUuid": "5d101208_33b962cf",
      "range": {
        "startLine": 59,
        "startChar": 11,
        "endLine": 59,
        "endChar": 31
      },
      "revId": "aa5ef4f9223d3533254155c8183b4d7fb1f8d27d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6f6ec33e_452fc103",
        "filename": "tests/vb2_ui_tests.c",
        "patchSetId": 4
      },
      "lineNbr": 397,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2020-06-10T08:35:50Z",
      "side": 1,
      "message": "Why not choose one or the other?",
      "range": {
        "startLine": 396,
        "startChar": 8,
        "endLine": 397,
        "endChar": 55
      },
      "revId": "aa5ef4f9223d3533254155c8183b4d7fb1f8d27d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2b47d316_7700ae3d",
        "filename": "tests/vb2_ui_tests.c",
        "patchSetId": 4
      },
      "lineNbr": 397,
      "author": {
        "id": 1383774
      },
      "writtenOn": "2020-06-11T03:32:47Z",
      "side": 1,
      "message": "We have tests set the flag VB2_GBB_FLAG_FORCE_DEV_SWITCH_ON directly now.\n(e.g. \"/* Dev mode forced by GBB flag */\")\n\nSince VB2_GBB_FLAG_FORCE_DEV_SWITCH_ON will make vb2_dev_boot_allowed() return 1 but our previous mock structure did not support this, I added back the statement here.\n\nI figure out several alternative plans, what\u0027s your opinions?\n1. mock_dev_boot_allowed || (gbb.flags \u0026 VB2_GBB_FLAG_FORCE_DEV_SWITCH_ON) here (current approach)\n2. get rid of vb2_dev_boot_* mock functions, set flags directly in test items.\n(i.e. fwmp-\u003eflags |\u003d VB2_SECDATA_FWMP_DEV_DISABLE_BOOT instead of mock_dev_boot_allowed \u003d 1)\n(We don\u0027t need to test too much since these functionality are fully tested in misc_tests)\n3. we set gbb.flags |\u003d VB2_GBB_FLAG_FORCE_DEV_SWITCH_ON and mock_dev_boot_allowed \u003d 1 manually in test items.\n4. we can ignore this since currently we don\u0027t call vb2_dev_boot_allowed() in \"/* Dev mode forced by GBB flag */\" tests.",
      "parentUuid": "6f6ec33e_452fc103",
      "range": {
        "startLine": 396,
        "startChar": 8,
        "endLine": 397,
        "endChar": 55
      },
      "revId": "aa5ef4f9223d3533254155c8183b4d7fb1f8d27d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7c319fdd_fd26e8b1",
        "filename": "tests/vb2_ui_tests.c",
        "patchSetId": 4
      },
      "lineNbr": 397,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2020-06-12T02:53:08Z",
      "side": 1,
      "message": "How about creating a function\n\n int vb2_dev_mode_forced(ui) {\n     return vb2_get_gbb(ui-\u003ectx)-\u003eflags \u0026 VB2_GBB_FLAG_FORCE_DEV_SWITCH_ON;\n }\n\nand mock it in UI tests with \u0027mock_dev_mode_forced\u0027? And then replace in the tests\n\n gbb.flags |\u003d VB2_GBB_FLAG_FORCE_DEV_SWITCH_ON \n\nwith\n\n mock_dev_mode_forced \u003d 1",
      "parentUuid": "2b47d316_7700ae3d",
      "range": {
        "startLine": 396,
        "startChar": 8,
        "endLine": 397,
        "endChar": 55
      },
      "revId": "aa5ef4f9223d3533254155c8183b4d7fb1f8d27d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3a585dc4_346ff84e",
        "filename": "tests/vb2_ui_tests.c",
        "patchSetId": 4
      },
      "lineNbr": 397,
      "author": {
        "id": 1383774
      },
      "writtenOn": "2020-06-17T03:20:48Z",
      "side": 1,
      "message": "Removed here.\nAdd back with splitting out _forced functions in separate CL afterwards.",
      "parentUuid": "7c319fdd_fd26e8b1",
      "range": {
        "startLine": 396,
        "startChar": 8,
        "endLine": 397,
        "endChar": 55
      },
      "revId": "aa5ef4f9223d3533254155c8183b4d7fb1f8d27d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3a161a98_82ef7729",
        "filename": "tests/vb2_ui_tests.c",
        "patchSetId": 4
      },
      "lineNbr": 397,
      "author": {
        "id": 1383774
      },
      "writtenOn": "2020-06-17T13:17:53Z",
      "side": 1,
      "message": "Should be closed here. See\nhttps://chromium-review.googlesource.com/c/chromiumos/platform/vboot_reference/+/2249267/1/tests/vb2_ui_tests.c#399",
      "parentUuid": "3a585dc4_346ff84e",
      "range": {
        "startLine": 396,
        "startChar": 8,
        "endLine": 397,
        "endChar": 55
      },
      "revId": "aa5ef4f9223d3533254155c8183b4d7fb1f8d27d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d1ff93bc_f112f3ee",
        "filename": "tests/vb2_ui_tests.c",
        "patchSetId": 4
      },
      "lineNbr": 476,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2020-06-10T08:35:50Z",
      "side": 1,
      "message": "Consider checking instead:\n\n  mock_beeped_ms[0] - mock_time_start - 20 * VB2_MSEC_PER_SEC \u003c\u003d BEEP_FUZZ_MS\n\n(I.e. what\u0027s important is that the beep occurs +-N msec, not that it occurs *after* the expected time.)\n\nThere\u0027s plenty of existing test code to look at.  See vboot_ui_legacy_clamshell_beep_tests.c.",
      "range": {
        "startLine": 476,
        "startChar": 4,
        "endLine": 476,
        "endChar": 25
      },
      "revId": "aa5ef4f9223d3533254155c8183b4d7fb1f8d27d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "aaf66c23_21654f9f",
        "filename": "tests/vb2_ui_tests.c",
        "patchSetId": 4
      },
      "lineNbr": 476,
      "author": {
        "id": 1383774
      },
      "writtenOn": "2020-06-17T03:20:48Z",
      "side": 1,
      "message": "Add fuzzy match here (500ms)\nSplit beep tests in CL:2249261",
      "parentUuid": "d1ff93bc_f112f3ee",
      "range": {
        "startLine": 476,
        "startChar": 4,
        "endLine": 476,
        "endChar": 25
      },
      "revId": "aa5ef4f9223d3533254155c8183b4d7fb1f8d27d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e29f46eb_8b8aa887",
        "filename": "tests/vb2_ui_tests.c",
        "patchSetId": 4
      },
      "lineNbr": 600,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2020-06-10T08:35:50Z",
      "side": 1,
      "message": "Seems like another case where just the one line could be swapped based on the value of DETACHABLE.",
      "range": {
        "startLine": 582,
        "startChar": 0,
        "endLine": 600,
        "endChar": 2
      },
      "revId": "aa5ef4f9223d3533254155c8183b4d7fb1f8d27d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3b9dbdac_5b0141da",
        "filename": "tests/vb2_ui_tests.c",
        "patchSetId": 4
      },
      "lineNbr": 600,
      "author": {
        "id": 1383774
      },
      "writtenOn": "2020-06-17T03:20:48Z",
      "side": 1,
      "message": "Does the wrapping means we don\u0027t care whether Ctrl+U (and other ctrl+ shortcuts) works in DETACHABLE or not?\n\nI think we should check ctrl+ shortcuts both in DETACHABLE and non-DETACHABLE.",
      "parentUuid": "e29f46eb_8b8aa887",
      "range": {
        "startLine": 582,
        "startChar": 0,
        "endLine": 600,
        "endChar": 2
      },
      "revId": "aa5ef4f9223d3533254155c8183b4d7fb1f8d27d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8e4f2986_b65a0100",
        "filename": "tests/vb2_ui_tests.c",
        "patchSetId": 4
      },
      "lineNbr": 600,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2020-06-17T11:09:22Z",
      "side": 1,
      "message": "Oh, good point.  Yes, let\u0027s keep both.",
      "parentUuid": "3b9dbdac_5b0141da",
      "range": {
        "startLine": 582,
        "startChar": 0,
        "endLine": 600,
        "endChar": 2
      },
      "revId": "aa5ef4f9223d3533254155c8183b4d7fb1f8d27d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "adbf9eca_e8d98a81",
        "filename": "tests/vb2_ui_tests.c",
        "patchSetId": 4
      },
      "lineNbr": 600,
      "author": {
        "id": 1383774
      },
      "writtenOn": "2020-06-17T13:17:53Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "8e4f2986_b65a0100",
      "range": {
        "startLine": 582,
        "startChar": 0,
        "endLine": 600,
        "endChar": 2
      },
      "revId": "aa5ef4f9223d3533254155c8183b4d7fb1f8d27d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3f75e082_73f58b57",
        "filename": "tests/vb2_ui_tests.c",
        "patchSetId": 4
      },
      "lineNbr": 1028,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2020-06-10T08:35:50Z",
      "side": 1,
      "message": "As a general comment, this is going to be a huge pain when we add menu items here.  There are definitely ways to test menu flow without specifying the exact position of each item.",
      "range": {
        "startLine": 1028,
        "startChar": 1,
        "endLine": 1028,
        "endChar": 18
      },
      "revId": "aa5ef4f9223d3533254155c8183b4d7fb1f8d27d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bcfdfc0e_6cecb0e5",
        "filename": "tests/vb2_ui_tests.c",
        "patchSetId": 4
      },
      "lineNbr": 1028,
      "author": {
        "id": 1383774
      },
      "writtenOn": "2020-06-11T03:32:47Z",
      "side": 1,
      "message": "I have not looked at our current stack works...\nBut I think if we have history stack and \u0027back\u0027, we can navigate with relative position here.\nWe could reduce a lot of unnecessary keys here.\n\n--\n\nAnother plan here, we will inspect menu items easier if we can access \"ui\" in \"ui_loop\".\nWe can UP to the top then DOWN to the button, check the target screen id (or target text) without entering them directly.\nBut I do not think that we have ways to access \"ui\" for now\n(I think we can\u0027t mock a function in same file - e.g. \"menu_navigation_action\" is at the same file as \"ui_loop\", so it is useless to mock \"menu_navigation_action\" here)",
      "parentUuid": "3f75e082_73f58b57",
      "range": {
        "startLine": 1028,
        "startChar": 1,
        "endLine": 1028,
        "endChar": 18
      },
      "revId": "aa5ef4f9223d3533254155c8183b4d7fb1f8d27d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4eea1bd8_49e9f910",
        "filename": "tests/vb2_ui_tests.c",
        "patchSetId": 4
      },
      "lineNbr": 1028,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2020-06-17T11:09:22Z",
      "side": 1,
      "message": "There could be a couple ways of doing this...\n\n(1) override menu_navigation_action() (works as long as you set the function as test_mockable)\n- Downside: less coverage, although we should have unit tests for the navigation functions in the other vb2_ui_test file.\n\n\n(2) add a test_action() which gets called in ui_loop().  Only call the function when TEST\u003d1.  Override the function in vb2_ui_tests.c to look up the correct menu item by string, and set selected_item to point there.\n- Upside: we can still include a few \"sanity checks\" which use manual UP/DOWN navigation, and just use string lookup for the rest.",
      "parentUuid": "bcfdfc0e_6cecb0e5",
      "range": {
        "startLine": 1028,
        "startChar": 1,
        "endLine": 1028,
        "endChar": 18
      },
      "revId": "aa5ef4f9223d3533254155c8183b4d7fb1f8d27d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "aa1e745a_6b411d30",
        "filename": "tests/vb2_ui_tests.c",
        "patchSetId": 4
      },
      "lineNbr": 1028,
      "author": {
        "id": 1383774
      },
      "writtenOn": "2020-06-17T13:17:53Z",
      "side": 1,
      "message": "Actually I just noticed that we have test_mockable recently.\nIf we choose (1), what about split one more file for screens? (e.g. vb2_ui_screen_tests.c)\n\nOn the other hand, if we choose (2), I think we can increase the mock_iter in test_action(), which should guaranteed to be the last function called in ui_loop().\n\nI will update these into the issue (b/156448738)",
      "parentUuid": "4eea1bd8_49e9f910",
      "range": {
        "startLine": 1028,
        "startChar": 1,
        "endLine": 1028,
        "endChar": 18
      },
      "revId": "aa5ef4f9223d3533254155c8183b4d7fb1f8d27d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}