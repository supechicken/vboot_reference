{
  "comments": [
    {
      "key": {
        "uuid": "6b763314_5a3fc548",
        "filename": "firmware/include/gpt_misc.h",
        "patchSetId": 3
      },
      "lineNbr": 143,
      "author": {
        "id": 1000187
      },
      "writtenOn": "2015-01-22T20:28:52Z",
      "side": 1,
      "message": "partition type guid?  (Partitions also have a unique GUID; I assume we\u0027re not talking about that one because then n is nonsensical)",
      "range": {
        "startLine": 143,
        "startChar": 58,
        "endLine": 143,
        "endChar": 62
      },
      "revId": "ba5632797718cf1fb2bb69bd68f316e6a5064843",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4b732f24_2e548b49",
        "filename": "firmware/include/gpt_misc.h",
        "patchSetId": 3
      },
      "lineNbr": 171,
      "author": {
        "id": 1000187
      },
      "writtenOn": "2015-01-22T20:28:52Z",
      "side": 1,
      "message": "const?",
      "range": {
        "startLine": 171,
        "startChar": 26,
        "endLine": 171,
        "endChar": 34
      },
      "revId": "ba5632797718cf1fb2bb69bd68f316e6a5064843",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2b70bb17_3ee679c1",
        "filename": "firmware/include/gpt_misc.h",
        "patchSetId": 3
      },
      "lineNbr": 176,
      "author": {
        "id": 1000187
      },
      "writtenOn": "2015-01-22T20:28:52Z",
      "side": 1,
      "message": "const?",
      "range": {
        "startLine": 176,
        "startChar": 42,
        "endLine": 176,
        "endChar": 50
      },
      "revId": "ba5632797718cf1fb2bb69bd68f316e6a5064843",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6b763314_ba551994",
        "filename": "firmware/include/gpt_misc.h",
        "patchSetId": 3
      },
      "lineNbr": 176,
      "author": {
        "id": 1000187
      },
      "writtenOn": "2015-01-22T20:28:52Z",
      "side": 1,
      "message": "const?",
      "range": {
        "startLine": 176,
        "startChar": 28,
        "endLine": 176,
        "endChar": 35
      },
      "revId": "ba5632797718cf1fb2bb69bd68f316e6a5064843",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "cb2b9fc1_0971a9cd",
        "filename": "firmware/lib/cgptlib/cgptlib.c",
        "patchSetId": 3
      },
      "lineNbr": 208,
      "author": {
        "id": 1002124
      },
      "writtenOn": "2015-01-20T20:31:48Z",
      "side": 1,
      "message": "Why the side effect of updating gpt-\u003ecurrent_kernel?",
      "revId": "ba5632797718cf1fb2bb69bd68f316e6a5064843",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0bf85789_0b9cfdf7",
        "filename": "firmware/lib/cgptlib/cgptlib.c",
        "patchSetId": 3
      },
      "lineNbr": 208,
      "author": {
        "id": 1003000
      },
      "writtenOn": "2015-01-20T20:32:59Z",
      "side": 1,
      "message": "It is required to ensure that GptUpdateKernelEntry works properly and updates the current kernel entry. It has a check at the beginning to see if current_kernel is found.",
      "parentUuid": "cb2b9fc1_0971a9cd",
      "revId": "ba5632797718cf1fb2bb69bd68f316e6a5064843",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "cb2b9fc1_09e6c9c0",
        "filename": "firmware/lib/cgptlib/cgptlib.c",
        "patchSetId": 3
      },
      "lineNbr": 208,
      "author": {
        "id": 1002124
      },
      "writtenOn": "2015-01-20T20:55:00Z",
      "side": 1,
      "message": "It seems really weird that calling GptFindNthEntry() which takes an arbitrary guid to update the current_kernel state. Wouldn\u0027t all the current_kernel logic kick in when it\u0027s trying to boot the device? Why would calling this function affect that?",
      "parentUuid": "0bf85789_0b9cfdf7",
      "revId": "ba5632797718cf1fb2bb69bd68f316e6a5064843",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2bc27b57_57494eb0",
        "filename": "firmware/lib/cgptlib/cgptlib.c",
        "patchSetId": 3
      },
      "lineNbr": 208,
      "author": {
        "id": 1003000
      },
      "writtenOn": "2015-01-21T18:48:08Z",
      "side": 1,
      "message": "we will be destroying the gpt structure before exiting from fastboot. So, current_kernel would be lost. Also, normal booting the device allocates its own gpt structure.\n\nWe have to update the kernel entry here because GptUpdateKernelEntry checks if current_kernel is set before updating the entry. If not, it returns.\n\nI can add another API GptUpdateCurrentKernel which updates current_kernel and that could be called from fastboot based on whether it is updating kernel entry. Does that seem more cleaner?",
      "parentUuid": "cb2b9fc1_09e6c9c0",
      "revId": "ba5632797718cf1fb2bb69bd68f316e6a5064843",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0bbf77c3_f9eb2f7f",
        "filename": "firmware/lib/cgptlib/cgptlib.c",
        "patchSetId": 3
      },
      "lineNbr": 208,
      "author": {
        "id": 1002124
      },
      "writtenOn": "2015-01-21T18:59:15Z",
      "side": 1,
      "message": "Ahh, I see. That\u0027s quite convoluted because of the current API/assumptions. That particular dilemma screams to me of needing a GptUpdateKernelEntry() variant that takes both the GptData and GptEntry. The current GptUpdateKernelEntry() function would only validate the current_kernel and then call the new function. int GptUpdateKernelWithEntry(GptData *gpt, GptEntry *enter, uint32_t update_type);\n\nint GptUpdateKernelEntry(GptData *gpt, uint32_t update_type)\n{\n    GptEntry *entries \u003d (GptEntry *)gpt-\u003eprimary_entries;\n    GptEntry *e \u003d entries + gpt-\u003ecurrent_kernel;\n\n    if (gpt-\u003ecurrent_kernel \u003d\u003d CGPT_KERNEL_ENTRY_NOT_FOUND)\n        return GPT_ERROR_INVALID_UPDATE_TYPE;\n\n    return GptUpdateKernelWithEntry(gpt, \n}",
      "parentUuid": "2bc27b57_57494eb0",
      "revId": "ba5632797718cf1fb2bb69bd68f316e6a5064843",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4b732f24_6e4e83bb",
        "filename": "firmware/lib/cgptlib/cgptlib.c",
        "patchSetId": 3
      },
      "lineNbr": 208,
      "author": {
        "id": 1000187
      },
      "writtenOn": "2015-01-22T20:28:52Z",
      "side": 1,
      "message": "Agree with Aaron.\n\nA destructive Find() seems like something which will accidentally bite us if we reuse it somewhere else.",
      "parentUuid": "0bbf77c3_f9eb2f7f",
      "revId": "ba5632797718cf1fb2bb69bd68f316e6a5064843",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}