{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "367e1826_f6542f7d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1165921
      },
      "writtenOn": "2023-05-08T16:57:54Z",
      "side": 1,
      "message": "ping for review please\n\nDesign proposal at go/u-boot-cli",
      "revId": "e786c34e408b927e4499889834526beb64b8b1de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1ce0fd76_f1119d62",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2023-05-08T23:54:17Z",
      "side": 1,
      "message": "Sorry but I don\u0027t think this approach makes any sense compared to the other proposals for the CLI discussion. We can\u0027t just start supporting a totally separate bootloader just for a CLI payload, and do twice the driver bring-up work for every new platform.\n\nBesides, if we wanted to implement the CLI in a separate binary (and the other proposals don\u0027t go in that direction), we\u0027d probably want to load it from depthcharge with the existing chain-loading mechanisms and triggered by UI, not from coreboot with a GBB flag.",
      "parentUuid": "367e1826_f6542f7d",
      "revId": "e786c34e408b927e4499889834526beb64b8b1de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6df846d8_cf687321",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1165921
      },
      "writtenOn": "2023-05-09T19:56:29Z",
      "side": 1,
      "message": "That\u0027s fine, but it is very useful for me, at least. I am testing booting OSes which DC doesn\u0027t support.\n\nI believe there was one other CLI proposal using Depthcharge, but it\u0027s a pretty limited experience to say the least. In any case from what I can tell, you are not keen on that either?\n\nNot to state the obvious, but running it from Depthcharge means that DC needs to be working enough to do that, which precludes any early work where just coreboot might be enough. It also adds a manual step and a time delay which are undesirable, to say the least.\n\nSo I suggest we should go ahead with this and see how it goes.",
      "parentUuid": "1ce0fd76_f1119d62",
      "revId": "e786c34e408b927e4499889834526beb64b8b1de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "78188d46_a85b3c12",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2023-05-12T00:06:03Z",
      "side": 1,
      "message": "Sorry but I don\u0027t think we should allocate GBB flags and put custom hacks into coreboot\u0027s payload selection code just for personal testing. If you want to boot U-Boot in your workflow, it\u0027s easy to write scripts that replace the payload in an image.\n\nI don\u0027t think having a U-Boot CLI to debug why depthcharge isn\u0027t working is a very realistic proposition. On any new platform we\u0027re going to put effort into bringing up our main bootloader first, and would expect to get that to work before we get any other debug-CLI-only payload to work.",
      "parentUuid": "6df846d8_cf687321",
      "revId": "e786c34e408b927e4499889834526beb64b8b1de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0b4a9f06_2351f86a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1165921
      },
      "writtenOn": "2023-05-30T19:22:10Z",
      "side": 1,
      "message": "Once of the goals of this CL is to move away from hacks and get something which can be more widely used.\n\nThe goal is not to debug depthcharge...you\u0027ve already said that gdb is the only thing people should use there. But this feature is useful for debugging coreboot and FSP, check tables, etc.",
      "parentUuid": "78188d46_a85b3c12",
      "revId": "e786c34e408b927e4499889834526beb64b8b1de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b5b1a01a_a684feae",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2023-06-02T05:42:41Z",
      "side": 1,
      "message": "I still don\u0027t understand how running a completely separate bootloader solution after coreboot is supposed to be a better debugging environment for coreboot and FSP than anything we could implement in depthcharge (whether it\u0027s based on an inline CLI or GDB hooks there). Spending all the effort to bring up and maintain a completely different bootloader on every board just to provide a debug interface makes no sense.",
      "parentUuid": "0b4a9f06_2351f86a",
      "revId": "e786c34e408b927e4499889834526beb64b8b1de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "74391185_dc66ec8c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1165921
      },
      "writtenOn": "2023-06-02T14:25:30Z",
      "side": 1,
      "message": "U-Boot runs as a coreboot payload on x86. We don\u0027t need to spend much effort on this; it just works.\n\nIn any case, could you please review the code? This is blocking my EFI efforts as well.",
      "parentUuid": "b5b1a01a_a684feae",
      "revId": "e786c34e408b927e4499889834526beb64b8b1de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "986dcef6_5a0bcdb7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2023-06-06T00:01:36Z",
      "side": 1,
      "message": "No, I\u0027m sorry, I disagree fundamentally that this flag is needed. This is not in sync with the plans for the CLI feature, neither mine nor Subrata\u0027s. We do not want this to be controlled by a GBB flag (and I particularly disagree with the hack to coreboot\u0027s payload loading that this would lead to, which constitutes a bunch of layering violations to how coreboot is supposed to work).\n\nI don\u0027t know what you\u0027re doing with EFI or how this has anything to do with it; if you have a design doc that explains that relation I can take a look and we can discuss it. But right now, my understanding is that we don\u0027t want anything like this to be controlled by a GBB flag and that\u0027s why we shouldn\u0027t merge this patch.",
      "parentUuid": "74391185_dc66ec8c",
      "revId": "e786c34e408b927e4499889834526beb64b8b1de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3c910972_bd0bbf71",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1165921
      },
      "writtenOn": "2023-07-25T20:01:39Z",
      "side": 1,
      "message": "I\u0027m sorry but I don\u0027t think you should be the gatekeeper here. You may not like or want changes in vboot, but that doesn\u0027t mean you can block other people\u0027s work.\n\nThis is a one-line change that is needed to jump directly into U-Boot from coreboot, as is done upstream.\n\nPlease drop the -2 and allow this work to continue.",
      "parentUuid": "986dcef6_5a0bcdb7",
      "revId": "e786c34e408b927e4499889834526beb64b8b1de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c4b38ba3_4b93509d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2023-07-25T21:01:10Z",
      "side": 1,
      "message": "This is not \"needed\" to use U-Boot from coreboot. U-Boot can be installed as a normal coreboot payload just like depthcharge and all the others. If anyone wants to package upstream coreboot with U-Boot they are totally free to do so. (If you want to support multiple payloads from a single image, I think the Bayou project has fallen a bit into disrepair in the last decade, but if anyone has interest in that sort of thing again I think that (having one payload choose and chain-load the next) is still the approach upstream would prefer to implement that sort of thing, and not by hardcoding policy decisions taken from some completely unrelated thing (vboot flags) directly into coreboot itself.)\n\nThis is something you\u0027re trying to introduce specifically into ChromeOS, and as such, I think it is reasonable to ask that we have consensus within the team about actually wanting to go that route before we accept code and hacks going in the wrong direction into the repo. Every time I talk to Dossym about this we agree that using U-Boot for this does not make sense and is not the plan of record for our roadmap. So I\u0027m going to continue to block this, because I strongly disagree with this general direction, until either someone higher up the chain tells me otherwise or I see this approach having a lot more support from others in our team.",
      "parentUuid": "3c910972_bd0bbf71",
      "revId": "e786c34e408b927e4499889834526beb64b8b1de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6c1c5adf_fb044f92",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1165921
      },
      "writtenOn": "2023-07-25T21:26:21Z",
      "side": 1,
      "message": "Coreboot is an open-source project with other contributors outside ChromeoS, as I understand it. It supports booting U-Boot as a payload already. This is making that same feature available as a switchable option.\n\nJulius this is just a one-line flag addition to vboot. It doesn\u0027t make any sense at all to block the addition of this flag??",
      "parentUuid": "c4b38ba3_4b93509d",
      "revId": "e786c34e408b927e4499889834526beb64b8b1de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0571e5fc_e1e8c955",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2023-07-25T21:52:31Z",
      "side": 1,
      "message": "Yes, exactly, and coreboot already supports booting a U-Boot payload. I am not in any way against coreboot booting U-Boot (from an upstream, non-CrOS-specific perspective). coreboot should be a general purpose firmware that can boot any payload willing to fit itself to the coreboot payload API.\n\nWhat I object against is adding code to coreboot that selects a different payload based on a GBB flag. I believe that this violates the general coreboot philosophy of keeping payload policy out of coreboot itself. Besides, GBB flags are supposed to be vboot-specific configuration flags and don\u0027t really have anything to do with coreboot\u0027s payload loading. They are the wrong mechanism to do this.\n\nLike I mentioned, there is existing history of payload selection mechanisms for coreboot in the form of the \"Bayou\" payload (https://www.coreboot.org/Bayou) which is in itself a payload that displays a little menu to select another payload to chain-load into. I think that is the right approach supported by coreboot\u0027s philosophy if anyone wants to implement more advanced payload selection. If you ask around among long time upstream developers, I would expect that many of them would probably tell you the same thing: boot policy belongs in the payload.\n\nThe Bayou code itself no longer works, I believe, because nobody has needed anything like that in many years. But the basic approach is still viable and could be reimplemented if you really want something like that (again, for ChromeOS specifically I also disagree with your general U-Boot-as-CLI approach, so I don\u0027t think this is something we would ever use here, but I of course don\u0027t want to stop you from making generally useful non-ChromeOS contributions to coreboot if you want to). If you don\u0027t want a menu, you could of course also have the payload search for a boot policy config file in CBFS and take the decision from there. (That\u0027s another coreboot philosophy thing: the right place for coreboot or payload specific post-build-time configuration information is CBFS, not GBB flags. GBB flags are a vboot-specific quirk that don\u0027t really have anything to do with coreboot boot policy.)\n\nThis is only one flag but it is directly related to the corresponding coreboot patch which I am mainly objecting to.",
      "parentUuid": "6c1c5adf_fb044f92",
      "revId": "e786c34e408b927e4499889834526beb64b8b1de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ca7441f9_dca4880e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1165921
      },
      "writtenOn": "2023-07-25T22:14:42Z",
      "side": 1,
      "message": "It should be obvious that a menu is not suitable here...are you expecting it to wait for serial input? Depthcharge doesn\u0027t do that. Does coreboot even support waiting for a prompt to choose a payload? The point here is to jump to the payload immediately.\n\nGBB flags affect the vboot flow in various ways as you know - developer mode, altfw, even the deprecated VB2_GBB_FLAG_ENABLE_ALTERNATE_OS. I did proposal a \u0027coreboot feature\u0027 block but that has met with the same response.\n\nIn any case, you are missing the key question. Why are you taking it upon yourself to disagree with a feature and then block it?",
      "parentUuid": "0571e5fc_e1e8c955",
      "revId": "e786c34e408b927e4499889834526beb64b8b1de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "afe410bc_4f82b1e6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2023-07-26T02:31:36Z",
      "side": 1,
      "message": "\u003e It should be obvious that a menu is not suitable here...are you expecting it to wait for serial input? Depthcharge doesn\u0027t do that. Does coreboot even support waiting for a prompt to choose a payload? The point here is to jump to the payload immediately.\n\nNo, I am saying you that existing coreboot philosophy is to implement advanced payload loading decisions into a separate chain-loading payload, not hack them directly into payload_load().\n\n\u003e I did proposal a \u0027coreboot feature\u0027 block but that has met with the same response.\n\nAnd during that discussion I said the other thing I also said above, that existing coreboot philosophy is to put configuration decisions into CBFS files. Which applies here as well, except that I think that file should still be parsed and acted upon by a separate payload, I don\u0027t think it fits coreboot philosophy to add something like this into coreboot itself. (There is of course the existing option of just using cbfstool to extract and remove a file like fallback/u-boot and then re-add it as fallback/payload to change which file coreboot decides to load. That requires essentially the same kind of access as modifying GBB flags. I also wouldn\u0027t be opposed to adding a `cbfstool rename` command if you wanted to make that simpler.)\n\n\u003e In any case, you are missing the key question. Why are you taking it upon yourself to disagree with a feature and then block it?\n\nI mean, I think I could also ask why you are taking it upon yourself to implement something that everyone else I ask seems to agree is not the right approach and not something we want to do in our firmware? Isn\u0027t design review and consensus one of the core pillars of software development at Google? We can\u0027t just all implement our own competing ideas of how we want things to look like into the same code base. In general I don\u0027t really mind people adding optional little features that do no harm to other use cases (although added maintenance burden is always a concern for any code), but this particular thing with the GBB flag violates coreboot design principles so I feel it is important to push back.",
      "parentUuid": "ca7441f9_dca4880e",
      "revId": "e786c34e408b927e4499889834526beb64b8b1de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}