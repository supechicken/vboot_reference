{
  "comments": [
    {
      "key": {
        "uuid": "66b4f276_4cf5c938",
        "filename": "firmware/lib/vboot_api_kernel.c",
        "patchSetId": 10
      },
      "lineNbr": 455,
      "author": {
        "id": 1308749
      },
      "writtenOn": "2019-02-28T03:22:04Z",
      "side": 1,
      "message": "Not needed.",
      "range": {
        "startLine": 455,
        "startChar": 0,
        "endLine": 455,
        "endChar": 34
      },
      "revId": "09de497df4b36f8e6750a25d9725d499bfde30e9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2988463a_46d6d924",
        "filename": "firmware/lib/vboot_api_kernel.c",
        "patchSetId": 10
      },
      "lineNbr": 455,
      "author": {
        "id": 1284883
      },
      "writtenOn": "2019-02-28T19:24:30Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "66b4f276_4cf5c938",
      "range": {
        "startLine": 455,
        "startChar": 0,
        "endLine": 455,
        "endChar": 34
      },
      "revId": "09de497df4b36f8e6750a25d9725d499bfde30e9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "41043552_1c184459",
        "filename": "firmware/lib/vboot_ui.c",
        "patchSetId": 10
      },
      "lineNbr": 389,
      "author": {
        "id": 1308749
      },
      "writtenOn": "2019-02-28T03:22:04Z",
      "side": 1,
      "message": "Why was the VbExEcEnablePowerButton() removed?  This is still required on Wilco, correct?  This code was removed between patchset 8 and 9.\n\nAlso, if you put the call back in, along with the delay workaround before re-enabling the power button, you can file a bug for the Cr50 power button support and assign it to me.",
      "revId": "09de497df4b36f8e6750a25d9725d499bfde30e9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "eca70962_866e4aa0",
        "filename": "firmware/lib/vboot_ui.c",
        "patchSetId": 10
      },
      "lineNbr": 389,
      "author": {
        "id": 1284883
      },
      "writtenOn": "2019-02-28T19:24:30Z",
      "side": 1,
      "message": "In the present form of the code, enabling the diagnostic UI will implicitly disable the power button while depthcharge is running:\n\nhttps://chromium-review.googlesource.com/c/chromiumos/platform/depthcharge/+/1471056/9/src/vboot/Kconfig\n\nJulius has been advocating for me to go a step further and always disable the power button for all x86 systems.  I\u0027m still trying to gauge how much software and/or hardware is likely to break (any such breakage is good to know and fix, but ends up being a big tangent to the original task).\n\nI did have some code for implementing a delay workaround (I don\u0027t recall offhand if it ever got published to gerrit), but it went away now that the power button is disabled for a longer period of time.  The load and verify of the diagnostic payload seems to provide a sufficient delay for someone to release the power button before it\u0027s re-enabled).",
      "parentUuid": "41043552_1c184459",
      "revId": "09de497df4b36f8e6750a25d9725d499bfde30e9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "084fa136_25c2dee6",
        "filename": "firmware/lib/vboot_ui.c",
        "patchSetId": 10
      },
      "lineNbr": 389,
      "author": {
        "id": 1284883
      },
      "writtenOn": "2019-02-28T23:29:15Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "eca70962_866e4aa0",
      "revId": "09de497df4b36f8e6750a25d9725d499bfde30e9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "df8c0f86_ca69e36a",
        "filename": "firmware/lib/vboot_ui.c",
        "patchSetId": 10
      },
      "lineNbr": 435,
      "author": {
        "id": 1308749
      },
      "writtenOn": "2019-02-28T03:22:04Z",
      "side": 1,
      "message": "The EC codebase has defines like this:  is there something equivalent in the coreboot/vboot codebase?  I find these macros improve readability.\n\n#define MSEC         1000\n#define SECOND    1000000\n#define MINUTE   60000000\n#define HOUR   3600000000ull  /* Too big to fit in a signed int */\n\nI would also like to see parenthesis around the left side of the test:\nif ((VbExGetTimer() - start_time_us) \u003e\u003d 30 * 1000 * 1000) {",
      "range": {
        "startLine": 435,
        "startChar": 45,
        "endLine": 435,
        "endChar": 56
      },
      "revId": "09de497df4b36f8e6750a25d9725d499bfde30e9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "516a5587_08b6d6bb",
        "filename": "firmware/lib/vboot_ui.c",
        "patchSetId": 10
      },
      "lineNbr": 435,
      "author": {
        "id": 1284883
      },
      "writtenOn": "2019-02-28T19:24:30Z",
      "side": 1,
      "message": "When I searched I only came across vboot_audio.c using \"#define TICKS_PER_MSEC 1000\" and I didn\u0027t think that was an appropriate example to follow.  I\u0027ve also had my hand slapped previously by CrOS folks who were against defining things that were used in 1 place, so I went with a literal.\n\nFor parenthesis, I can see using them for cases when the evaluation order of \u0026\u0026 vs \u0026 vs \u003d\u003d can be confusing or misleader, and possibly when people don\u0027t remember that \u0026 has higher precedence over |, but this case is just a simple \"a - b\" subtraction so adding parens would just add more clutter than clarity.",
      "parentUuid": "df8c0f86_ca69e36a",
      "range": {
        "startLine": 435,
        "startChar": 45,
        "endLine": 435,
        "endChar": 56
      },
      "revId": "09de497df4b36f8e6750a25d9725d499bfde30e9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4fccbee4_1dcc6586",
        "filename": "firmware/lib/vboot_ui.c",
        "patchSetId": 10
      },
      "lineNbr": 435,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2019-02-28T21:24:26Z",
      "side": 1,
      "message": "We have USECS_PER_SEC in libpayload, but I think we try not to rely on non-standard things like that in vboot since it\u0027s supposed to be a generic library that can be used by other callers.\n\nWe usually don\u0027t go overboard with parenthesis in cases where the evaluation order is well known... I think that arithmetic binds closer than comparison should be obvious enough.",
      "parentUuid": "516a5587_08b6d6bb",
      "range": {
        "startLine": 435,
        "startChar": 45,
        "endLine": 435,
        "endChar": 56
      },
      "revId": "09de497df4b36f8e6750a25d9725d499bfde30e9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cfd4c3d0_e871dc3f",
        "filename": "firmware/lib/vboot_ui.c",
        "patchSetId": 10
      },
      "lineNbr": 435,
      "author": {
        "id": 1276303
      },
      "writtenOn": "2019-03-06T01:03:11Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "4fccbee4_1dcc6586",
      "range": {
        "startLine": 435,
        "startChar": 45,
        "endLine": 435,
        "endChar": 56
      },
      "revId": "09de497df4b36f8e6750a25d9725d499bfde30e9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "da815024_37e35bd1",
        "filename": "tests/vboot_api_kernel2_tests.c",
        "patchSetId": 10
      },
      "lineNbr": 27,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2019-02-28T21:24:26Z",
      "side": 1,
      "message": "Maybe better to pull this (from vboot_audio.c) into some header rather than defining it twice?",
      "revId": "09de497df4b36f8e6750a25d9725d499bfde30e9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0767bcca_ede6a030",
        "filename": "tests/vboot_api_kernel2_tests.c",
        "patchSetId": 10
      },
      "lineNbr": 116,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2019-02-28T21:24:26Z",
      "side": 1,
      "message": "nit: technically should be ENABLED_TENTATIVE, right?",
      "revId": "09de497df4b36f8e6750a25d9725d499bfde30e9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7d9761d0_7f2afd81",
        "filename": "tests/vboot_api_kernel2_tests.c",
        "patchSetId": 10
      },
      "lineNbr": 116,
      "author": {
        "id": 1284883
      },
      "writtenOn": "2019-02-28T23:29:15Z",
      "side": 1,
      "message": "Conceptually it seems so, so I\u0027ll change it (though anything besides _DISABLED is all that matters).",
      "parentUuid": "0767bcca_ede6a030",
      "revId": "09de497df4b36f8e6750a25d9725d499bfde30e9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fc9f8163_4f432c55",
        "filename": "tests/vboot_api_kernel2_tests.c",
        "patchSetId": 10
      },
      "lineNbr": 179,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2019-02-28T21:24:26Z",
      "side": 1,
      "message": "nit: Not really sure why this needs two variables..?",
      "revId": "09de497df4b36f8e6750a25d9725d499bfde30e9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "44ce2d50_2002ba91",
        "filename": "tests/vboot_api_kernel2_tests.c",
        "patchSetId": 10
      },
      "lineNbr": 179,
      "author": {
        "id": 1284883
      },
      "writtenOn": "2019-02-28T23:29:15Z",
      "side": 1,
      "message": "I don\u0027t see a need either--I copied the existing stub in vboot_api_devmode_tests.c.  I can simplify it since there\u0027s never a read of current_time.  I was originally in the mindset to keep the stubs consistent.",
      "parentUuid": "fc9f8163_4f432c55",
      "revId": "09de497df4b36f8e6750a25d9725d499bfde30e9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "300d78c1_96bd798c",
        "filename": "tests/vboot_api_kernel2_tests.c",
        "patchSetId": 10
      },
      "lineNbr": 1184,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2019-02-28T21:24:26Z",
      "side": 1,
      "message": "nit: maybe better to do\n\n TEST_TRUE(current_ticks \u003c 1000 * TICKS_PER_MSEC, ...);\n\nso we don\u0027t hardcode the exact dev screen key delay in the test?",
      "revId": "09de497df4b36f8e6750a25d9725d499bfde30e9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d871c95f_a944b07d",
        "filename": "tests/vboot_api_kernel2_tests.c",
        "patchSetId": 10
      },
      "lineNbr": 1184,
      "author": {
        "id": 1284883
      },
      "writtenOn": "2019-02-28T23:29:15Z",
      "side": 1,
      "message": "I was initially stumped on the lack of TEST_EQ() variations that permitted \u003c or \u003c\u003d , but then figured testing with equality was okay since it\u0027d only break if shutdown_request_calls_left (a few lines above here) is init to a value besides 10 or DEV_KEY_DELAY in vboot_ui.c gets changed from 20 (i.e., the value isn\u0027t subject to delay variability at runtime).  Having said that I can change this as requested so it\u0027s less of a test in tracking code changes.",
      "parentUuid": "300d78c1_96bd798c",
      "revId": "09de497df4b36f8e6750a25d9725d499bfde30e9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b1612d1b_9bda89fe",
        "filename": "tests/vboot_api_kernel4_tests.c",
        "patchSetId": 10
      },
      "lineNbr": 252,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2019-02-28T21:24:26Z",
      "side": 1,
      "message": "I\u0027m somewhat confused... what\u0027s the difference between the tests you add to this file and the ones in the other? Looks to me like this file is just supposed to test a bunch of normal core vboot behavior (rolling firmware versions and the like), whereas all the \"special\" UI stuff is in kernel2. So I think you\u0027ll probably want to add all your stuff to kernel2 and not touch this one?",
      "revId": "09de497df4b36f8e6750a25d9725d499bfde30e9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ee370718_06954308",
        "filename": "tests/vboot_api_kernel4_tests.c",
        "patchSetId": 10
      },
      "lineNbr": 252,
      "author": {
        "id": 1284883
      },
      "writtenOn": "2019-02-28T23:29:15Z",
      "side": 1,
      "message": "It\u0027s an understandable confusion.  The changes in the other file is testing the functionality of vb2_diagnostics_ui() while the changes to this file tries to test whether VbSelectAndLoadKernel() honors the VB2_NV_DIAG_REQUEST flag and calls vb2_diagnostics_ui() (via VbBootDiagnostic()).  The actual behavior of vb2_diagnostics_ui() isn\u0027t important to this test, other than having some predictable side effects that can be used to discern whether the call was made (in this case the VB2_RECOVERY_ALTFW_HASH_FAILED recovery reason).  I could possibly make this test seem less redundant and mode predictable by trying to stub out VbBootDiagnostic().",
      "parentUuid": "b1612d1b_9bda89fe",
      "revId": "09de497df4b36f8e6750a25d9725d499bfde30e9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a01afe26_20caac9b",
        "filename": "tests/vboot_api_kernel4_tests.c",
        "patchSetId": 10
      },
      "lineNbr": 252,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2019-03-01T00:20:46Z",
      "side": 1,
      "message": "Oh, I see. That makes more sense then. Yes, I think stubbing VbBootDiagnostic() would be better to have a cleaner separation of what each test tests (and maybe make the comment a littler clearer, e.g. /* Check that NV_DIAG_REQUEST triggers diagnostic UI */).",
      "parentUuid": "ee370718_06954308",
      "revId": "09de497df4b36f8e6750a25d9725d499bfde30e9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d6a298a1_64870649",
        "filename": "tests/vboot_api_kernel4_tests.c",
        "patchSetId": 10
      },
      "lineNbr": 252,
      "author": {
        "id": 1276303
      },
      "writtenOn": "2019-03-06T01:03:11Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a01afe26_20caac9b",
      "revId": "09de497df4b36f8e6750a25d9725d499bfde30e9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}