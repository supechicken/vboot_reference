{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "97bd9087_9cebcd7c",
        "filename": "firmware/2lib/2ui_screens.c",
        "patchSetId": 1
      },
      "lineNbr": 1157,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2020-11-23T03:06:11Z",
      "side": 1,
      "message": "What happens here?  Are we also missing logic to handle enabling the \"next/prev\" buttons?",
      "range": {
        "startLine": 1157,
        "startChar": 2,
        "endLine": 1157,
        "endChar": 54
      },
      "revId": "85821603f9258dce65aeb52f4a472524037977d9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "152b7bbb_97e92544",
        "filename": "firmware/2lib/2ui_screens.c",
        "patchSetId": 1
      },
      "lineNbr": 1157,
      "author": {
        "id": 1113505
      },
      "writtenOn": "2020-11-24T06:32:37Z",
      "side": 1,
      "message": "Good catch! Thanks, Joel.\n\nIt looks we missed this due to some API is changing during the development this function. We currently don\u0027t have \"shorten\" case in minidiag, but it is good to fix this in other CL.\n\nI am thinking whether it is a good idea to split out \"the logic of enabling/disabling page_up/down buttons\" from log_page_init() and other page_prev/page_next action functions to a single helper function, then we could re-use all the logic?\ni.e. create log_page_update_page_button(struct vb2_ui_context *ui) (or log_page_update) to handle all cases (single page, at the first page, at the last page...etc.), then we don\u0027t need to handle them separately in the screen action callback. Joel and Rocco, what do you think?",
      "parentUuid": "97bd9087_9cebcd7c",
      "range": {
        "startLine": 1157,
        "startChar": 2,
        "endLine": 1157,
        "endChar": 54
      },
      "revId": "85821603f9258dce65aeb52f4a472524037977d9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a2d41749_922a06c7",
        "filename": "firmware/2lib/2ui_screens.c",
        "patchSetId": 1
      },
      "lineNbr": 1157,
      "author": {
        "id": 1113505
      },
      "writtenOn": "2020-11-24T07:08:12Z",
      "side": 1,
      "message": "After rethink again, I think it is also good to fix this in this CL.\n\nSummarize my idea mentioned above:\n* create log_page_update to maintain prev_page/next_page buttons.\n* We only need to maintain the page count in action callback. Then, we can call log_page_update() at the end of log_page_init()/log_page_prev_action()/log_page_next_action()/diagnostics_memory_update_screen()\n\nlog_page_update:\n  log_page_update(struct vb2_ui_context *ui)\n  {\n\tif (ui-\u003estate-\u003epage_count \u003d\u003d 1) {\n             ...\n\t} else if (ui-\u003estate-\u003ecurrent_page \u003d\u003d 0) {\n             ...\n\t} else if (ui-\u003estate-\u003ecurrent_page \u003d\u003d ui-\u003estate-\u003epage_count - 1) {\n             ...\n\t} else {\n             ...\n\t}\n        return ...\n  }",
      "parentUuid": "152b7bbb_97e92544",
      "range": {
        "startLine": 1157,
        "startChar": 2,
        "endLine": 1157,
        "endChar": 54
      },
      "revId": "85821603f9258dce65aeb52f4a472524037977d9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "12949424_5a0457d3",
        "filename": "firmware/2lib/2ui_screens.c",
        "patchSetId": 1
      },
      "lineNbr": 1157,
      "author": {
        "id": 1383774
      },
      "writtenOn": "2020-11-24T10:57:28Z",
      "side": 1,
      "message": "I agree that we should introduce log_page_update() since we have to validate and update them frequently.\n\nI suggest that:\n\n1. Add log_page_update(ui):\n- validate page_count \u003e\u003d 1\n- adjust current_page to fit in [0, page_count)\n- clear and set bits for disabled_item_mask\n\n2. Add log_page_prepare(ui, log_string, error_code, error_str):\n- call vb2ex_prepare_log_screen(ui-\u003estate-\u003escreen-\u003eid, ui-\u003elocale_id, log_string)\n- VB2_DEBUG(error_star) and set error_code if fail\n- update ui-\u003estate-\u003epage_count\n- call log_page_update(ui)\n\n3. leverage log_page_update() on log_page_init()/log_page_prev()/log_page_next().\n\nThen we can ensure that we call log_page_update() everytime we prepare a new log content.\n\n\n\nAnother suggestion here is we could publicize these all 5 functions to 2ui_private.h and design unit tests for them.\n\nWDYT?",
      "parentUuid": "a2d41749_922a06c7",
      "range": {
        "startLine": 1157,
        "startChar": 2,
        "endLine": 1157,
        "endChar": 54
      },
      "revId": "85821603f9258dce65aeb52f4a472524037977d9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1c25665b_fbffb3c9",
        "filename": "firmware/2lib/2ui_screens.c",
        "patchSetId": 1
      },
      "lineNbr": 1234,
      "author": {
        "id": 1113505
      },
      "writtenOn": "2020-11-24T06:32:37Z",
      "side": 1,
      "message": "Just wondering to know why do we need this? Is it a new design for pageup/pagedown API in recent groot?",
      "revId": "85821603f9258dce65aeb52f4a472524037977d9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ead530c3_ec2c8962",
        "filename": "firmware/2lib/2ui_screens.c",
        "patchSetId": 1
      },
      "lineNbr": 1234,
      "author": {
        "id": 1383774
      },
      "writtenOn": "2020-11-24T07:01:50Z",
      "side": 1,
      "message": "We introduce these members at http://crrev/c/2426154,\nwhich is the CL introducing disabled button style.\n\nFor details, you could read: http://crrev/c/2426154/18/firmware/2lib/2ui_screens.c#55",
      "parentUuid": "1c25665b_fbffb3c9",
      "revId": "85821603f9258dce65aeb52f4a472524037977d9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3ef0fd24_e0c9919d",
        "filename": "firmware/2lib/2ui_screens.c",
        "patchSetId": 1
      },
      "lineNbr": 1234,
      "author": {
        "id": 1113505
      },
      "writtenOn": "2020-11-24T07:08:12Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "ead530c3_ec2c8962",
      "revId": "85821603f9258dce65aeb52f4a472524037977d9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}