{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "a2a633c7_3f5bc737",
        "filename": "firmware/lib/vboot_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 28,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2021-03-04T00:55:50Z",
      "side": 0,
      "message": "I honestly don\u0027t think removing this is an improvement. I think this enum did a good job clarifying that \"developer boot\" is not the same as \"developer switch set\" and the two need to be carefully distinguished. You now replaced this with individual checks like (dev_mode \u0026\u0026 !rec_mode) but that feels less clear and more prone to mistakes to me (like I\u0027d say you already made one in require_official_os() even though that wasn\u0027t the last line of defense for that case). I think being able to check \"this is a developer *boot*\" in one go without having to open code the details of how rec_mode and dev_mode interact with each other every time is useful.",
      "revId": "a893a93c04c37dae592c4fbfcb79d57f310890a3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1514e71e_39ef15b2",
        "filename": "firmware/lib/vboot_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 28,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2021-03-04T06:29:21Z",
      "side": 0,
      "message": "Yeah... fair enough.  I was also questioning the changes as I was working through this CL.  Actually, REC_MODE and DEV_MODE are already kind of confusing.  DEV_MODE is more like a switch or a flag, whereas the \"boot mode\" itself can be one of {broken, recovery, diag, dev, normal}.  I wonder if it would be useful to get rid of REC_MODE, and introduce an API function which returns one of these five boot types.\n\n(I remember we had talked about removing REC_MODE/DEV_MODE before, since they\u0027re duplicated internally by sd-\u003erecovery_reason and sd-\u003eflags \u0026 VB2_SD_FLAG_DEV_MODE_ENABLED.)\n\nBut maybe that would just be creating a bunch of extra churn for no good reason.\n\n\nAlternatively, this get_kernel_boot_mode function could be pulled up as a utility function, or moved to API level.  Or, functions could be introduced to check each mode, such as vb2_is_rec_boot() and vb2_is_dev_boot().\n\nWhat are your thoughts?",
      "parentUuid": "a2a633c7_3f5bc737",
      "revId": "a893a93c04c37dae592c4fbfcb79d57f310890a3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}