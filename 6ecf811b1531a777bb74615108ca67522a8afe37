{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "f726f75f_8f122ea4",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 1302633
      },
      "writtenOn": "2020-12-28T19:17:16Z",
      "side": 1,
      "message": "I see that the CQ failure is in one of the futility tests. More specifically the test fails when it emulates a full update. Based on the failure, either the input image is invalid or the check for ME lock does not apply to older platforms.\n\nBased on the logs, the test is emulating a FW update from src/platform/vboot_reference/test/futility/data/bios_peppy_mp.bin to src/platform/vboot_reference/test/futility/data/bios_link_mp.bin\n\nIn both the FROM_IMAGE and TO_IMAGE ME is locked. Here is the hex dump of first few bytes as read from SI_DESC:\n\n00000000  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|\n00000010  5a a5 f0 0f 03 00 04 02  06 02 10 12 20 01 21 00  |Z........... .!.|\n00000020  25 00 00 00 ff ff ff ff  ff ff ff ff ff ff ff ff  |%...............|\n00000030  24 00 30 49 00 00 00 00  00 00 00 00 ff ff ff ff  |$.0I............|\n00000040  00 00 00 00 00 02 ff 07  01 00 ff 01 ff 1f 00 00  |................|\n00000050  ff 1f 00 00 ff ff ff ff  ff ff ff ff ff ff ff ff  |................|\n00000060  00 00 0b 0a 00 00 0d 0c  18 01 08 08 ff ff ff ff  |................|\n00000070  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|\n\n1) Offset 0x10 has FLVALSIG\n2) The LSB of flmap1 is 0x06 and hence flmstr1 is at 0x60\n3) BIT 22 at offset 0x60 is set to 0 and hence ME is treated as locked.\n\nThis caused the SI_DESC to be preserved and full update to fail. I am not sure what is the right fix to the test.",
      "revId": "6ecf811b1531a777bb74615108ca67522a8afe37",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "831a001c_3a642b4a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 1003000
      },
      "writtenOn": "2020-12-28T20:30:00Z",
      "side": 1,
      "message": "Posted a comment on updater_utils.c. Probably we can assume that the ME is not locked in emulation mode.\n\nI think the right solution might be to ensure that the bios images have the ME regions formatted correctly to reflect that ME region access is enabled for BIOS since the test is attempting to actually update the entire flash. But, I am not sure about the history of the test images. Hung-Te might be able to provide the background.",
      "parentUuid": "f726f75f_8f122ea4",
      "revId": "6ecf811b1531a777bb74615108ca67522a8afe37",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8fcf15c9_7bac4507",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 1000239
      },
      "writtenOn": "2021-01-26T14:19:58Z",
      "side": 1,
      "message": "well... when writing the tests, we were trying to test more coverage with less samples. Don\u0027t be surprised if the input or output blobs are not 100% executable, and feel free to change the test cases if you believe something should be more correct.",
      "parentUuid": "831a001c_3a642b4a",
      "revId": "6ecf811b1531a777bb74615108ca67522a8afe37",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c9baaaf4_8e253bfa",
        "filename": "futility/updater_utils.c",
        "patchSetId": 8
      },
      "lineNbr": 892,
      "author": {
        "id": 1003000
      },
      "writtenOn": "2020-12-28T20:26:17Z",
      "side": 1,
      "message": "Should we add a check here:\n\nif (cfg-\u003eemulation)\n    return 0;\n\nto indicate that ME is not locked when running futility in emulation mode. Hung-Te might also have some thoughts on this.",
      "revId": "6ecf811b1531a777bb74615108ca67522a8afe37",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a60d9600_6cfa194f",
        "filename": "futility/updater_utils.c",
        "patchSetId": 8
      },
      "lineNbr": 892,
      "author": {
        "id": 1302633
      },
      "writtenOn": "2020-12-28T23:56:53Z",
      "side": 1,
      "message": "It helps in the situation where firmware update is emulated. But there is one other scenario where the test fails when the dummy programmers are used:\nhttps://chromium.googlesource.com/chromiumos/platform/vboot_reference/+/refs/heads/master/tests/futility/test_update.sh#471\n\nIn this case, the emulation mode is not set.\n\nThe better solution is to check the history behind the choice of the test images and handle those scenarios.",
      "parentUuid": "c9baaaf4_8e253bfa",
      "revId": "6ecf811b1531a777bb74615108ca67522a8afe37",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4318ba23_8c03c8e6",
        "filename": "futility/updater_utils.c",
        "patchSetId": 8
      },
      "lineNbr": 892,
      "author": {
        "id": 1003000
      },
      "writtenOn": "2020-12-28T23:58:45Z",
      "side": 1,
      "message": "Agreed. Yes, I think it would be good to understand the background on it and see what the tests really aim to test. That way we can decide if the test needs to be updated, futility or the binaries.",
      "parentUuid": "a60d9600_6cfa194f",
      "revId": "6ecf811b1531a777bb74615108ca67522a8afe37",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ],
  "submitRequirementResults": [
    {
      "submitRequirement": {
        "name": "Code-Owners",
        "description": {
          "value": "User with the code owner override approved the change"
        },
        "applicabilityExpression": {
          "value": {
            "expressionString": "has:enabled_code-owners"
          }
        },
        "submittabilityExpression": {
          "expressionString": "has:approval_code-owners"
        },
        "overrideExpression": {
          "value": {
            "expressionString": "label:Owners-Override\u003d+1"
          }
        },
        "allowOverrideInChildProjects": true
      },
      "applicabilityExpressionResult": {
        "value": {"expression":{"expressionString":"has:enabled_code-owners"},"status":"PASS","errorMessage":{"value":null},"passingAtoms":["has:enabled_code-owners"],"failingAtoms":[]}
      },
      "submittabilityExpressionResult": {
        "value": {"expression":{"expressionString":"has:approval_code-owners"},"status":"PASS","errorMessage":{"value":null},"passingAtoms":["has:approval_code-owners"],"failingAtoms":[]}
      },
      "overrideExpressionResult": {
        "value": {"expression":{"expressionString":"label:Owners-Override=+1"},"status":"FAIL","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":["label:Owners-Override=+1"]}
      },
      "patchSetCommitId": "6ecf811b1531a777bb74615108ca67522a8afe37",
      "legacy": {
        "value": false
      },
      "forced": {},
      "hidden": {}
    },
    {
      "submitRequirement": {
        "name": "Code-Review",
        "description": {
          "value": "Submit requirement for the \u0027Code-Review\u0027 label"
        },
        "applicabilityExpression": {},
        "submittabilityExpression": {
          "expressionString": "label:Code-Review\u003dMAX,user\u003dnon_uploader -label:Code-Review\u003dMIN"
        },
        "overrideExpression": {
          "value": {
            "expressionString": "label:Bot-Commit\u003d+1 AND -label:Code-Review\u003dMIN"
          }
        },
        "allowOverrideInChildProjects": true
      },
      "applicabilityExpressionResult": {},
      "submittabilityExpressionResult": {
        "value": {"expression":{"expressionString":"label:Code-Review=MAX,user=non_uploader -label:Code-Review=MIN"},"status":"FAIL","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":["label:Code-Review=MAX,user=non_uploader","label:Code-Review=MIN"]}
      },
      "overrideExpressionResult": {
        "value": {"expression":{"expressionString":"label:Bot-Commit=+1 AND -label:Code-Review=MIN"},"status":"FAIL","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":["label:Bot-Commit=+1","label:Code-Review=MIN"]}
      },
      "patchSetCommitId": "6ecf811b1531a777bb74615108ca67522a8afe37",
      "legacy": {
        "value": false
      },
      "forced": {},
      "hidden": {}
    },
    {
      "submitRequirement": {
        "name": "Review-Enforcement",
        "description": {
          "value": "Two Google employees must approve the change. Uploading the change or voting positively on Code-Review count as approval."
        },
        "applicabilityExpression": {
          "value": {
            "expressionString": "is:review-enforced_gerrit"
          }
        },
        "submittabilityExpression": {
          "expressionString": "is:review-enforcement-satisfied_gerrit"
        },
        "overrideExpression": {},
        "allowOverrideInChildProjects": false
      },
      "applicabilityExpressionResult": {
        "value": {"expression":{"expressionString":"is:review-enforced_gerrit"},"status":"FAIL","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":["is:review-enforced_gerrit"]}
      },
      "submittabilityExpressionResult": {
        "value": {"expression":{"expressionString":"is:review-enforcement-satisfied_gerrit"},"status":"NOT_EVALUATED","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":[]}
      },
      "overrideExpressionResult": {},
      "patchSetCommitId": "6ecf811b1531a777bb74615108ca67522a8afe37",
      "legacy": {
        "value": false
      },
      "forced": {},
      "hidden": {}
    },
    {
      "submitRequirement": {
        "name": "Verified",
        "description": {
          "value": "CI or human verified the change"
        },
        "applicabilityExpression": {
          "value": {
            "expressionString": "-branch:refs/meta/config"
          }
        },
        "submittabilityExpression": {
          "expressionString": "label:Verified\u003dMAX AND -label:Verified\u003dMIN"
        },
        "overrideExpression": {
          "value": {
            "expressionString": "label:Bot-Commit\u003d+1"
          }
        },
        "allowOverrideInChildProjects": true
      },
      "applicabilityExpressionResult": {
        "value": {"expression":{"expressionString":"-branch:refs/meta/config"},"status":"PASS","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":["branch:refs/meta/config"]}
      },
      "submittabilityExpressionResult": {
        "value": {"expression":{"expressionString":"label:Verified=MAX AND -label:Verified=MIN"},"status":"FAIL","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":["label:Verified=MAX","label:Verified=MIN"]}
      },
      "overrideExpressionResult": {
        "value": {"expression":{"expressionString":"label:Bot-Commit=+1"},"status":"FAIL","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":["label:Bot-Commit=+1"]}
      },
      "patchSetCommitId": "6ecf811b1531a777bb74615108ca67522a8afe37",
      "legacy": {
        "value": false
      },
      "forced": {},
      "hidden": {}
    }
  ]
}