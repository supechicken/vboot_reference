{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "fda3f574_6fceaf3f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2023-06-07T21:21:02Z",
      "side": 1,
      "message": "I think in general, futility/ is only supposed to contain that stuff that\u0027s exclusive to the command line utility, and anything shared should go in host/lib/. So if you want to make functionality from futility available in vboot_host.a, you should move it over there and rename it to remove the futility references (and call it something like vb2_... instead).",
      "revId": "740b2cf4e84e5f78fb932f29229bd5325a10d794",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "335a7331_18ef6cbb",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1351160
      },
      "writtenOn": "2023-06-07T22:17:03Z",
      "side": 1,
      "message": "As mentioned to Saketh, it\u0027s easier to use `fuility` in a subprocess.",
      "parentUuid": "fda3f574_6fceaf3f",
      "revId": "740b2cf4e84e5f78fb932f29229bd5325a10d794",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b21aa330_7c59590e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1570422
      },
      "writtenOn": "2023-06-08T15:21:32Z",
      "side": 1,
      "message": "All of this sounds good. I\u0027ll take a quick stab at a move, if it proves too big of a move (multiple days of work I\u0027ll switch over to the subprocess). I\u0027d like to be able to skip parsing CLI output so that any changes breaks in tests rather than on devices",
      "parentUuid": "335a7331_18ef6cbb",
      "revId": "740b2cf4e84e5f78fb932f29229bd5325a10d794",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a64f0541_fffc18b2",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1570422
      },
      "writtenOn": "2023-06-08T22:29:11Z",
      "side": 1,
      "message": "Overall I found the separation work to be fairly straight forward. Renamed structs and functions to not reference futil, and made changes where these functions were called before.\nWith that said, let me know if you find this change to be too risky from a breakage and other code leak standpoint, and I can still pursue the cmd line path. \nFrom a code maintainability standpoint I\u0027d prefer to use the c api so that I won\u0027t have to worry about formatting or hex/dec changes that may happen in the future.",
      "parentUuid": "b21aa330_7c59590e",
      "revId": "740b2cf4e84e5f78fb932f29229bd5325a10d794",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "627614d2_b29ffdb5",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2023-06-12T22:02:04Z",
      "side": 1,
      "message": "I\u0027m honestly not so sure about this overall direction anymore. There\u0027s a lot of info exposed by futility and it\u0027s going to get complicated to expose it all in a clean programmatic manner. I mean what you\u0027re doing here is basically just exposing the structure definitions and then having the caller do it themselves, but I don\u0027t think that\u0027s a good model (e.g. we don\u0027t really want the caller to have to worry about details like how to find the preamble from the keyblock).\n\nI think since we don\u0027t need this stuff _that_ often, and it\u0027s not super performance-critical, it\u0027s not really worthwhile to invest in a full library API and it would be much easier to just have the caller shell out to futility instead. I agree that the current futility output was designed for human reading and isn\u0027t very suitable for automated parsing, but I think we should just fix that by adding a new flag (e.g. `-k`/`--machine_parseable` like in cbfstool) that changes the output format to something that\u0027s guaranteed to be stable, unambiguous and extensible (e.g. one data item per line that\u0027s doesn\u0027t depend on positional context within the whole output to be understood, with colon separated tokens like `bios:gbb:root_key:sha1:\u003chash in hex\u003e`, `bios:rw_a:firmware_data_key:sha1:\u003chash in hex\u003e`, `bios:rw_b:body_signature:valid`, `bios:rw_b:firmware_key_version:1`, etc.).",
      "parentUuid": "a64f0541_fffc18b2",
      "revId": "740b2cf4e84e5f78fb932f29229bd5325a10d794",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}