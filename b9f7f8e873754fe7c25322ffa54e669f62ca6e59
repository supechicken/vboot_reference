{
  "comments": [
    {
      "key": {
        "uuid": "9a040537_2cf74c06",
        "filename": "/COMMIT_MSG",
        "patchSetId": 9
      },
      "lineNbr": 10,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2020-08-27T10:18:38Z",
      "side": 1,
      "message": "screen\n\n(not only log screen)",
      "range": {
        "startLine": 10,
        "startChar": 0,
        "endLine": 10,
        "endChar": 10
      },
      "revId": "b9f7f8e873754fe7c25322ffa54e669f62ca6e59",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "56cf46f4_0575683d",
        "filename": "/COMMIT_MSG",
        "patchSetId": 9
      },
      "lineNbr": 10,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2020-08-28T09:04:01Z",
      "side": 1,
      "message": "ping?",
      "parentUuid": "9a040537_2cf74c06",
      "range": {
        "startLine": 10,
        "startChar": 0,
        "endLine": 10,
        "endChar": 10
      },
      "revId": "b9f7f8e873754fe7c25322ffa54e669f62ca6e59",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a3ab208e_2c1f8aa2",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2020-08-27T10:18:38Z",
      "side": 1,
      "message": "Let Joel take a final look",
      "revId": "b9f7f8e873754fe7c25322ffa54e669f62ca6e59",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d0fa173e_b3aca797",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2020-08-27T10:49:19Z",
      "side": 1,
      "message": "Hmm, I\u0027m not so convinced that introducing a reinit() API to handle this case is the best approach.  The only reason we need to do this in the first place is because of the limitations caused by the divide between depthcharge and vboot_api.  If our only use of reinit() is to work around this limitation, then I\u0027d prefer using some simpler workaround for the time being.  Not to mention that we may find our requirements change if diagnostics team requires log screens whose length (and number of pages) increases over time.  What do you think of storing log_string as part of vb2_screen_state, and introducing something like this in ui_loop() to handle the case?\n\n  /* Restore the previous log string, and assume the\n     number of pages stays constant. */\n  if (ui.state-\u003escreen-\u003eid !\u003d prev_state.screen-\u003eid \u0026\u0026\n      ui.state-\u003elog_string)\n    vb2ex_prepare_log_screen(ui.state-\u003elog_string);",
      "revId": "b9f7f8e873754fe7c25322ffa54e669f62ca6e59",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9f456f59_d56fe980",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1113505
      },
      "writtenOn": "2020-08-27T11:46:42Z",
      "side": 1,
      "message": "As a side note, in diagnostics, we had a plan to keep appending the log string in memory tests. But I removed this feature and make the memory test screen fixed in one page to reduce UI change work. The OEM feedback may impact this constraint in future. (e.g. they want more detail show on screen when running)\n\nIn short, we won\u0027t have to worry about the length change right now, but it may be a feature request for the next milestone of diagnostics.",
      "parentUuid": "d0fa173e_b3aca797",
      "revId": "b9f7f8e873754fe7c25322ffa54e669f62ca6e59",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "18214955_08a9ee30",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1383774
      },
      "writtenOn": "2020-08-28T06:05:00Z",
      "side": 1,
      "message": "(1) Since we should always restore this before calling vb2ex_display_ui(), I think the best place for calling vb2ex_prepare_log_screen() should be somewhere around\n menu \u003d get_menu(\u0026ui);\n\n(2) We will prepare the whole log twice in a row: one is (previous iteration) in debug_info_init(), and the other is (current iteration) right before vb2ex_display_ui(). A solution is that we retrieve log_string and set current_page \u003d 0 in init() only; while prepare log and retrieve page_count right before vb2ex_display_ui()\n\n(3) What about errors during preparing? We can not distinguish this is a debug_info/firmware_log/diagnostics screen error unless switch(ui.state-\u003escreen-\u003eid)",
      "parentUuid": "9f456f59_d56fe980",
      "revId": "b9f7f8e873754fe7c25322ffa54e669f62ca6e59",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "33f6230c_d3cfff45",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1383774
      },
      "writtenOn": "2020-08-28T06:57:03Z",
      "side": 1,
      "message": "https://chromium-review.googlesource.com/c/chromiumos/platform/vboot_reference/+/2379582\n\nHere\u0027s the CL for the ui_loop preparing workaround.\n\nNote that (1) we will init twice while entering a new log screen. (2) we assume that we will not fail to prepare log_string in ui_loop.\n\nWhat\u0027s your suggestion",
      "parentUuid": "18214955_08a9ee30",
      "revId": "b9f7f8e873754fe7c25322ffa54e669f62ca6e59",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d3280d44_e75fecdf",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2020-08-28T07:50:05Z",
      "side": 1,
      "message": "Hi Hsuan-Ting,\n\nThanks for putting that experimental CL together.  I see your point -- this solution comes with its own shortcomings.\n\nAnother possible option would be to not bother passing log_string through vboot -- change the argument of vb2ex_prepare_log_screen to vb2_screen enum, and have depthcharge take care internally of keeping track of the different strings and which screen they match up to.\n\nI think I\u0027m okay going with your reinit() solution for now, especially after having removed the extra complexity of VB2_REQUEST_UI_BACK.  Let\u0027s lump this together with the \"force_display\" flag as technical debt that we can reconsider at a later date.",
      "parentUuid": "33f6230c_d3cfff45",
      "revId": "b9f7f8e873754fe7c25322ffa54e669f62ca6e59",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "77ce9fb1_dbd97d9b",
        "filename": "firmware/2lib/2ui_screens.c",
        "patchSetId": 9
      },
      "lineNbr": 265,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2020-08-28T07:50:05Z",
      "side": 1,
      "message": "This can probably still live on one line.",
      "range": {
        "startLine": 263,
        "startChar": 23,
        "endLine": 265,
        "endChar": 14
      },
      "revId": "b9f7f8e873754fe7c25322ffa54e669f62ca6e59",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2606db4a_905fbcab",
        "filename": "firmware/2lib/2ui_screens.c",
        "patchSetId": 9
      },
      "lineNbr": 265,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2020-08-28T09:04:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "77ce9fb1_dbd97d9b",
      "range": {
        "startLine": 263,
        "startChar": 23,
        "endLine": 265,
        "endChar": 14
      },
      "revId": "b9f7f8e873754fe7c25322ffa54e669f62ca6e59",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}