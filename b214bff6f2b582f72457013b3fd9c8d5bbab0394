{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "6124b51a_540be641",
        "filename": "firmware/2lib/2load_android_kernel.c",
        "patchSetId": 3
      },
      "lineNbr": 343,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2025-09-27T01:06:07Z",
      "side": 1,
      "message": "No, I meant this much simpler. The function signature should be `const char **extra_cmdline_out`, and then the callee can just do stuff like `*extra_cmdline_out \u003d \"kasan\u003don\";`.",
      "revId": "b214bff6f2b582f72457013b3fd9c8d5bbab0394",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "841aa76b_f54c2d89",
        "filename": "firmware/2lib/2load_android_kernel.c",
        "patchSetId": 3
      },
      "lineNbr": 343,
      "author": {
        "id": 1544412
      },
      "writtenOn": "2025-09-29T06:12:57Z",
      "side": 1,
      "message": "@jeffxu@google.com mentioned that MTE may extend MISC Partition Protocol with new flags to `memtag_mode`. e.g. kasan.mode\u003d[sync, async, asymm]. It will need a buffer to compose the cmldine string.",
      "parentUuid": "6124b51a_540be641",
      "revId": "b214bff6f2b582f72457013b3fd9c8d5bbab0394",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6f18ec24_f9feedc5",
        "filename": "firmware/2lib/2load_android_kernel.c",
        "patchSetId": 3
      },
      "lineNbr": 343,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2025-09-30T16:05:34Z",
      "side": 1,
      "message": "I don\u0027t see how that prevents you from changing to the API suggested by Julius. The depthcharge code can `malloc` the buffer by itself and then set `*extra_cmdline_out \u003d buffer`. Benefits:\n\n1. No need to pass the size to `vb2ex_handle_android_misc_partition`\n2. Easier to tell if `vb2ex_handle_android_misc_partition` sets the extra cmdline or not (by `*extra_cmdline_out !\u003d NULL`)",
      "parentUuid": "841aa76b_f54c2d89",
      "revId": "b214bff6f2b582f72457013b3fd9c8d5bbab0394",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c81ec7ec_1a3ffdfc",
        "filename": "firmware/2lib/2load_android_kernel.c",
        "patchSetId": 3
      },
      "lineNbr": 343,
      "author": {
        "id": 1544412
      },
      "writtenOn": "2025-09-30T16:43:57Z",
      "side": 1,
      "message": "My intention is allocating the buffer for extra_cmdline and freeing the buffer after using it. I am fine with your approach if allocating the memory without freeing is not a concern.",
      "parentUuid": "6f18ec24_f9feedc5",
      "revId": "b214bff6f2b582f72457013b3fd9c8d5bbab0394",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "385345eb_777972a8",
        "filename": "firmware/2lib/2load_android_kernel.c",
        "patchSetId": 3
      },
      "lineNbr": 476,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2025-09-30T16:05:34Z",
      "side": 1,
      "message": "Is this supposed to be `sizeof(vendor_hdr-\u003ecmdline)`?\n\nI wonder if it would be cleaner to do this inside `rearrange_partitions()` (by passing `extra_cmdline` to that function)?",
      "range": {
        "startLine": 475,
        "startChar": 6,
        "endLine": 476,
        "endChar": 55
      },
      "revId": "b214bff6f2b582f72457013b3fd9c8d5bbab0394",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "aa5305b8_e95ce19a",
        "filename": "firmware/2lib/2load_android_kernel.c",
        "patchSetId": 3
      },
      "lineNbr": 476,
      "author": {
        "id": 1544412
      },
      "writtenOn": "2025-09-30T16:43:57Z",
      "side": 1,
      "message": "\u003e Is this supposed to be sizeof(vendor_hdr-\u003ecmdline)?\n\nThe original discussion is here.\nhttps://chromium-review.googlesource.com/c/chromiumos/platform/depthcharge/+/6887991/comment/fd8606d7_29cb2a8f/\n\n\u003e I wonder if it would be cleaner to do this inside rearrange_partitions() (by passing extra_cmdline to that function)?\n\nLooks good. I will do that in the next revision.",
      "parentUuid": "385345eb_777972a8",
      "range": {
        "startLine": 475,
        "startChar": 6,
        "endLine": 476,
        "endChar": 55
      },
      "revId": "b214bff6f2b582f72457013b3fd9c8d5bbab0394",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e14a6f2a_556ecf2b",
        "filename": "firmware/2lib/2load_android_kernel.c",
        "patchSetId": 3
      },
      "lineNbr": 479,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2025-09-27T01:06:07Z",
      "side": 1,
      "message": "Doing this means `rv` is still success so we\u0027d not return an error from this function. Not sure if that\u0027s intentional? If it is, please write the code more clearly (without a `goto`), e.g.\n```\nif (...fits...) {\n  params-... \u003d \u0027 \u0027;\n  memcpy(...);\n} else {\n  VB2_DEBUG(\"...problem but we\u0027ll continue anyway...\");\n}\n```\nIf not, you need to set `rv` to an explicit error.\n\nI think it\u0027s probably better to return a hard error here.",
      "revId": "b214bff6f2b582f72457013b3fd9c8d5bbab0394",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2d73e9f5_d410e140",
        "filename": "firmware/2lib/2load_android_kernel.c",
        "patchSetId": 3
      },
      "lineNbr": 479,
      "author": {
        "id": 1544412
      },
      "writtenOn": "2025-09-29T06:12:57Z",
      "side": 1,
      "message": "Yes, this is intentional. The booting process should be continued even without the extra command line.",
      "parentUuid": "e14a6f2a_556ecf2b",
      "revId": "b214bff6f2b582f72457013b3fd9c8d5bbab0394",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3a1d38cf_cde0942f",
        "filename": "firmware/2lib/2load_android_kernel.c",
        "patchSetId": 3
      },
      "lineNbr": 479,
      "author": {
        "id": 1544412
      },
      "writtenOn": "2025-09-29T06:49:26Z",
      "side": 1,
      "message": ".. should not be blocked ..",
      "parentUuid": "2d73e9f5_d410e140",
      "revId": "b214bff6f2b582f72457013b3fd9c8d5bbab0394",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3643118f_9686bc51",
        "filename": "firmware/2lib/2load_android_kernel.c",
        "patchSetId": 3
      },
      "lineNbr": 479,
      "author": {
        "id": 1544412
      },
      "writtenOn": "2025-09-30T16:43:57Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "3a1d38cf_cde0942f",
      "revId": "b214bff6f2b582f72457013b3fd9c8d5bbab0394",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}