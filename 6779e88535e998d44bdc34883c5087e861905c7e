{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "fafcc204_88194944",
        "filename": "firmware/lib/vboot_kernel.c",
        "patchSetId": 3
      },
      "lineNbr": 297,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2021-04-14T22:49:07Z",
      "side": 1,
      "message": "You\u0027re now printing this every time when someone boots a self-signed kernel in developer mode on a rolled-forward system, which we probably don\u0027t want. I think it makes sense to just skip this check entirely when !need_keyblock_valid. There seems little reason why we\u0027d care to check this in developer mode if we\u0027re not gonna do anything about it anyway.",
      "revId": "6779e88535e998d44bdc34883c5087e861905c7e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c1df637b_fe3538dc",
        "filename": "firmware/lib/vboot_kernel.c",
        "patchSetId": 3
      },
      "lineNbr": 297,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2021-04-15T11:03:19Z",
      "side": 1,
      "message": "Yeah, that makes sense.  I was just trying to match the constructs above (e.g. checking keyblock version), and figured printing some extra information wouldn\u0027t hurt.  Should we change those too?",
      "parentUuid": "fafcc204_88194944",
      "revId": "6779e88535e998d44bdc34883c5087e861905c7e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e65fdc4c_0c1f8458",
        "filename": "firmware/lib/vboot_kernel.c",
        "patchSetId": 3
      },
      "lineNbr": 297,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2021-04-16T00:51:33Z",
      "side": 1,
      "message": "Yeah, actually, I think the same counts for the keyblock version check. Would probably make sense to skip the message there as well (only for the actual comparison with the TPM version, the check for 0xffff still makes sense).\n\nAlso, while we\u0027re mucking around in here, I\u0027m actually confused why we still allow booting with !need_keyblock_valid when the keyblock flags mismatch. Kinda defeats the purpose of an \"allow booting in developer mode\" flag if that doesn\u0027t actually control anything. This is not a security issue and I guess we\u0027ve lived with it so far, but for consistency maybe we should consider making that check mandatory even without need_keyblock_valid.",
      "parentUuid": "c1df637b_fe3538dc",
      "revId": "6779e88535e998d44bdc34883c5087e861905c7e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e325cfa9_2b3f0549",
        "filename": "firmware/lib/vboot_kernel.c",
        "patchSetId": 3
      },
      "lineNbr": 297,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2021-04-16T07:48:12Z",
      "side": 1,
      "message": "Re. skipping messages in keyblocks: Let\u0027s start merging this CL train, and figure out the correct logic (below), and update this in a later CL?\n\nRe. keyblock flags mismatch.  Maybe I\u0027m missing something here, but my understanding is:\n\n(1) If developer mode is enabled, but FWMP_ENABLE_OFFICIAL_ONLY and DEV_BOOT_SIGNED_ONLY are both disabled, need_keyblock_valid \u003d\u003d 0.  That means we\u0027ll be able to boot any kernel, regardless of keyblock flags.  This seems logical, since we want to give the user full control over their machine in developer mode.\n\n(2) If developer mode is enabled, and at least one of FWMP_ENABLE_OFFICIAL_ONLY or DEV_BOOT_SIGNED_ONLY are enabled, need_keyblock_valid \u003d\u003d 1.  That means keyblock flag mismatches will not boot.\n\nOr would you disagree about (1), under the assumption that the developer could enable/disable the flags at will anyways?",
      "parentUuid": "e65fdc4c_0c1f8458",
      "revId": "6779e88535e998d44bdc34883c5087e861905c7e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "caac9845_ee296428",
        "filename": "firmware/lib/vboot_kernel.c",
        "patchSetId": 3
      },
      "lineNbr": 297,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2021-04-20T00:09:33Z",
      "side": 1,
      "message": "\u003e Or would you disagree about (1), under the assumption that the developer could enable/disable the flags at will anyways?\n\nYes. For self-signed keyblocks that\u0027s not a security feature (because the self-signer can just set that flag however they want), it\u0027s more of a \"make sure I don\u0027t do anything I didn\u0027t intend by accident\" feature. I think we should keep honoring that even in dev mode.",
      "parentUuid": "e325cfa9_2b3f0549",
      "revId": "6779e88535e998d44bdc34883c5087e861905c7e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}