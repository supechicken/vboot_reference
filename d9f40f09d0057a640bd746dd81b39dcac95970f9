{
  "comments": [
    {
      "key": {
        "uuid": "4c9b6f04_01defd5c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1000239
      },
      "writtenOn": "2020-09-09T23:18:39Z",
      "side": 1,
      "message": "I\u0027m not sure if this CL is needed. If you already have FMAP_AREA_PRESERVE applied to SI_ME, then I think the updater will preserve it, no need to change the special ME preserve function.\n\nMeanwhile, I\u0027d assume you\u0027re going to use it like, turn on this flag most of the time, and only turn if off it when there\u0027s a critical update right?\n\nBut in practice, that implies the ME will be rarely updated, and developers/testers may find it pretty confusing that futility didn\u0027t update their ME. Be careful!",
      "revId": "d9f40f09d0057a640bd746dd81b39dcac95970f9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8bb0b681_440af445",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1000239
      },
      "writtenOn": "2020-09-09T23:35:19Z",
      "side": 1,
      "message": "(preserve_fmap_sections should already preserved all sections with FMAP_AREA_PRESERVE)",
      "parentUuid": "4c9b6f04_01defd5c",
      "revId": "d9f40f09d0057a640bd746dd81b39dcac95970f9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fcd654e2_0280e494",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1260470
      },
      "writtenOn": "2020-09-10T20:01:56Z",
      "side": 1,
      "message": "There may also be a test or two that need to be patched up:\n\nhttps://ci.chromium.org/p/chromeos/builders/general/Try/b8869601251938077152?",
      "revId": "d9f40f09d0057a640bd746dd81b39dcac95970f9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e96e84f_fbfcdce8",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1302633
      },
      "writtenOn": "2020-09-15T07:16:05Z",
      "side": 1,
      "message": "I haven\u0027t forgot your comments. At this point, I am trying to stitch together all the different things to identify a working solution. I will definitely address all the comments here once I have a complete picture of workable solution.",
      "parentUuid": "8bb0b681_440af445",
      "revId": "d9f40f09d0057a640bd746dd81b39dcac95970f9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c114c44c_bbd0a55d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1302633
      },
      "writtenOn": "2020-09-15T20:53:46Z",
      "side": 1,
      "message": "I added this CL for 2 reasons:\n1) ME is unlocked(try_apply_quirks(QUIRK_UNLOCK_ME_FOR_UPDATE). I was not sure about the side-effect because of that.\n2) preserve_fmap_section preserves the regions based on destination/to image. If ME is not preserved in the \"to\" image, then the ME is overwritten. This will most likely be the case for firmware downgrade.\n\n1) is most likely not a problem. Regarding 2), I am not sure if the preserve decision should be based on the source image or the destination image.\n\n\nRegarding the original motivation behind this CL:\nThere is a problem in recent Intel platforms(Dedede, Volteer) where updating the CSME region as part of firmware updates leads to functionality issues(eg. audio/camera are broken). Even though the exact reason is not identified, Intel is highlighting that updating the CSME region while AP is in S0 state can lead to functionality issues. We have asked Intel to update the entire CSME region through coreboot. There are 2 challenges with that approach:\n1) We need to identify the exact cause of the issue so that we develop the right solution\n2) On platforms with 16 MB SPI ROM, we might run out of space.\n\nSo this CL is part of an alternate solution where:\n1) Do not update CSME region as part of firmware update. Update only the BIOS region in SPI ROM\n2) In the next boot just at the start of UI, update the CSME region using an upstart script and trigger a cold reset.\n\nAlso update the CSME region only if there was a firmware update earlier and SPI ROM is not write protected and ME is unlocked. The above checks ensure that we update the CSME region only in development phases.",
      "parentUuid": "6e96e84f_fbfcdce8",
      "revId": "d9f40f09d0057a640bd746dd81b39dcac95970f9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5c6be767_869dfd4d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1302633
      },
      "writtenOn": "2020-09-15T20:56:10Z",
      "side": 1,
      "message": "The rest of the CLs in this stack are here:\nhttps://review.coreboot.org/c/coreboot/+/45215\nhttps://chrome-internal-review.googlesource.com/c/chromeos/overlays/overlay-dedede-private/+/3270910/\nhttps://chromium-review.googlesource.com/c/chromiumos/platform2/+/2411695",
      "parentUuid": "c114c44c_bbd0a55d",
      "revId": "d9f40f09d0057a640bd746dd81b39dcac95970f9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d767758a_b45ffeef",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1000239
      },
      "writtenOn": "2020-09-16T00:39:48Z",
      "side": 1,
      "message": "\u003e preserve_fmap_section preserves the regions based on destination/to image. If ME is not preserved in the \"to\" image, then the ME is overwritten. This will most likely be the case for firmware downgrade.\n\nIf you really want to prevent \"downgrade\", you should add something like a version tag in CSME, and compare here, not rely on PRESERVE attributes.\n\nHowever it\u0027s also true if you can\u0027t \"downgrade\", you have to deal with the case that the rest of firmware (coreboot, ec, etc) all \"downgraded\" while CSME is still in latest version. That may create another layer of complexity in testing and failure in compatbility.",
      "parentUuid": "5c6be767_869dfd4d",
      "revId": "d9f40f09d0057a640bd746dd81b39dcac95970f9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7e5f66af_ef66478c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1003000
      },
      "writtenOn": "2020-09-16T00:51:33Z",
      "side": 1,
      "message": "I don\u0027t think there is any problem with downgrade of CSME. We should always keep the rest of the firmware components aligned with the CSME from a single build. What Karthik is probably referring to is the condition where a program did not initially have PRESERVE flag marked in fmap, but later sets PRESERVE on CSME region. I think that is a very corner case which might happen only in early development and it is okay to use \"to\" image flags.",
      "parentUuid": "d767758a_b45ffeef",
      "revId": "d9f40f09d0057a640bd746dd81b39dcac95970f9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}