{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "522b0663_5edde530",
        "filename": "scripts/image_signing/sign_official_build.sh",
        "patchSetId": 14
      },
      "lineNbr": 1026,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2025-08-13T19:36:10Z",
      "side": 1,
      "message": "Should we fix the ShellCheck here? I think it just wants you to do\n```\nlocal new_config_file\nnew_config_file\u003d\"$(make_temp_file)\"\n```\n(because it makes some kind of difference of how it interacts with `set -e`, I think).",
      "range": {
        "startLine": 1026,
        "startChar": 8,
        "endLine": 1026,
        "endChar": 23
      },
      "revId": "fd7406ce9698ff4743e966e0b48e2b4f0588d6fa",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6a0c86f0_b9fc5055",
        "filename": "scripts/image_signing/sign_official_build.sh",
        "patchSetId": 14
      },
      "lineNbr": 1026,
      "author": {
        "id": 1351160
      },
      "writtenOn": "2025-08-13T20:06:10Z",
      "side": 1,
      "message": "Fix applied.",
      "parentUuid": "522b0663_5edde530",
      "range": {
        "startLine": 1026,
        "startChar": 8,
        "endLine": 1026,
        "endChar": 23
      },
      "fixSuggestions": [
        {
          "fixId": "0c1836c9_45d67665",
          "description": "GET_AI_FIX_FOR_COMMENT prompt_to_edit API",
          "replacements": [
            {
              "path": "scripts/image_signing/sign_official_build.sh",
              "range": {
                "startLine": 1026,
                "startChar": 0,
                "endLine": 1027,
                "endChar": 0
              },
              "replacement": "  local new_config_file\n  new_config_file\u003d\"$(make_temp_file)\"\n"
            }
          ]
        }
      ],
      "revId": "fd7406ce9698ff4743e966e0b48e2b4f0588d6fa",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a49d652d_4a369897",
        "filename": "scripts/image_signing/sign_official_build.sh",
        "patchSetId": 14
      },
      "lineNbr": 1052,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2025-08-13T19:36:10Z",
      "side": 1,
      "message": "nit: This works, but have you tried the version I suggested? You could just let `read` do both parts of the splitting for you, then you wouldn\u0027t have to `cut` the result separately.\n\nI think my last version had a small issue in that `read -d` doesn\u0027t recognize the part after the last delimiter, but that\u0027s easily remedied by attaching a trailing comma:\n```\nwhile IFS\u003d\u0027:\u0027 read -d \u0027,\u0027 part_num old_hash; do\n  local part_hash\n  part_hash\u003d\"$(sudo sha256sum \"${loopdev}p${part_num}\" | cut -f1 -d\u0027 \u0027 | xxd -r -p | base64 -w0)\"\n  [[ \"${part_hash}\" \u003d \"${old_hash}\" ]] || info \"Updated part_hash for partition ${part_num} from \u0027${old_hash}\u0027 to \u0027${part_hash}\u0027\"\n  part_hashes+\u003d(\"${part_num}:${part_hash}\")\ndone \u003c\u003c\u003c \"${old_part_hash},\"\n```",
      "revId": "fd7406ce9698ff4743e966e0b48e2b4f0588d6fa",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "45a714d4_ce4ae922",
        "filename": "scripts/image_signing/sign_official_build.sh",
        "patchSetId": 14
      },
      "lineNbr": 1052,
      "author": {
        "id": 1351160
      },
      "writtenOn": "2025-08-13T20:06:10Z",
      "side": 1,
      "message": "Yes, I think your version will work too\n\nEven with one more loop / more variables, this was easier to break into parts for me.\n\nCan we ack for now?",
      "parentUuid": "a49d652d_4a369897",
      "revId": "fd7406ce9698ff4743e966e0b48e2b4f0588d6fa",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "292083f7_8fab58a1",
        "filename": "scripts/image_signing/sign_official_build.sh",
        "patchSetId": 14
      },
      "lineNbr": 1054,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2025-08-13T19:36:10Z",
      "side": 1,
      "message": "Why two loops and more arrays? Just extract the `part_hash` right here.",
      "revId": "fd7406ce9698ff4743e966e0b48e2b4f0588d6fa",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "076ddf3e_62d7ba50",
        "filename": "scripts/image_signing/sign_official_build.sh",
        "patchSetId": 14
      },
      "lineNbr": 1054,
      "author": {
        "id": 1351160
      },
      "writtenOn": "2025-08-13T20:06:10Z",
      "side": 1,
      "message": "I kept it in two separate steps.\nRather than it being monolithic\n\nIt\u0027s a bit more readable / easier to follow the actual action steps.",
      "parentUuid": "292083f7_8fab58a1",
      "revId": "fd7406ce9698ff4743e966e0b48e2b4f0588d6fa",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9f25cc79_9728fd7d",
        "filename": "scripts/image_signing/sign_official_build.sh",
        "patchSetId": 14
      },
      "lineNbr": 1054,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2025-08-13T20:48:23Z",
      "side": 1,
      "message": "Well, I really disagree with this but I can tell you\u0027re eager to move on. It\u0027s only two steps because you\u0027re making it two steps. Every extra line, every extra variable you add to code adds one more thing that the reader needs to keep in their head when trying to follow what it\u0027s doing. I\u0027m not saying you should be using any obscure pattern just to save a line, but there\u0027s nothing obscure about \"loop over all part_num,hash pairs, process part_num and add the result to a list\". Splitting it into \"loop over all part_num,hash pairs, put part_num in a list, then loop over all pairs in that list, process them and add the result to another list\" really doesn\u0027t simplify anything, it just makes the entire flow more complicated and adds more opportunities for people to become confused about which list contains what.",
      "parentUuid": "076ddf3e_62d7ba50",
      "revId": "fd7406ce9698ff4743e966e0b48e2b4f0588d6fa",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1b232720_440d8a41",
        "filename": "scripts/image_signing/sign_official_build.sh",
        "patchSetId": 14
      },
      "lineNbr": 1058,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2025-08-13T19:36:10Z",
      "side": 1,
      "message": "I don\u0027t think you need this when it\u0027s written like this.",
      "revId": "fd7406ce9698ff4743e966e0b48e2b4f0588d6fa",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4b0b21f2_cc869c5a",
        "filename": "scripts/image_signing/sign_official_build.sh",
        "patchSetId": 14
      },
      "lineNbr": 1058,
      "author": {
        "id": 1351160
      },
      "writtenOn": "2025-08-13T20:06:10Z",
      "side": 1,
      "message": "It\u0027s to clear out just in case!",
      "parentUuid": "1b232720_440d8a41",
      "revId": "fd7406ce9698ff4743e966e0b48e2b4f0588d6fa",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "032feb34_47681a1c",
        "filename": "scripts/image_signing/sign_official_build.sh",
        "patchSetId": 14
      },
      "lineNbr": 1058,
      "author": {
        "id": 1000239
      },
      "writtenOn": "2025-08-14T01:52:32Z",
      "side": 1,
      "message": "I\u0027d also prefer to remove this unset.\n\nOther developers will try to look for where IFS was set in the scope (and found none), and then considering if this is something left from an incomplete refactoring.",
      "parentUuid": "4b0b21f2_cc869c5a",
      "revId": "fd7406ce9698ff4743e966e0b48e2b4f0588d6fa",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "68456d87_a7d06505",
        "filename": "scripts/image_signing/sign_official_build.sh",
        "patchSetId": 14
      },
      "lineNbr": 1058,
      "author": {
        "id": 1351160
      },
      "writtenOn": "2025-08-14T03:27:37Z",
      "side": 1,
      "message": "Since both you mentioned it, let\u0027s remove this line.\n\nI think it will be okay even without a full retest, local testing seems to be ok.",
      "parentUuid": "032feb34_47681a1c",
      "revId": "fd7406ce9698ff4743e966e0b48e2b4f0588d6fa",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a76ac586_5c290c7e",
        "filename": "scripts/image_signing/sign_official_build.sh",
        "patchSetId": 14
      },
      "lineNbr": 1076,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2025-08-13T19:36:10Z",
      "side": 1,
      "message": "Considering that we\u0027re going to print the entire kernel command line in the next debug message anyway, we really don\u0027t need this.",
      "revId": "fd7406ce9698ff4743e966e0b48e2b4f0588d6fa",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9de7a1ec_a688f7d1",
        "filename": "scripts/image_signing/sign_official_build.sh",
        "patchSetId": 14
      },
      "lineNbr": 1076,
      "author": {
        "id": 1351160
      },
      "writtenOn": "2025-08-13T20:06:10Z",
      "side": 1,
      "message": "We don\u0027t need it, but it helped debugging / showing proof of run\n\nLet\u0027s keep this as it\u0027s a simple log!",
      "parentUuid": "a76ac586_5c290c7e",
      "revId": "fd7406ce9698ff4743e966e0b48e2b4f0588d6fa",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}