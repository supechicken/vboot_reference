{
  "comments": [
    {
      "key": {
        "uuid": "cce1b899_7fc57e9d",
        "filename": "firmware/2lib/include/2return_codes.h",
        "patchSetId": 3
      },
      "lineNbr": 30,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2020-04-17T22:52:58Z",
      "side": 1,
      "message": "Can we make it below 0x10000 so that a smaller-than check also differentiates it from the vboot1 VBERROR_... stuff? So maybe start at 0x100 or 0x1000 or something. (You can ignore the pre-vboot1 errors which should never be used in actual firmware code.)",
      "range": {
        "startLine": 30,
        "startChar": 15,
        "endLine": 30,
        "endChar": 24
      },
      "revId": "c3944584ba108e67b723ab23ac93a5e5c7e20777",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8760886d_3cca7a57",
        "filename": "firmware/2lib/include/2return_codes.h",
        "patchSetId": 3
      },
      "lineNbr": 30,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2020-04-18T02:10:05Z",
      "side": 1,
      "message": "Done.\n\nVB2_ERROR_* start at a large offset to reduce the risk of overlap with other error codes (TPM, etc.). Don\u0027t we have the same problem for VB2_REQUEST?",
      "parentUuid": "cce1b899_7fc57e9d",
      "range": {
        "startLine": 30,
        "startChar": 15,
        "endLine": 30,
        "endChar": 24
      },
      "revId": "c3944584ba108e67b723ab23ac93a5e5c7e20777",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9d0ede8d_fa82f294",
        "filename": "firmware/2lib/include/2return_codes.h",
        "patchSetId": 3
      },
      "lineNbr": 30,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2020-04-20T07:46:30Z",
      "side": 1,
      "message": "FWIW TPM errors currently run from 0 to 0x5010.\n\nI think this may have been a concern in the past from problems like vb2_error_t functions incorrectly returning a TPM error code, but I believe we have fixed all of these now (fingers crossed).\n\nSo I don\u0027t think it should be an issue anymore, and we can probably even remove that comment...\n\n\nOn the other hand, we\u0027re haven\u0027t needed to use the \u003cVB2_REQUEST comparison yet, and we could just gate that on removing the last few vboot1-style errors (only three left now).  In that case, we could leave it at 0x1000000.  Julius, what\u0027s your preference?",
      "parentUuid": "8760886d_3cca7a57",
      "range": {
        "startLine": 30,
        "startChar": 15,
        "endLine": 30,
        "endChar": 24
      },
      "revId": "c3944584ba108e67b723ab23ac93a5e5c7e20777",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "475cb586_33f302a8",
        "filename": "firmware/2lib/include/2return_codes.h",
        "patchSetId": 3
      },
      "lineNbr": 30,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2020-04-21T00:21:42Z",
      "side": 1,
      "message": "When is that gonna happen? Because if we want to establish the rule that VB2_TRY() acts differently on VB2_REQUEST than VB2_ERROR, I would like to do that right now, not in some far out future when people have gotten used to it differently. So unless you were planning a big error cleanup this week anyway, let\u0027s please prioritize hooking this up to VB2_TRY() and using it to simplify the EC sync code (and wherever else it may be suitable).\n\nWith the TPM error concern... I guess if we wanna be really careful we should put it somewhere far out of the way that\u0027s unlikely to overlap with anything else after all (e.g. 0x95700000-0x95800000). The extra comparison operation is hopefully not gonna kill us",
      "parentUuid": "9d0ede8d_fa82f294",
      "range": {
        "startLine": 30,
        "startChar": 15,
        "endLine": 30,
        "endChar": 24
      },
      "revId": "c3944584ba108e67b723ab23ac93a5e5c7e20777",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5e8db2e4_96cb60af",
        "filename": "firmware/2lib/include/2return_codes.h",
        "patchSetId": 3
      },
      "lineNbr": 30,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2020-04-21T05:57:23Z",
      "side": 1,
      "message": "\u003e When is that gonna happen?\n\nLet\u0027s do it!\nhttps://chromium-review.googlesource.com/c/chromiumos/platform/vboot_reference/+/2158666\nhttps://chromium-review.googlesource.com/c/chromiumos/platform/depthcharge/+/2158665\n\nYu-Ping, could you take care of the VB2_TRY side of things?\n\n\n\u003e I guess if we wanna be really careful\n\nPersonally I\u0027d still prefer to put it at a location \u003cVB2_ERROR_BASE.  If we really care about erroneously returning non-vb2_error_t errors... then we can change vb2_error_t to use the enum directly, rather than uint32_t.",
      "parentUuid": "475cb586_33f302a8",
      "range": {
        "startLine": 30,
        "startChar": 15,
        "endLine": 30,
        "endChar": 24
      },
      "revId": "c3944584ba108e67b723ab23ac93a5e5c7e20777",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "03932bfa_1fd9beb4",
        "filename": "firmware/2lib/include/2return_codes.h",
        "patchSetId": 3
      },
      "lineNbr": 30,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2020-04-21T21:03:04Z",
      "side": 1,
      "message": "\u003e then we can change vb2_error_t to use the enum directly, rather than uint32_t.\n\nNot sure what that\u0027s supposed to help with. In C enums and integers are implicitly convertible to each other. The only way you can make the compiler type check this for you is by making it a struct, and then unfortunately things like (rv \u003d\u003d VB2_ERROR_xxx) no longer work (you\u0027d have to do something ugly like IS_VB2_ERROR(rv, xxx) or something like that).\n\nvb2_error_t is defined as uint32_t instead of the enum mostly because the size of enum types can be somewhat unpredictable, and we\u0027re serializing it across architectures.",
      "parentUuid": "5e8db2e4_96cb60af",
      "range": {
        "startLine": 30,
        "startChar": 15,
        "endLine": 30,
        "endChar": 24
      },
      "revId": "c3944584ba108e67b723ab23ac93a5e5c7e20777",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e81ca43a_09da1c91",
        "filename": "firmware/2lib/include/2return_codes.h",
        "patchSetId": 3
      },
      "lineNbr": 30,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2020-04-22T04:50:16Z",
      "side": 1,
      "message": "Ack.  I\u0027m okay with either space (low or high) for the REQUESTs to live then.",
      "parentUuid": "03932bfa_1fd9beb4",
      "range": {
        "startLine": 30,
        "startChar": 15,
        "endLine": 30,
        "endChar": 24
      },
      "revId": "c3944584ba108e67b723ab23ac93a5e5c7e20777",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "40aff4a6_fcd27109",
        "filename": "firmware/2lib/include/2return_codes.h",
        "patchSetId": 3
      },
      "lineNbr": 45,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2020-04-17T22:52:58Z",
      "side": 1,
      "message": "Let\u0027s also add an \"end\" constant to make it easy to check \u0027if (rv \u003c VB2_REQUEST_END)\u0027 to test for \"not error\".",
      "revId": "c3944584ba108e67b723ab23ac93a5e5c7e20777",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "344b9eb6_a2ccb222",
        "filename": "firmware/2lib/include/2return_codes.h",
        "patchSetId": 3
      },
      "lineNbr": 45,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2020-04-18T02:10:05Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "40aff4a6_fcd27109",
      "revId": "c3944584ba108e67b723ab23ac93a5e5c7e20777",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b8d54ebc_20017fca",
        "filename": "firmware/2lib/include/2return_codes.h",
        "patchSetId": 3
      },
      "lineNbr": 45,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2020-04-20T07:46:30Z",
      "side": 1,
      "message": "It might also be worth considering using \"rv \u003e\u003d VB2_ERROR_BASE\" instead, since that conveys the meaning a bit more accurately (\u003c VB2_REQUEST_END includes VB2_SUCCESS which is not an error).",
      "parentUuid": "344b9eb6_a2ccb222",
      "revId": "c3944584ba108e67b723ab23ac93a5e5c7e20777",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}