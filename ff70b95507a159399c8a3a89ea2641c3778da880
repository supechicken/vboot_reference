{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "0075196d_bf3377c5",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2025-08-12T20:07:36Z",
      "side": 1,
      "message": "I (think I) understand the problem but I don\u0027t understand how this patch is supposed to fix it? If there is a `/` in the variable (I assume that\u0027s what this is about, because slashes are part of the base64 character set?) it will still end up being passed to `sed` if you write it like this.\n\nIn fact, I\u0027m not sure there is a clean way to do this. You\u0027d basically have to write an `escape_for_sed` function and then make this `sed -n \"s/.*\\b$(escape_for_sed \"$2\")\u003d...` and have that function insert a backslash before all the characters that `sed` treat\u0027s specially.\n\nThe good news though is that I don\u0027t think any of the characters that are really special to `sed` (I believe that is `$.*[\\^`) should appear in our command lines (except for maybe the dot but that should be mostly harmless on its own). If your only real problem is the delimiter character, just pick a different one, e.g. `sed -n \"s#.*\\b$2\u003d\\([^ \\\"]*\\).*#\\1/p`.",
      "revId": "ff70b95507a159399c8a3a89ea2641c3778da880",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "86700905_63a01080",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1351160
      },
      "writtenOn": "2025-08-12T20:49:45Z",
      "side": 1,
      "message": "Hung-te might know more about this, but I think the issue is with the `\\` character. This is a more idiomatic way to write bash.",
      "parentUuid": "0075196d_bf3377c5",
      "revId": "ff70b95507a159399c8a3a89ea2641c3778da880",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b2280a36_00c6f328",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2025-08-12T21:06:16Z",
      "side": 1,
      "message": "Oh, I see, I think Hung-Te\u0027s concern was just the `\"\\1\"`? I mean, you could theoretically say that should be `\"\\\\1\"` but in practice either one works and I think many people write `sed` patterns that way, I wouldn\u0027t really consider it a problem.\n\nI do think there\u0027s a risk that someone used `sed \"s/\u003cold\u003e/\u003cnew\u003e/\"` on something parsing the kernel command line though, and that will eventually blow up when we start putting base64 strings there, so it would be good if you could double-check that all `sed` invocations related to the command line are guarded against that (e.g. use `#` instead).",
      "parentUuid": "86700905_63a01080",
      "revId": "ff70b95507a159399c8a3a89ea2641c3778da880",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4a64f9ee_007b3e2e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1351160
      },
      "writtenOn": "2025-08-13T01:03:23Z",
      "side": 1,
      "message": "The change here, just tackling the double quoted transition to single quote and explicitly only using double quoted for variable expansion.",
      "parentUuid": "b2280a36_00c6f328",
      "revId": "ff70b95507a159399c8a3a89ea2641c3778da880",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ae0311fa_69ceaabb",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1000239
      },
      "writtenOn": "2025-08-13T03:06:43Z",
      "side": 1,
      "message": "I tried to look at the shell script coding style guide but there was no clear definition. And looking at dash (this script is equipped with bash, but I usually prefer to have cros shell scripts being compatible between bash and dash since we usually need to port between each), it said\n````\nThe backslash inside double quotes is historically weird,\nand serves to quote only the following characters:\n$ ` \" \\ \u003cnewline\u003e. Otherwise it remains literal.\"\n````\nAnd seems like with the \"historically weird\", most POSIX shells today are following the same behavior.\n\nI personally still prefer to use single quotes `\u0027\u0027` especially when there are no parameters to be expanded in the string, to make it a very clear signal \"this is a raw/safe regex string\", also easier to copy-paste across different languages. However, I also agree if there are variables in the regex together with the \\1 substitution, making the whole regex as `\"s/pattern$1/\\1\u003d$2/\"` is probably easier to read than `\u0027s/pattern\u0027\"$1\"\u0027/\\1\u003d\u0027\"$2\"\u0027/\u0027`.\n\nLike Julius said, if most people writing shell script are already expecting \"\\1\" to work as-is, we don\u0027t really need to change them.\n\nAll the 4 sed commands do have variables inside. My recommendation is we don\u0027t need to really \"fix\" them (e.g., we can abandon this patch); or, at least change the title to \"revise\" since the existing code does work.\n\nAnd thanks for Jae\u0027s work on proposing this change!",
      "parentUuid": "4a64f9ee_007b3e2e",
      "revId": "ff70b95507a159399c8a3a89ea2641c3778da880",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "24412e58_9ac609a3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1351160
      },
      "writtenOn": "2025-08-13T03:13:06Z",
      "side": 1,
      "message": "My thanks goes to YOU two for reviewing / the discussions (I\u0027m grateful for it / learning)\n\n---\n\nI will leave the ultimate call to Julius - if we want to adjust the commit message as (s/Fix/Revise/) as Hung-Te rec\u0027d then land\n\nI\u0027m for it, otherwise, I will move onto other tasks atm!",
      "parentUuid": "ae0311fa_69ceaabb",
      "revId": "ff70b95507a159399c8a3a89ea2641c3778da880",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7bf6e6e5_71a60813",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2025-08-13T19:39:41Z",
      "side": 1,
      "message": "Sounds like we\u0027re agreeing that it\u0027s more readable to leave things as is (double-quotes). For patterns that don\u0027t contain any variable expansions, I agree with Hung-Te that you can use single-quotes for the whole string (but it\u0027s not a problem to use double quotes either and we don\u0027t need to go hunting down existing instances).",
      "parentUuid": "24412e58_9ac609a3",
      "revId": "ff70b95507a159399c8a3a89ea2641c3778da880",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0181ecd4_90b2fa89",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1351160
      },
      "writtenOn": "2025-08-13T19:40:31Z",
      "side": 1,
      "message": "Abandon it is",
      "parentUuid": "7bf6e6e5_71a60813",
      "revId": "ff70b95507a159399c8a3a89ea2641c3778da880",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}