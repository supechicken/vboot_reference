{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "0e6ce77e_5840c04b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 3487009
      },
      "writtenOn": "2025-05-05T16:19:07Z",
      "side": 1,
      "message": "Automatically set CQ+1 by AutoRunner. See go/chromeos-cqw:auto-runner-doc for details. \nReport Bugs/Feedback: go/cros-auto-runner-bug. \n",
      "revId": "931cfe512fef5787675a689a22c217bb3b8d7d35",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6505dce1_e58f3d85",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2025-05-06T01:22:41Z",
      "side": 1,
      "message": "Before we review this, can someone remind me if there is even still any reason *why* we\u0027re using EARLY_EC_SYNC on x86? (Apologies if I\u0027ve asked this before and forgotten the answer since.) Originally this option was introduced to help with power envelope edge cases when the EC was booting in RO with dead battery and couldn\u0027t do PD negotiation, where we were worried that the device couldn\u0027t reach depthcharge on 15W. But that problem has since been solved separately with EC-EFS2. So nowadays the EC should always be able to do PD negotiation even when the AP is booting in recovery mode (and besides, I\u0027m not sure if these newer Intel chips could even get to romstage and turn on the eSOL display on 15W?).\n\nSo why are we still doing this EARLY_EC_SYNC thing? If we don\u0027t need it for power, then otherwise it has only drawbacks (e.g. it doesn\u0027t allow us to compress the EC image in CBFS). Why don\u0027t we just turn it off and then we don\u0027t have this problem and don\u0027t need to add new eSOL screens, because the normal depthcharge UI can handle it?",
      "revId": "931cfe512fef5787675a689a22c217bb3b8d7d35",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d0e179de_040f88d1",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 3436255
      },
      "writtenOn": "2025-05-06T03:17:16Z",
      "side": 1,
      "message": "Agreed that EARLY_EC_SYNC has drawbacks and we have moved on to do it from depthcharge. However in some recent nissa devices we are seeing a particular issue with EC switching to RW in depthcharge. Please check b/412210635 description for more details on this. To solve this particular issue, we are forced to move EC sync to coreboot and in turn have to implement eSOL for better UX.",
      "parentUuid": "6505dce1_e58f3d85",
      "revId": "931cfe512fef5787675a689a22c217bb3b8d7d35",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "492c40a9_16939a43",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2025-05-06T06:25:11Z",
      "side": 1,
      "message": "From b/386920751#comment101, it looks like we enabled `VBOOT_EARLY_EC_SYNC` for Rull (Nissa), just in order for EC RW to complete PD negotiation before showing firmware screen. I didn\u0027t read every comment on the bug, but have we considered adding a short delay or busy loop (waiting for PD negotiation to complete) before showing firmware screen? That delay won\u0027t affect normal boot time anyway.",
      "parentUuid": "d0e179de_040f88d1",
      "revId": "931cfe512fef5787675a689a22c217bb3b8d7d35",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2cd36b73_6f5e9b4b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1532003
      },
      "writtenOn": "2025-05-06T06:53:41Z",
      "side": 1,
      "message": "\u003e From b/386920751#comment101, it looks like we enabled `VBOOT_EARLY_EC_SYNC` for Rull (Nissa), just in order for EC RW to complete PD negotiation before showing firmware screen. I didn\u0027t read every comment on the bug, but have we considered adding a short delay or busy loop (waiting for PD negotiation to complete) before showing firmware screen? That delay won\u0027t affect normal boot time anyway.\n\n\nIn summary, it looks like the ITE EC chip has a limitation where it takes 1 second to settle down when switching from read-only to read-write mode. If we send any commands to get PD mux info during this transition, we get incorrect data. After a month of analysis, we\u0027ve determined that syncing the EC in romstage is the best way to fix this error. We can\u0027t keep 1sec delay before sending any PD mux info cmd.\n\nWe\u0027ve already moved EC sync for rull and equivalent devices, but it can take 4-8 seconds to complete. To ensure users are notified during this time, we\u0027re working on enabling eSOL during EC sync.",
      "parentUuid": "492c40a9_16939a43",
      "revId": "931cfe512fef5787675a689a22c217bb3b8d7d35",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}