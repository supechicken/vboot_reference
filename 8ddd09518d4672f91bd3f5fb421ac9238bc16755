{
  "comments": [
    {
      "key": {
        "uuid": "fae74b92_82bbfaea",
        "filename": "cgpt/cgpt.h",
        "patchSetId": 5
      },
      "lineNbr": 66,
      "author": {
        "id": 1000058
      },
      "writtenOn": "2014-11-10T20:47:04Z",
      "side": 1,
      "message": "What are the units of flash_start and flash_size? Bytes? Disks using GPT use units of 512-byte blocks.",
      "revId": "8ddd09518d4672f91bd3f5fb421ac9238bc16755",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "da6367f0_c960f1f4",
        "filename": "cgpt/cgpt_common.c",
        "patchSetId": 5
      },
      "lineNbr": 458,
      "author": {
        "id": 1000058
      },
      "writtenOn": "2014-11-10T20:47:04Z",
      "side": 1,
      "message": "This test is the only place I can find where  drive-\u003egpt.stored_on_device is set. How are you going to create the NOR and NAND images needed for the factory images without first booting and running on the target system?\n\nIt seems like we\u0027ll want to run \"cgpt -c \" with some args on the build system first, which would emit the GPT header image for the NOR flash along with the raw disk image for the NAND flash.",
      "revId": "8ddd09518d4672f91bd3f5fb421ac9238bc16755",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a94d7fe_7d4517e2",
        "filename": "cgpt/cgpt_common.c",
        "patchSetId": 5
      },
      "lineNbr": 458,
      "author": {
        "id": 1107994
      },
      "writtenOn": "2014-11-10T22:03:37Z",
      "side": 1,
      "message": "What is this factory environment? I thought the installer, or some similar code, ran in the factory on the target device directly and that called out to cgpt, running on the target machine, which wrote the GPT.\n\nI will mail the depthcharge and vboot patches which sets stored_on_device from the firmware side soon, by the way.\n\nAll this code just handles the NOR side. Just like cgpt doesn\u0027t format ext4 partitions today, it also won\u0027t write the disk image for NAND flash. It\u0027ll take some time until we have that working since I\u0027m still working out NAND driver issues on Storm.",
      "parentUuid": "da6367f0_c960f1f4",
      "revId": "8ddd09518d4672f91bd3f5fb421ac9238bc16755",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7ac51b23_4e4af3a6",
        "filename": "cgpt/cgpt_common.c",
        "patchSetId": 5
      },
      "lineNbr": 458,
      "author": {
        "id": 1000058
      },
      "writtenOn": "2014-11-11T01:29:20Z",
      "side": 1,
      "message": "In order for the device to boot, it has to either have an image on it that can boot, or it has to boot from a USB drive that has an image on it that can boot.\n\nWhen you build the firmware for a chromebook, this is /build/$BOARD/firmware/image.bin or similar. We can flash it onto the target using servo, or in the factory it\u0027s often preloaded onto the flash chips before they\u0027re soldered down.\n\nThat\u0027s why I ask this here: How are the NOR+NAND flash devices manufactured?  If you need to know what bits should be in the flash before applying power (say, so you can determine the checksums used for verified boot/software sync), then we need a way to generate those images without actually booting the target first.",
      "parentUuid": "5a94d7fe_7d4517e2",
      "revId": "8ddd09518d4672f91bd3f5fb421ac9238bc16755",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3a4c838a_64e91f93",
        "filename": "cgpt/cgpt_common.c",
        "patchSetId": 5
      },
      "lineNbr": 458,
      "author": {
        "id": 1107994
      },
      "writtenOn": "2014-11-11T01:35:15Z",
      "side": 1,
      "message": "Oh, I was assuming it\u0027d boot off of USB (or netboot somehow) but I should talk with manufacturing people more. Thanks for pointing this out.",
      "parentUuid": "7ac51b23_4e4af3a6",
      "revId": "8ddd09518d4672f91bd3f5fb421ac9238bc16755",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fae74b92_45305c8b",
        "filename": "cgpt/cgpt_common.c",
        "patchSetId": 5
      },
      "lineNbr": 466,
      "author": {
        "id": 1000058
      },
      "writtenOn": "2014-11-10T20:47:04Z",
      "side": 1,
      "message": "Same issue here. FlashInit() will always invoke flashrom, which will cause problems if we just want to create the binary images to be installed onto the target.",
      "revId": "8ddd09518d4672f91bd3f5fb421ac9238bc16755",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "baf15352_89f56130",
        "filename": "cgpt/drive.c",
        "patchSetId": 5
      },
      "lineNbr": 52,
      "author": {
        "id": 1000058
      },
      "writtenOn": "2014-11-10T20:47:04Z",
      "side": 1,
      "message": "We only seem to return -1 or 0. Might be nice to provide more useful error codes, so the caller can know what went wrong.",
      "revId": "8ddd09518d4672f91bd3f5fb421ac9238bc16755",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fae74b92_e5265057",
        "filename": "cgpt/drive.c",
        "patchSetId": 5
      },
      "lineNbr": 56,
      "author": {
        "id": 1000058
      },
      "writtenOn": "2014-11-10T20:47:04Z",
      "side": 1,
      "message": "I\u0027m not a big fan of libraries that silently invoke other programs, especially with hard-coded paths. This won\u0027t work unless we\u0027re actually running on the target. \n\nWe should double-check with the external users of this library (cryptohome, installer, updater, etc.) to be sure they\u0027re okay with it.\n\nI\u0027d kind of prefer run-time options to specify where/how to find the various bits instead. Should we invoke a program (flashrom?), or read from a file, or be given the constants we need, or what?",
      "revId": "8ddd09518d4672f91bd3f5fb421ac9238bc16755",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fa6cabf2_7a3bd972",
        "filename": "cgpt/drive.c",
        "patchSetId": 5
      },
      "lineNbr": 56,
      "author": {
        "id": 1107994
      },
      "writtenOn": "2014-11-10T22:03:37Z",
      "side": 1,
      "message": "This code was copied and pasted from the vpd utility. Is it safe to say what gets called there can also be called here, or is cgpt run in more restricted environments than vpdutil?",
      "parentUuid": "fae74b92_e5265057",
      "revId": "8ddd09518d4672f91bd3f5fb421ac9238bc16755",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3a4c838a_44f8638c",
        "filename": "cgpt/drive.c",
        "patchSetId": 5
      },
      "lineNbr": 56,
      "author": {
        "id": 1000058
      },
      "writtenOn": "2014-11-11T01:29:20Z",
      "side": 1,
      "message": "It\u0027s probably okay, but best to ask. The one persistent exploit we\u0027ve encountered got that way through vpd. That makes me extra cautious about this kind of thing.",
      "parentUuid": "fa6cabf2_7a3bd972",
      "revId": "8ddd09518d4672f91bd3f5fb421ac9238bc16755",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fae74b92_a25a7e3a",
        "filename": "cgpt/drive.h",
        "patchSetId": 5
      },
      "lineNbr": 5,
      "author": {
        "id": 1000058
      },
      "writtenOn": "2014-11-10T20:47:04Z",
      "side": 1,
      "message": "This needs some #ifndef FOO to prevent it being included more than once.",
      "revId": "8ddd09518d4672f91bd3f5fb421ac9238bc16755",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}