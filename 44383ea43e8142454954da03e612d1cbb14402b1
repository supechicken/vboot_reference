{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "8b5fb083_f004daa6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2021-04-28T09:59:57Z",
      "side": 1,
      "message": "@jwerner: Can you take a look at this and give me your initial thoughts?  We may need to course-correct based on your comments, so I want to check with you before continuing implementation.",
      "revId": "44383ea43e8142454954da03e612d1cbb14402b1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f4125e8f_46c3d60e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1351160
      },
      "writtenOn": "2021-05-03T18:01:01Z",
      "side": 1,
      "message": "Would you be able to share a doc for us to try this CL out?",
      "revId": "44383ea43e8142454954da03e612d1cbb14402b1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "12b49ba3_885e5119",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2021-05-04T01:13:38Z",
      "side": 1,
      "message": "Yeah, basic direction seems fine to me.",
      "parentUuid": "8b5fb083_f004daa6",
      "revId": "44383ea43e8142454954da03e612d1cbb14402b1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c0405ccb_ee8d433a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2021-05-10T04:58:43Z",
      "side": 1,
      "message": "Please check the email thread about this, and let me know if you need additional support.",
      "parentUuid": "f4125e8f_46c3d60e",
      "revId": "44383ea43e8142454954da03e612d1cbb14402b1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "da49b16e_e5de9908",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1351160
      },
      "writtenOn": "2021-05-10T17:49:28Z",
      "side": 1,
      "message": "Great thanks! I\u0027ll try them out w/ the references you put",
      "parentUuid": "c0405ccb_ee8d433a",
      "revId": "44383ea43e8142454954da03e612d1cbb14402b1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fd4e40b4_52cc3943",
        "filename": "firmware/include/vboot_api.h",
        "patchSetId": 1
      },
      "lineNbr": 98,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2021-05-04T01:13:38Z",
      "side": 1,
      "message": "I don\u0027t think this should be a different flag, I think it\u0027s rather a different argument to VbTryLoadKernel(). Physically the disks are still just differentiated by whether they\u0027re fixed or removable. Depthcharge doesn\u0027t need to know whether a disk is suitable for miniOS booting vs GPT booting -- depthcharge just gives vboot all its fixed disks, and when vboot wants to boot a miniOS it searches all of those for a payload.",
      "revId": "44383ea43e8142454954da03e612d1cbb14402b1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5dbfa94e_9259e1ab",
        "filename": "firmware/include/vboot_api.h",
        "patchSetId": 1
      },
      "lineNbr": 98,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2021-05-10T04:58:43Z",
      "side": 1,
      "message": "What option would you prefer?\n\n(1)\n  vb2_error_t VbTryLoadKernel(struct vb2_context *ctx, uint32_t disk_flags)\n    VB_DISK_FLAG_REMOVABLE\n    VB_DISK_FLAG_FIXED\n    VB_DISK_FLAG_EXTERNAL_GPT\n    VB_DISK_FLAG_SECTOR_SEARCH\n\n(this is PS2, and is slightly different from PS1, which has FIXED and FIXED_SECTOR)\n\n(2)\n  vb2_error_t VbTryLoadKernel(struct vb2_context *ctx, uint32_t disk_flags,\n                              int do_sector_search)\n    VB_DISK_FLAG_REMOVABLE\n    VB_DISK_FLAG_FIXED\n    VB_DISK_FLAG_EXTERNAL_GPT",
      "parentUuid": "fd4e40b4_52cc3943",
      "revId": "44383ea43e8142454954da03e612d1cbb14402b1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "539113b2_b4cc515d",
        "filename": "firmware/include/vboot_api.h",
        "patchSetId": 1
      },
      "lineNbr": 98,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2021-05-19T23:16:05Z",
      "side": 1,
      "message": "I guess 1 sounds neat (I assume these flags are orthogonal, so you would do VbTryLoadKernel(VB_DISK_FLAG_FIXED | VB_DISK_FLAG_SECTOR_SEARCH) then?), but either option seems fine.",
      "parentUuid": "5dbfa94e_9259e1ab",
      "revId": "44383ea43e8142454954da03e612d1cbb14402b1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9ca429be_9fb08158",
        "filename": "firmware/include/vboot_api.h",
        "patchSetId": 1
      },
      "lineNbr": 98,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2021-05-21T12:29:32Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "539113b2_b4cc515d",
      "revId": "44383ea43e8142454954da03e612d1cbb14402b1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8ba75646_fdd92a4d",
        "filename": "firmware/lib/vboot_api_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 136,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2021-05-04T01:13:38Z",
      "side": 1,
      "message": "Is there really a point in setting a recovery reason when this fails? I think that may make things more confusing than useful.",
      "revId": "44383ea43e8142454954da03e612d1cbb14402b1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5934b1c7_d9adaf21",
        "filename": "firmware/lib/vboot_api_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 136,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2021-05-10T04:58:43Z",
      "side": 1,
      "message": "Good point.  Just to double-check my understanding of the current state:\n\n(1) vb2api_fail is only called for a disk-based boot, including both normal mode or developer mode.\n\n(2) vb2api_fail is NOT called for recovery boot (USB-based) or dev mode external boot (also USB-based).\n\nAre we still happy with this split?  We could potentially also change disk-based boot in developer mode to just show a UI error instead.\n\nIn any case, it doesn\u0027t feel very natural to pivot off of VB_DISK_FLAG_FIXED in deciding whether to call vb2api_fail.  Would it make more sense to break this out into a separate boolean argument (or another flags argument)?",
      "parentUuid": "8ba75646_fdd92a4d",
      "revId": "44383ea43e8142454954da03e612d1cbb14402b1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "301566d4_654c6106",
        "filename": "firmware/lib/vboot_api_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 136,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2021-05-19T23:16:05Z",
      "side": 1,
      "message": "Yes, I think that\u0027s how it has always worked. I think it would be fine to change it to exclude fixed-disk developer boot too if you want.\n\nI think it\u0027s fine to just decide this inside the function, it should have all the info it needs available. But you can change it to a boolean argument too if you want (although I think that might increase the risk of being inconsistent if there\u0027s, say, more than one path this could be called through in recovery mode for some reason).",
      "parentUuid": "5934b1c7_d9adaf21",
      "revId": "44383ea43e8142454954da03e612d1cbb14402b1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "384cc3da_26c4db90",
        "filename": "firmware/lib/vboot_api_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 136,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2021-05-21T12:29:32Z",
      "side": 1,
      "message": "Okay, then I think the right thing to do here is to only call vb2api_fail in the case of normal mode, which means !REC \u0026\u0026 !DEV.  Is that right?",
      "parentUuid": "301566d4_654c6106",
      "revId": "44383ea43e8142454954da03e612d1cbb14402b1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9da5aa43_06b7bf3b",
        "filename": "firmware/lib/vboot_api_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 136,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2021-05-24T22:18:36Z",
      "side": 1,
      "message": "Yeah that should be okay. Please do it in a separate CL, though.",
      "parentUuid": "384cc3da_26c4db90",
      "revId": "44383ea43e8142454954da03e612d1cbb14402b1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f7ac7844_b450e067",
        "filename": "firmware/lib/vboot_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 481,
      "author": {
        "id": 1351160
      },
      "writtenOn": "2021-05-03T18:01:01Z",
      "side": 1,
      "message": "Potentially missing a return?",
      "range": {
        "startLine": 481,
        "startChar": 5,
        "endLine": 481,
        "endChar": 16
      },
      "revId": "44383ea43e8142454954da03e612d1cbb14402b1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3951b2af_b7453217",
        "filename": "firmware/lib/vboot_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 481,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2021-05-10T04:58:43Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "f7ac7844_b450e067",
      "range": {
        "startLine": 481,
        "startChar": 5,
        "endLine": 481,
        "endChar": 16
      },
      "revId": "44383ea43e8142454954da03e612d1cbb14402b1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "51bbc8ee_2b39751f",
        "filename": "firmware/lib/vboot_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 505,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2021-05-04T01:13:38Z",
      "side": 1,
      "message": "There needs to be some form of return on success here, obviously.",
      "revId": "44383ea43e8142454954da03e612d1cbb14402b1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9c34b2a5_06193774",
        "filename": "firmware/lib/vboot_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 505,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2021-05-10T04:58:43Z",
      "side": 1,
      "message": "Added some plumbing.  Still need to figure out some better error values to use.",
      "parentUuid": "51bbc8ee_2b39751f",
      "revId": "44383ea43e8142454954da03e612d1cbb14402b1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8b001c00_10e8e39a",
        "filename": "firmware/lib/vboot_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 516,
      "author": {
        "id": 1351160
      },
      "writtenOn": "2021-05-03T18:01:01Z",
      "side": 1,
      "message": "Would this be \u003d\u003d `16 * 1024 / params-\u003ebytes_per_lba` ?",
      "range": {
        "startLine": 516,
        "startChar": 30,
        "endLine": 516,
        "endChar": 32
      },
      "revId": "44383ea43e8142454954da03e612d1cbb14402b1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7b53c717_fbf7fec3",
        "filename": "firmware/lib/vboot_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 516,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2021-05-10T04:58:43Z",
      "side": 1,
      "message": "Yeah, that works better.  Thanks!",
      "parentUuid": "8b001c00_10e8e39a",
      "range": {
        "startLine": 516,
        "startChar": 30,
        "endLine": 516,
        "endChar": 32
      },
      "revId": "44383ea43e8142454954da03e612d1cbb14402b1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "11dc27b3_198cfd97",
        "filename": "firmware/lib/vboot_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 520,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2021-05-04T01:13:38Z",
      "side": 1,
      "message": "Does it make sense to move this into vb2_load_partition() so we only need it once?",
      "revId": "44383ea43e8142454954da03e612d1cbb14402b1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "73f13f7b_088bb610",
        "filename": "firmware/lib/vboot_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 520,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2021-05-10T04:58:43Z",
      "side": 1,
      "message": "I think so.  Done in CL:2882527.",
      "parentUuid": "11dc27b3_198cfd97",
      "revId": "44383ea43e8142454954da03e612d1cbb14402b1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "abb825f5_cdcc5b8e",
        "filename": "firmware/lib/vboot_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 522,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2021-05-04T01:13:38Z",
      "side": 1,
      "message": "Remember in the final design we wanted to have an NVRAM flag decide the order here (right?). I assume you\u0027re just prototyping this for now.",
      "revId": "44383ea43e8142454954da03e612d1cbb14402b1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a7803dc5_ccdae6b0",
        "filename": "firmware/lib/vboot_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 522,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2021-05-10T04:58:43Z",
      "side": 1,
      "message": "Correct.  Although I guess the nvdata flag only fuzzily specifies using kernels from \"start of disk\" vs. \"end of disk\"?",
      "parentUuid": "abb825f5_cdcc5b8e",
      "revId": "44383ea43e8142454954da03e612d1cbb14402b1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "fa019f58_50642300",
        "filename": "firmware/lib/vboot_kernel.c",
        "patchSetId": 1
      },
      "lineNbr": 522,
      "author": {
        "id": 1126709
      },
      "writtenOn": "2021-05-14T06:27:44Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a7803dc5_ccdae6b0",
      "revId": "44383ea43e8142454954da03e612d1cbb14402b1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}