{
  "comments": [
    {
      "key": {
        "uuid": "72bfd923_743347ab",
        "filename": "firmware/lib/vboot_ui_menu.c",
        "patchSetId": 2
      },
      "lineNbr": 104,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2017-11-22T22:02:52Z",
      "side": 1,
      "message": "Actually, I think it\u0027s not as simple as adding \"options\" like a separate menu type, either. If you do that, depthcharge loses all state about which \"screen\" you\u0027re really on. This is especially important because that screen can change *while* you\u0027re displaying the options menu, which should be communicated to the user. Even if we\u0027re not going to display the images while the options are on (we talked about this at the meeting but didn\u0027t really settle on a conclusion, I think), I think we should at least display the text (which we were still planning to add, right?) so that the user can tell which screen they are on and whether that changes even while they\u0027re exploring the options.\n\nI feel like what you really want is a single \"recovery menu\" that can be displayed on different kinds of \"recovery screens\". Since we are going to remove the TO_DEV menu item, the INSERT menu will be equal to OPTIONS anyway. And even if we were to later add more recovery menu options (say, powerwash), there\u0027s no real reason why those should only appear on INSERT but not on NOGOOD, for example. So, really, you want to have a concept of a currently displayed menu (which could be RECOVERY, TO_DEV, DEV_WARNING, DEVELOPER, LANGUAGE or NULL) and a separate currently displayed screen type (INSERT, NOGOOD, BROKEN, TO_DEV_CONFIRMED, DEV_WARNING or TO_NORM_CONFIRMED), both of which can change independently.",
      "revId": "4231c10685ac2cf1d1c215ae743c5b9a7582ad51",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8909dfc0_78ad24b1",
        "filename": "firmware/lib/vboot_ui_menu.c",
        "patchSetId": 2
      },
      "lineNbr": 104,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2017-11-22T22:06:16Z",
      "side": 1,
      "message": "(edit: Technically there\u0027s one more screen type on the dev-mode side, I guess: TO_DEV is separate from DEV_WARNING and TO_DEV_CONFIRMED. For the developer screens, the screen type changes only in sync with menu changes. But on the recovery side it really doesn\u0027t.)",
      "parentUuid": "72bfd923_743347ab",
      "revId": "4231c10685ac2cf1d1c215ae743c5b9a7582ad51",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "06afd3e8_acc62282",
        "filename": "firmware/lib/vboot_ui_menu.c",
        "patchSetId": 2
      },
      "lineNbr": 104,
      "author": {
        "id": 1117900
      },
      "writtenOn": "2017-11-27T22:46:23Z",
      "side": 1,
      "message": "Are you talking about going to the NO_GOOD screen when you stick in a USB?  I think that at this point, showing the NO_GOOD screen should have higher priority than the user changing languages / showing debug info.  Then, when we pull out the USB, they\u0027ll go back to the INSERT or recovery menu screen.  At this point, if they want to change languages again, they\u0027ll have to transition to the OPTIONS menu again.",
      "parentUuid": "8909dfc0_78ad24b1",
      "revId": "4231c10685ac2cf1d1c215ae743c5b9a7582ad51",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2dcb7fed_de43bdba",
        "filename": "firmware/lib/vboot_ui_menu.c",
        "patchSetId": 2
      },
      "lineNbr": 104,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2017-11-28T23:36:05Z",
      "side": 1,
      "message": "So you essentially want to auto-cancel any menu whenever you switch between NOGOOD and INSERT? I ...guess... that could be good enough... it\u0027s just a little abrupt to the user. But that means we also can\u0027t keep displaying the text related to the INSERT or NOGOOD screen above the OPTIONS menu, so the user would always have to cancel first to figure out where they were again. Are we okay with that?\n\n(Also, what happens if the user selects a language but doesn\u0027t press Power to confirm yet, and then we pull the languages menu out from under them? Will it keep the language it had before they went into the menu?)",
      "parentUuid": "06afd3e8_acc62282",
      "revId": "4231c10685ac2cf1d1c215ae743c5b9a7582ad51",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b5c783e0_ea192e4a",
        "filename": "firmware/lib/vboot_ui_menu.c",
        "patchSetId": 2
      },
      "lineNbr": 321,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2017-11-22T21:47:42Z",
      "side": 1,
      "message": "nit: This should really be written as\n\n static const enum VbScreenType_t vb_menu_to_screen_map[VB_MENU_COUNT] \u003d {\n   [VB_MENU_DEV_WARNING] \u003d VB_SCREEN_DEVELOPER_WARNING_MENU,\n   [VB_MENU_DEV] \u003d VB_SCREEN_DEVELOPER_MENU,\n   ...\n };\n\n(Having to manually match indices between two arrays several pages away from each other really invites index mismatch accidents, and explicitly adding the array size would prevent someone adding a new menu type without updating this.)",
      "revId": "4231c10685ac2cf1d1c215ae743c5b9a7582ad51",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}