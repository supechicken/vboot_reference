{
  "comments": [
    {
      "key": {
        "uuid": "7fd184e1_72479884",
        "filename": "firmware/2lib/2common.c",
        "patchSetId": 9
      },
      "lineNbr": 17,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2014-05-23T18:29:17Z",
      "side": 1,
      "message": "nit: This should technically be uintptr_t",
      "revId": "ddee9c904713229d2e48c4d6a091dd8678d30269",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7f2fc4b5_62fb16e1",
        "filename": "firmware/2lib/2common.c",
        "patchSetId": 9
      },
      "lineNbr": 17,
      "author": {
        "id": 1000187
      },
      "writtenOn": "2014-05-23T19:29:08Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "7fd184e1_72479884",
      "revId": "ddee9c904713229d2e48c4d6a091dd8678d30269",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff965405_68b46cbf",
        "filename": "firmware/2lib/2sha_utility.c",
        "patchSetId": 9
      },
      "lineNbr": 26,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2014-05-23T18:29:17Z",
      "side": 1,
      "message": "I think defining a second set of algorithm constants that are specially mapped to the other ones and using a custom translation function makes this much harder to understand than it has to be. You only use this function in switch-statements anyway, you could just as well add multiple case-labels per SHA-algorithm and use the original vb2_crypto_algorithm constants (this would also be more consistent with what 2rsa.c does).",
      "revId": "ddee9c904713229d2e48c4d6a091dd8678d30269",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7f2fc4b5_a2e51e45",
        "filename": "firmware/2lib/2sha_utility.c",
        "patchSetId": 9
      },
      "lineNbr": 26,
      "author": {
        "id": 1000187
      },
      "writtenOn": "2014-05-23T19:29:08Z",
      "side": 1,
      "message": "This is a step along the way to using a separate set of algorithm enums for the shal library.  The goal is to be able to use SHA independently from RSA.",
      "parentUuid": "ff965405_68b46cbf",
      "revId": "ddee9c904713229d2e48c4d6a091dd8678d30269",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3f52ac51_d8064d39",
        "filename": "firmware/2lib/2sha_utility.c",
        "patchSetId": 9
      },
      "lineNbr": 26,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2014-05-23T22:31:00Z",
      "side": 1,
      "message": "Okay. It\u0027s just that right now you still call these with values from vb2_packed_key.algorithm and rely on the fact that they are arranged just right (which could be dangerous if someone tried to add algorithms in the future and wasn\u0027t aware of this). As long as you will later change vb2_packed_key to have two separate fields for the signature and the hash algorithm, I guess it\u0027s okay.\n\n(What you could also do which I think could be a little safer is build a small translation table, like this: \u0027enum vb2_hash_algorithm vb2_hash_alg[VB2_ALG_COUNT] \u003d { [VB2_ALG_RSA1024_SHA1] \u003d VB2_HASH_SHA1, ...};\u0027. Then it would just have to make 0 an invalid hash algorithm that\u0027s checked for, and all unspecified signature algorithms (in case someone added a new one without updating this) will map to that.)",
      "parentUuid": "7f2fc4b5_a2e51e45",
      "revId": "ddee9c904713229d2e48c4d6a091dd8678d30269",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bfa05c5b_bf0873b6",
        "filename": "firmware/2lib/include/2common.h",
        "patchSetId": 9
      },
      "lineNbr": 17,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2014-05-23T18:29:17Z",
      "side": 1,
      "message": "Do we care about non-gcc compatibility? Otherwise it might be better to implement a safe (single-evaluation) max() here just in case it will ever become important.",
      "revId": "ddee9c904713229d2e48c4d6a091dd8678d30269",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3f39cc01_40d52e51",
        "filename": "firmware/2lib/include/2common.h",
        "patchSetId": 9
      },
      "lineNbr": 17,
      "author": {
        "id": 1000187
      },
      "writtenOn": "2014-05-23T19:29:08Z",
      "side": 1,
      "message": "This is used in subsequent macros to specify required buffer sizes.  I don\u0027t think I can do that with a static __inline func.",
      "parentUuid": "bfa05c5b_bf0873b6",
      "revId": "ddee9c904713229d2e48c4d6a091dd8678d30269",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1fb968aa_702c66bc",
        "filename": "firmware/2lib/include/2common.h",
        "patchSetId": 9
      },
      "lineNbr": 17,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2014-05-23T22:31:00Z",
      "side": 1,
      "message": "As long as you are okay with using a GCC extension (I think clang has it too unless using -pedantic), you can use a compound statement to get this to evaluate only once. See here: https://gcc.gnu.org/onlinedocs/cpp/Duplication-of-Side-Effects.html",
      "parentUuid": "3f39cc01_40d52e51",
      "revId": "ddee9c904713229d2e48c4d6a091dd8678d30269",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9f9d5828_7edaed83",
        "filename": "firmware/2lib/include/2common.h",
        "patchSetId": 9
      },
      "lineNbr": 23,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2014-05-23T18:29:17Z",
      "side": 1,
      "message": "Where does printf come from... is the firmware expected to provide it? If so, is there a list of symbols that the firmware needs to provide somewhere?\n\nI\u0027ve also seen a few memcmp/memcpy/memmove/etc. around... I think it might be better to make these explicit vb2ex_printf/vb2ex_memcpy/etc., so that there can be absolutely no confusion about what symbols are expected and how their signatures need to look like.",
      "revId": "ddee9c904713229d2e48c4d6a091dd8678d30269",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bfa77c89_c40f9e50",
        "filename": "firmware/2lib/include/2common.h",
        "patchSetId": 9
      },
      "lineNbr": 23,
      "author": {
        "id": 1000187
      },
      "writtenOn": "2014-05-23T19:29:08Z",
      "side": 1,
      "message": "That\u0027s how vboot originally was.  But it ended up causing more confusion, and a needless translation layer.  Simpler to assume standard library definitions for these.",
      "parentUuid": "9f9d5828_7edaed83",
      "revId": "ddee9c904713229d2e48c4d6a091dd8678d30269",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bfa05c5b_50803c38",
        "filename": "firmware/2lib/include/2common.h",
        "patchSetId": 9
      },
      "lineNbr": 31,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2014-05-23T18:29:17Z",
      "side": 1,
      "message": "Takes a while to understand how this works. It\u0027s really a kind of stack, and you have to always free space in the reverse order that it was allocated to make it stay consistent. Maybe some more comments here should explain that explicitly (the \"pairing allocs and frees\" below wasn\u0027t clear to me on its own).\n\nYou could also explain somewhere (here or in 2api.h) that the ctx-\u003eworkbuf_used pointer is not written back automatically and needs to be explicitly set if one wants to persist something between calls.",
      "revId": "ddee9c904713229d2e48c4d6a091dd8678d30269",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7f2fc4b5_82f61af7",
        "filename": "firmware/2lib/include/2common.h",
        "patchSetId": 9
      },
      "lineNbr": 31,
      "author": {
        "id": 1000187
      },
      "writtenOn": "2014-05-23T19:29:08Z",
      "side": 1,
      "message": "Yes, see revised implementation in https://chromium-review.googlesource.com/#/c/201141/",
      "parentUuid": "bfa05c5b_50803c38",
      "revId": "ddee9c904713229d2e48c4d6a091dd8678d30269",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}