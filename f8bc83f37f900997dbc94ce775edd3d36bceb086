{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "fcfe7c7e_10f9953d",
        "filename": "firmware/2lib/2load_kernel.c",
        "patchSetId": 2
      },
      "lineNbr": 714,
      "author": {
        "id": 1562687
      },
      "writtenOn": "2024-11-26T15:01:27Z",
      "side": 1,
      "message": "@jwerner@chromium.org @yupingso@chromium.org\nWhat about adding a new partition type to differentiate between ChromeOS and AlOs and call correct loader? In that case we would not need fallback code. What do you think?",
      "revId": "f8bc83f37f900997dbc94ce775edd3d36bceb086",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f55a38f5_f6634fe3",
        "filename": "firmware/2lib/2load_kernel.c",
        "patchSetId": 2
      },
      "lineNbr": 714,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2024-11-28T00:17:02Z",
      "side": 1,
      "message": "Yeah, I think that would be good. In fact, what kind of partition type does Pixel use for their `boot` partition? Or do they not use GPT at all?",
      "parentUuid": "fcfe7c7e_10f9953d",
      "revId": "f8bc83f37f900997dbc94ce775edd3d36bceb086",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "19a62598_f9ada069",
        "filename": "firmware/2lib/2load_kernel.c",
        "patchSetId": 2
      },
      "lineNbr": 714,
      "author": {
        "id": 1515687
      },
      "writtenOn": "2024-11-28T06:24:40Z",
      "side": 1,
      "message": "Pixel is using some kind of vendor-defined [devinfo](https://source.corp.google.com/h/googleplex-android/platform/superproject/main-al-dev/+/main-al-dev:device/google/gs-common/bootctrl/aidl/BootControl.cpp;l\u003d49?q\u003ddevinfo_ab_slot_data_t\u0026ss\u003dh%2Fgoogleplex-android%2Fplatform%2Fsuperproject%2Fmain-al-dev%2F%2B%2Frefs%2Fheads%2Fmain-al-dev) block device to gather those information.\n\nLooking at [this comment](https://source.corp.google.com/h/googleplex-android/platform/superproject/main-al-dev/+/main-al-dev:device/google/gs-common/bootctrl/aidl/DevInfo.h;l\u003d22), it suggests that ABL exposes somehow this data (through kernel) to userspace.\n\nHowever, they seem to have a fallback to setting GptAttributes [here](https://source.corp.google.com/h/googleplex-android/platform/superproject/main-al-dev/+/main-al-dev:device/google/gs-common/bootctrl/aidl/BootControl.cpp;l\u003d414?q\u003dattr\u0026ss\u003dh%2Fgoogleplex-android%2Fplatform%2Fsuperproject%2Fmain-al-dev%2F%2B%2Frefs%2Fheads%2Fmain-al-dev:device%2Fgoogle%2Fgs-common%2Fbootctrl%2Faidl%2F) (since [setSlotFlag](https://source.corp.google.com/h/googleplex-android/platform/superproject/main-al-dev/+/main-al-dev:device/google/gs-common/bootctrl/aidl/BootControl.cpp;l\u003d106?q\u003dattr\u0026ss\u003dh%2Fgoogleplex-android%2Fplatform%2Fsuperproject%2Fmain-al-dev%2F%2B%2Frefs%2Fheads%2Fmain-al-dev:device%2Fgoogle%2Fgs-common%2Fbootctrl%2Faidl%2F) modifies the GPT attributes defined [here](https://source.corp.google.com/h/googleplex-android/platform/superproject/main-al-dev/+/main-al-dev:device/google/gs-common/bootctrl/aidl/BootControl.cpp;l\u003d54?q\u003dattr\u0026ss\u003dh%2Fgoogleplex-android%2Fplatform%2Fsuperproject%2Fmain-al-dev%2F%2B%2Frefs%2Fheads%2Fmain-al-dev:device%2Fgoogle%2Fgs-common%2Fbootctrl%2Faidl%2F)).\n\n\nIt looks to me they have a special GPT type for `boot` partition, with different attribute offsets than `ChromeOS Kernel GUID`.",
      "parentUuid": "f55a38f5_f6634fe3",
      "revId": "f8bc83f37f900997dbc94ce775edd3d36bceb086",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5fa1f89d_73001c31",
        "filename": "firmware/2lib/2load_kernel.c",
        "patchSetId": 2
      },
      "lineNbr": 714,
      "author": {
        "id": 1002133
      },
      "writtenOn": "2024-12-03T02:11:00Z",
      "side": 1,
      "message": "Yeah... looks like once again they copied from us but didn\u0027t actually bother to keep anything compatible. :/ Oh well. Guess it\u0027s probably best to just ignore what they\u0027re doing and just generate a new type GUID from scratch for our purposes here.",
      "parentUuid": "19a62598_f9ada069",
      "revId": "f8bc83f37f900997dbc94ce775edd3d36bceb086",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e4e9966c_c97921a1",
        "filename": "firmware/2lib/2load_kernel.c",
        "patchSetId": 2
      },
      "lineNbr": 714,
      "author": {
        "id": 1515687
      },
      "writtenOn": "2024-12-03T06:43:18Z",
      "side": 1,
      "message": "+1 for new GUID.",
      "parentUuid": "5fa1f89d_73001c31",
      "revId": "f8bc83f37f900997dbc94ce775edd3d36bceb086",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c831b631_1dd93c52",
        "filename": "firmware/2lib/2load_kernel.c",
        "patchSetId": 2
      },
      "lineNbr": 714,
      "author": {
        "id": 1270601
      },
      "writtenOn": "2024-12-13T23:31:39Z",
      "side": 1,
      "message": "Do we need to hard code the fallback logic? Can we not leverage the `priority`/`success` flags like we do today to select the kernel partition?",
      "parentUuid": "e4e9966c_c97921a1",
      "revId": "f8bc83f37f900997dbc94ce775edd3d36bceb086",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}