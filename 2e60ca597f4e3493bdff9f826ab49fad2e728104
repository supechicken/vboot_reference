{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "f2e9d2a0_91b8a35b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1256179
      },
      "writtenOn": "2023-05-31T05:47:21Z",
      "side": 1,
      "message": "Hi George, could you take a look at this signer change? (your owner approval is needed)",
      "revId": "2e60ca597f4e3493bdff9f826ab49fad2e728104",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "932816bc_392cef8c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1002736
      },
      "writtenOn": "2023-05-31T05:53:17Z",
      "side": 1,
      "message": "Still LGTM",
      "revId": "2e60ca597f4e3493bdff9f826ab49fad2e728104",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "72a9fcde_0ebd1e54",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1355298
      },
      "writtenOn": "2023-05-31T15:55:57Z",
      "side": 1,
      "message": "Does this change require any userland or kernel specific support? The signer hosts may be lacking them.",
      "revId": "2e60ca597f4e3493bdff9f826ab49fad2e728104",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0383f1f7_f0eebf9c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1256179
      },
      "writtenOn": "2023-06-01T03:55:19Z",
      "side": 1,
      "message": "No, it doesn\u0027t require any userland or kernel specific support.\n\nThe script now uses binaries in erofs-utils, and I have already updated the deploy-new-signer script to include them. http://crrev.com/i/5719730",
      "parentUuid": "72a9fcde_0ebd1e54",
      "revId": "2e60ca597f4e3493bdff9f826ab49fad2e728104",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "cfc8e392_15a517ed",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1256179
      },
      "writtenOn": "2023-06-05T05:07:42Z",
      "side": 1,
      "message": "Hi Allen, would you take a look?\n(engeg@ is out until June 12)\nI\u0027ve already got LGTM from khmel@ and hirono@",
      "revId": "2e60ca597f4e3493bdff9f826ab49fad2e728104",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "25e68434_6a0f118a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1256179
      },
      "writtenOn": "2023-06-05T05:08:08Z",
      "side": 1,
      "message": "Hi Allen, would you take a look?\n(engeg@ is out until June 12)\nI\u0027ve already got LGTM from khmel@ and hirono@",
      "revId": "2e60ca597f4e3493bdff9f826ab49fad2e728104",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "63f73786_9b5296a7",
        "filename": "scripts/image_signing/sign_android_image.sh",
        "patchSetId": 7
      },
      "lineNbr": 366,
      "author": {
        "id": 1000768
      },
      "writtenOn": "2023-06-05T15:32:34Z",
      "side": 1,
      "message": "`d` isn\u0027t declared anywhere.  this also emits errors to stderr for erofs images which is confusing noise.\n\nyou should capture both fully, and then emit it only when calling die below.\n\n```\nlocal output_squashfs output_erofs\nif ! output_squashfs\u003d\"$(... 2\u003e\u00261); then\n```",
      "revId": "2e60ca597f4e3493bdff9f826ab49fad2e728104",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b795413e_f15fe324",
        "filename": "scripts/image_signing/sign_android_image.sh",
        "patchSetId": 7
      },
      "lineNbr": 366,
      "author": {
        "id": 1256179
      },
      "writtenOn": "2023-06-06T09:09:11Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "63f73786_9b5296a7",
      "revId": "2e60ca597f4e3493bdff9f826ab49fad2e728104",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "61bcb70c_8820b644",
        "filename": "scripts/image_signing/sign_android_image.sh",
        "patchSetId": 7
      },
      "lineNbr": 380,
      "author": {
        "id": 1000768
      },
      "writtenOn": "2023-06-05T15:32:34Z",
      "side": 1,
      "message": "why do you need to use sudo ?  you didn\u0027t above.",
      "revId": "2e60ca597f4e3493bdff9f826ab49fad2e728104",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4264f569_14e510a4",
        "filename": "scripts/image_signing/sign_android_image.sh",
        "patchSetId": 7
      },
      "lineNbr": 380,
      "author": {
        "id": 1256179
      },
      "writtenOn": "2023-06-06T09:09:11Z",
      "side": 1,
      "message": "Removed sudo.\nWe don\u0027t need sudo for `unsquashfs -s /tmp/path-to-img`",
      "parentUuid": "61bcb70c_8820b644",
      "revId": "2e60ca597f4e3493bdff9f826ab49fad2e728104",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "25875780_a509e31a",
        "filename": "scripts/image_signing/sign_android_image.sh",
        "patchSetId": 7
      },
      "lineNbr": 381,
      "author": {
        "id": 1000768
      },
      "writtenOn": "2023-06-05T15:32:34Z",
      "side": 1,
      "message": "normally the regex is fully quoted or not, not partially like this\n\nif you want to use a boundary condition, `\\b` is more appropriate than `\\s`\n\nthen again for the logic below, prob better to use awk\n\n`compression\u003d\"$(\"${unsquashfs}\" -s \"${system_img}\" | awk \u0027$1 \u003d\u003d \"Compression\" {print $2}\u0027)\"`\n\nthen you can `case \"${compression}\" in` below and match `gzip` directly\n\n(i get this feedback is for existing code)",
      "revId": "2e60ca597f4e3493bdff9f826ab49fad2e728104",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f1106e07_4660cc37",
        "filename": "scripts/image_signing/sign_android_image.sh",
        "patchSetId": 7
      },
      "lineNbr": 381,
      "author": {
        "id": 1256179
      },
      "writtenOn": "2023-06-06T09:09:11Z",
      "side": 1,
      "message": "Done. Thanks for the suggestion. It\u0027s much better.",
      "parentUuid": "25875780_a509e31a",
      "revId": "2e60ca597f4e3493bdff9f826ab49fad2e728104",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e0f3ef84_5798c621",
        "filename": "scripts/image_signing/sign_android_image.sh",
        "patchSetId": 7
      },
      "lineNbr": 420,
      "author": {
        "id": 1000532
      },
      "writtenOn": "2023-06-05T21:40:29Z",
      "side": 1,
      "message": "Does `fsck.erofs --extract` not retain capabilities in the first place? Or are they unsupported in general with erofs tools, such that the capabilities had already been removed during the creation of the erofs image? Or do we expect any capabilities from the original image to make it through the original mkfs.erofs -\u003e fsck.erofs process, in which case there might be nothing to do here?\n\nFor unsquashfs, we only needed to manually preserve capabilities due to wanting to use `-no-xattrs` for other purposes, e.g. in crrev.com/c/2511121.\n\nI spot-checked a recent tm-arc build and it appears to still have capabilities on a small handful of files, akin to b/179170462#comment35 - so we should ensure we preserve these through the build and signing process lest we regress like we did on b/179170462 for erofs images...",
      "revId": "2e60ca597f4e3493bdff9f826ab49fad2e728104",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "44184a8f_3bf74cd9",
        "filename": "scripts/image_signing/sign_android_image.sh",
        "patchSetId": 7
      },
      "lineNbr": 420,
      "author": {
        "id": 1256179
      },
      "writtenOn": "2023-06-06T09:09:11Z",
      "side": 1,
      "message": "I confirmed that that capabilities are preserved within an EROFS image created by mkfs.erofs. The problem is that `fsck.erofs --extract` doesn\u0027t retain capabilities when extracting files.\n\nI just filed b/286015959 and assigned it to one of the authors of erofs-utils.",
      "parentUuid": "e0f3ef84_5798c621",
      "revId": "2e60ca597f4e3493bdff9f826ab49fad2e728104",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bfcd0cc0_f28397a2",
        "filename": "scripts/image_signing/sign_android_image.sh",
        "patchSetId": 7
      },
      "lineNbr": 420,
      "author": {
        "id": 1256179
      },
      "writtenOn": "2023-06-08T03:45:01Z",
      "side": 1,
      "message": "I will address this in separate CLs : b/286015959",
      "parentUuid": "44184a8f_3bf74cd9",
      "revId": "2e60ca597f4e3493bdff9f826ab49fad2e728104",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9db037c1_8e9e23a2",
        "filename": "scripts/image_signing/sign_android_image.sh",
        "patchSetId": 7
      },
      "lineNbr": 515,
      "author": {
        "id": 1000768
      },
      "writtenOn": "2023-06-05T15:32:34Z",
      "side": 1,
      "message": "```suggestion\n    info \"Repacking squashfs image with ${squashfs_comp_flags[*]}\"\n```",
      "revId": "2e60ca597f4e3493bdff9f826ab49fad2e728104",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1aae3771_e37768ef",
        "filename": "scripts/image_signing/sign_android_image.sh",
        "patchSetId": 7
      },
      "lineNbr": 515,
      "author": {
        "id": 1256179
      },
      "writtenOn": "2023-06-06T09:09:11Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9db037c1_8e9e23a2",
      "revId": "2e60ca597f4e3493bdff9f826ab49fad2e728104",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b0624110_dfbda02d",
        "filename": "scripts/image_signing/sign_android_image.sh",
        "patchSetId": 7
      },
      "lineNbr": 528,
      "author": {
        "id": 1265562
      },
      "writtenOn": "2023-06-05T15:17:58Z",
      "side": 1,
      "message": "Is there a reason you don\u0027t keep this consistent like with squashfs? What if we want to use zstd etc in the future?",
      "range": {
        "startLine": 528,
        "startChar": 28,
        "endLine": 528,
        "endChar": 33
      },
      "revId": "2e60ca597f4e3493bdff9f826ab49fad2e728104",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "19f3cfc8_4c8246f8",
        "filename": "scripts/image_signing/sign_android_image.sh",
        "patchSetId": 7
      },
      "lineNbr": 528,
      "author": {
        "id": 1256179
      },
      "writtenOn": "2023-06-06T09:09:11Z",
      "side": 1,
      "message": "I hardcoded lz4hc here because:\n- mkfs.erofs currently only supports lz4hc and lz4 we never use lz4\n- dump.erofs doesn\u0027t currently have an option to show the compression type.\n\nI\u0027ll update the script once erofs supports another compression type in the future.",
      "parentUuid": "b0624110_dfbda02d",
      "range": {
        "startLine": 528,
        "startChar": 28,
        "endLine": 528,
        "endChar": 33
      },
      "revId": "2e60ca597f4e3493bdff9f826ab49fad2e728104",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8676eac9_0f1ae5a1",
        "filename": "scripts/image_signing/sign_android_image.sh",
        "patchSetId": 7
      },
      "lineNbr": 528,
      "author": {
        "id": 1265562
      },
      "writtenOn": "2023-06-06T12:10:30Z",
      "side": 1,
      "message": "I this case it probably makes sense to leave a TODO(b/#####) comment.",
      "parentUuid": "19f3cfc8_4c8246f8",
      "range": {
        "startLine": 528,
        "startChar": 28,
        "endLine": 528,
        "endChar": 33
      },
      "revId": "2e60ca597f4e3493bdff9f826ab49fad2e728104",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a769c441_14a5cd7f",
        "filename": "scripts/image_signing/sign_android_image.sh",
        "patchSetId": 7
      },
      "lineNbr": 528,
      "author": {
        "id": 1256179
      },
      "writtenOn": "2023-06-07T04:49:29Z",
      "side": 1,
      "message": "Done. Filed b/286165395",
      "parentUuid": "8676eac9_0f1ae5a1",
      "range": {
        "startLine": 528,
        "startChar": 28,
        "endLine": 528,
        "endChar": 33
      },
      "revId": "2e60ca597f4e3493bdff9f826ab49fad2e728104",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3d36f6ed_71208bdd",
        "filename": "scripts/image_signing/sign_android_image.sh",
        "patchSetId": 7
      },
      "lineNbr": 529,
      "author": {
        "id": 1000768
      },
      "writtenOn": "2023-06-05T15:32:34Z",
      "side": 1,
      "message": "bad indentation",
      "revId": "2e60ca597f4e3493bdff9f826ab49fad2e728104",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5cbb1004_101df364",
        "filename": "scripts/image_signing/sign_android_image.sh",
        "patchSetId": 7
      },
      "lineNbr": 529,
      "author": {
        "id": 1256179
      },
      "writtenOn": "2023-06-06T09:09:11Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "3d36f6ed_71208bdd",
      "revId": "2e60ca597f4e3493bdff9f826ab49fad2e728104",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}