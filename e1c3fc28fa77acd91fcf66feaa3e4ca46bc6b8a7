{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "d4c2c12e_250ed452",
        "filename": "firmware/2lib/2misc.c",
        "patchSetId": 6
      },
      "lineNbr": 398,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2021-07-27T06:53:02Z",
      "side": 1,
      "message": "Please add a new error for this.\n\nIn fact, I wonder if we can move the GBB check to developer_to_norm_action(). Then we don\u0027t need a return value. Do you have a good reason why the GBB check is put here, but the vb2_allow_recovery() check for vb2_enable_developer_mode() is in 2ui_screens.c?",
      "range": {
        "startLine": 398,
        "startChar": 9,
        "endLine": 398,
        "endChar": 22
      },
      "revId": "e1c3fc28fa77acd91fcf66feaa3e4ca46bc6b8a7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f9b423ff_6a69c60c",
        "filename": "firmware/2lib/2misc.c",
        "patchSetId": 6
      },
      "lineNbr": 398,
      "author": {
        "id": 1516107
      },
      "writtenOn": "2021-07-27T09:36:27Z",
      "side": 1,
      "message": "I think this is what Joel mean in the design doc - \"developer_to_norm_action (1) checks whether or not can switch to dev mode (2) switches to dev mode.  I\u0027d recommend that this logic be encapsulated inside vboot together, rather than having depthcharge separately perform (1) and (2).\"\n\nAs for \"recovery_to_dev_finalize\", the reason why I want to keep the checking inside 2ui_screens is that these checking has a comment \"Validity check, should never happen.\", and it includes some checking about ui. This makes me feel like this checking is for checking that ui is working correctly, instead of checking the condition of enabling developer mode.",
      "parentUuid": "d4c2c12e_250ed452",
      "range": {
        "startLine": 398,
        "startChar": 9,
        "endLine": 398,
        "endChar": 22
      },
      "revId": "e1c3fc28fa77acd91fcf66feaa3e4ca46bc6b8a7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "64f1bedf_f7cc003f",
        "filename": "firmware/2lib/2misc.c",
        "patchSetId": 6
      },
      "lineNbr": 398,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2021-07-27T10:04:40Z",
      "side": 1,
      "message": "From my understanding, what Joel wants to avoid is:\n\n1. Check GBB flags (this is (1)) and return VB2_REQUEST_DISABLE_DEV from UI code\n2. After vb2_manual_recovery_menu() returns VB2_REQUEST_DISABLE_DEV, depthcharge calls vb2api_disable_developer_mode() (this is (2)).\n\nWhat I suggest is different from above. In fact, (1) and (2) are still performed together in developer_to_norm_action(), with nothing in between.\n\nOn the other hand, from security\u0027s perspective, gbb check has its importance here, and so does vb2_allow_recovery() for vb2_enable_developer_mode(). The other 2 checks (screen id and SD flag), however, seem like UI validity checks, and hence belong to the UI code.\n\nSo, my suggestion now is to\n- check GBB flags in this function (still need to create a new error)\n- add the vb2_allow_recovery() check in vb2api_enable_developer_mode() (I\u0027m fine if you want to keep an additional vb2_allow_recovery() in UI code)",
      "parentUuid": "f9b423ff_6a69c60c",
      "range": {
        "startLine": 398,
        "startChar": 9,
        "endLine": 398,
        "endChar": 22
      },
      "revId": "e1c3fc28fa77acd91fcf66feaa3e4ca46bc6b8a7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "37471445_6d04c3be",
        "filename": "firmware/2lib/2misc.c",
        "patchSetId": 6
      },
      "lineNbr": 398,
      "author": {
        "id": 1516107
      },
      "writtenOn": "2021-07-28T05:10:10Z",
      "side": 1,
      "message": "I\u0027m not sure about what\u0027s the difference between the first point of your current suggestion and this CL, and I can do the second point in the next CL, since the next one is about checking in functions.\n\nFor developer_to_norm_action, I think Joel wants the checking and performing part both located in vboot. Since developer_to_norm_action is an action function for a screen, I think this bridge between depthcharge and vboot should be moved to depthcharge. This is the reason that I move the validation part to vb2api_disable_dev_request.",
      "parentUuid": "64f1bedf_f7cc003f",
      "range": {
        "startLine": 398,
        "startChar": 9,
        "endLine": 398,
        "endChar": 22
      },
      "revId": "e1c3fc28fa77acd91fcf66feaa3e4ca46bc6b8a7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bd43a298_f9bafe81",
        "filename": "firmware/2lib/2misc.c",
        "patchSetId": 6
      },
      "lineNbr": 398,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2021-07-28T05:35:31Z",
      "side": 1,
      "message": "Let me make my points clearer:\n\n- Keep the GBB check in this function (as this CL already does). However, please create a new error for this.\n- It\u0027s fine to add the vb2_allow_recovery() check in vb2api_enable_developer_mode() in a follow-up CL (or a separate CL before this one).",
      "parentUuid": "37471445_6d04c3be",
      "range": {
        "startLine": 398,
        "startChar": 9,
        "endLine": 398,
        "endChar": 22
      },
      "revId": "e1c3fc28fa77acd91fcf66feaa3e4ca46bc6b8a7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d6e18553_7c2441da",
        "filename": "firmware/2lib/2misc.c",
        "patchSetId": 6
      },
      "lineNbr": 398,
      "author": {
        "id": 1516107
      },
      "writtenOn": "2021-07-28T07:22:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "bd43a298_f9bafe81",
      "range": {
        "startLine": 398,
        "startChar": 9,
        "endLine": 398,
        "endChar": 22
      },
      "revId": "e1c3fc28fa77acd91fcf66feaa3e4ca46bc6b8a7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "72e78957_ede6ee46",
        "filename": "firmware/2lib/2misc.c",
        "patchSetId": 6
      },
      "lineNbr": 408,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2021-07-27T06:53:02Z",
      "side": 1,
      "message": "This message doesn\u0027t belong here, because we\u0027re not returning VB2_REQUEST_REBOOT. How about moving the message to launch_diagnostics_action(), or removing the \"rebooting\" part here?",
      "range": {
        "startLine": 408,
        "startChar": 35,
        "endLine": 408,
        "endChar": 44
      },
      "revId": "e1c3fc28fa77acd91fcf66feaa3e4ca46bc6b8a7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "736bc163_246da3b0",
        "filename": "firmware/2lib/2misc.c",
        "patchSetId": 6
      },
      "lineNbr": 408,
      "author": {
        "id": 1516107
      },
      "writtenOn": "2021-07-27T09:36:27Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "72e78957_ede6ee46",
      "range": {
        "startLine": 408,
        "startChar": 35,
        "endLine": 408,
        "endChar": 44
      },
      "revId": "e1c3fc28fa77acd91fcf66feaa3e4ca46bc6b8a7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "db143b8a_db2422d7",
        "filename": "firmware/2lib/include/2api.h",
        "patchSetId": 6
      },
      "lineNbr": 966,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2021-07-27T06:53:02Z",
      "side": 1,
      "message": "Just \"Enable\"",
      "range": {
        "startLine": 966,
        "startChar": 3,
        "endLine": 966,
        "endChar": 29
      },
      "revId": "e1c3fc28fa77acd91fcf66feaa3e4ca46bc6b8a7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a6c8246a_d8d54e73",
        "filename": "firmware/2lib/include/2api.h",
        "patchSetId": 6
      },
      "lineNbr": 966,
      "author": {
        "id": 1516107
      },
      "writtenOn": "2021-07-27T09:36:27Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "db143b8a_db2422d7",
      "range": {
        "startLine": 966,
        "startChar": 3,
        "endLine": 966,
        "endChar": 29
      },
      "revId": "e1c3fc28fa77acd91fcf66feaa3e4ca46bc6b8a7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "18eb833c_7312d297",
        "filename": "firmware/2lib/include/2api.h",
        "patchSetId": 6
      },
      "lineNbr": 985,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2021-07-27T06:53:02Z",
      "side": 1,
      "message": "Can we call it disalbe_developer_mode to be consistent?",
      "range": {
        "startLine": 985,
        "startChar": 19,
        "endLine": 985,
        "endChar": 38
      },
      "revId": "e1c3fc28fa77acd91fcf66feaa3e4ca46bc6b8a7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7ecde38b_09987bbc",
        "filename": "firmware/2lib/include/2api.h",
        "patchSetId": 6
      },
      "lineNbr": 985,
      "author": {
        "id": 1516107
      },
      "writtenOn": "2021-07-27T09:36:27Z",
      "side": 1,
      "message": "Sure. But I\u0027m not sure if it is a pair with enable_developer_mode since the flags they are setting seems different.",
      "parentUuid": "18eb833c_7312d297",
      "range": {
        "startLine": 985,
        "startChar": 19,
        "endLine": 985,
        "endChar": 38
      },
      "revId": "e1c3fc28fa77acd91fcf66feaa3e4ca46bc6b8a7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "893f8a06_547467e4",
        "filename": "firmware/2lib/include/2api.h",
        "patchSetId": 6
      },
      "lineNbr": 993,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2021-07-27T06:53:02Z",
      "side": 1,
      "message": "Extra blank line.",
      "revId": "e1c3fc28fa77acd91fcf66feaa3e4ca46bc6b8a7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f329f77a_596eb270",
        "filename": "firmware/2lib/include/2api.h",
        "patchSetId": 6
      },
      "lineNbr": 993,
      "author": {
        "id": 1516107
      },
      "writtenOn": "2021-07-27T09:36:27Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "893f8a06_547467e4",
      "revId": "e1c3fc28fa77acd91fcf66feaa3e4ca46bc6b8a7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3694a3c5_aad9a2ed",
        "filename": "firmware/include/vboot_api.h",
        "patchSetId": 6
      },
      "lineNbr": 83,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2021-07-27T06:53:02Z",
      "side": 1,
      "message": "kparams",
      "range": {
        "startLine": 83,
        "startChar": 23,
        "endLine": 83,
        "endChar": 26
      },
      "revId": "e1c3fc28fa77acd91fcf66feaa3e4ca46bc6b8a7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bba3591d_49e3cbac",
        "filename": "firmware/include/vboot_api.h",
        "patchSetId": 6
      },
      "lineNbr": 83,
      "author": {
        "id": 1516107
      },
      "writtenOn": "2021-07-27T09:36:27Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "3694a3c5_aad9a2ed",
      "range": {
        "startLine": 83,
        "startChar": 23,
        "endLine": 83,
        "endChar": 26
      },
      "revId": "e1c3fc28fa77acd91fcf66feaa3e4ca46bc6b8a7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e830736e_8f56978a",
        "filename": "firmware/lib/include/vboot_kernel.h",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2021-07-27T06:53:02Z",
      "side": 1,
      "message": "Why do we still need this file?",
      "revId": "e1c3fc28fa77acd91fcf66feaa3e4ca46bc6b8a7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b04a4da3_8a056bea",
        "filename": "firmware/lib/include/vboot_kernel.h",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1516107
      },
      "writtenOn": "2021-07-27T09:36:27Z",
      "side": 1,
      "message": "I\u0027m not sure if I can delete it directly or if there is a rule like some c files need a header file.\nAlso, seems like that header is needed by \"futility/dump_kernel_config_lib.o\". I\u0027m not sure what it means and how to fix this.",
      "parentUuid": "e830736e_8f56978a",
      "revId": "e1c3fc28fa77acd91fcf66feaa3e4ca46bc6b8a7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e560e8c3_ad45bba4",
        "filename": "firmware/lib/include/vboot_kernel.h",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1353551
      },
      "writtenOn": "2021-07-28T07:31:01Z",
      "side": 1,
      "message": "Since there\u0027s no function/struct/enum definition here, we should remove it.\n\n\u003e Also, seems like that header is needed by \"futility/dump_kernel_config_lib.o\".\n\nWhat\u0027s the error message?",
      "parentUuid": "b04a4da3_8a056bea",
      "revId": "e1c3fc28fa77acd91fcf66feaa3e4ca46bc6b8a7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "259a274f_9a21cdcf",
        "filename": "firmware/lib/include/vboot_kernel.h",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1516107
      },
      "writtenOn": "2021-07-28T07:43:38Z",
      "side": 1,
      "message": "After removing it, \n\n```\n$ export CC\u003dx86_64-pc-linux-gnu-clang DEBUG\u003d1 DETACHABLE\u003d1; make -j32 test_setup \u0026\u0026 make -j32 runtests\nvboot SHA256 built with tight loops (slower, smaller code size)\nmake: *** No rule to make target \u0027firmware/lib/include/vboot_kernel.h\u0027, needed by \u0027/mnt/host/source/src/platform/vboot_reference/build/futility/dump_kernel_config_lib.o\u0027.  Stop.\n```\n\n`emerge-asurada depthcharge chromeos-bootimage` works good.",
      "parentUuid": "e560e8c3_ad45bba4",
      "revId": "e1c3fc28fa77acd91fcf66feaa3e4ca46bc6b8a7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "885ec1db_7414599b",
        "filename": "firmware/lib/include/vboot_kernel.h",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1516107
      },
      "writtenOn": "2021-07-28T09:17:39Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "259a274f_9a21cdcf",
      "revId": "e1c3fc28fa77acd91fcf66feaa3e4ca46bc6b8a7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}